<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShonenMaster Admin - Prototype V2</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Bebas+Neue&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <style>
        :root {
            --bg: #08090d;
            --bg-elevated: #0f1117;
            --bg-card: #14161e;
            --gold: #f0c040;
            --gold-dim: #a8882c;
            --green: #00ff88;
            --red: #ff3b5c;
            --text: #ffffff;
            --text-dim: #6b7280;
            --border: #1e2130;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow: hidden;
        }

        /* Background */
        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);
            background-size: 80px 80px;
            pointer-events: none;
            z-index: 0;
        }

        .bg-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Bebas Neue', sans-serif;
            font-size: 25vw;
            color: rgba(255, 255, 255, 0.03);
            white-space: nowrap;
            pointer-events: none;
            z-index: 0;
            user-select: none;
            letter-spacing: -0.02em;
            transition: all 0.8s ease;
        }

        .bg-text.lobby-active {
            font-size: 20vw;
            color: rgba(0, 255, 136, 0.025);
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 56px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 100;
            background: linear-gradient(to bottom, var(--bg), transparent);
        }

        .logo-text {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            font-size: 0.85rem;
            letter-spacing: -0.3px;
        }

        .logo-text span {
            color: var(--gold);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .status-pill {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 50px;
            font-size: 0.65rem;
            font-weight: 500;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--red);
            animation: pulse 2s ease-in-out infinite;
        }

        .status-dot.active {
            background: var(--green);
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
                transform: scale(1);
            }

            50% {
                opacity: 0.5;
                transform: scale(0.9);
            }
        }

        /* Main Container */
        .main-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        /* ============================================
           ÉTAT IDLE
           ============================================ */
        .state-idle {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 60px;
            width: 100%;
            max-width: 1100px;
            padding: 0 40px;
            align-items: start;
            padding-top: 30px;
            position: relative;
        }

        .idle-main {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 85px;
            padding-top: 130px;
        }

        /* Bouton principal */
        .btn-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-character {
            position: absolute;
            height: auto;
            width: 115px;
            top: -93px;
            left: 19%;
            z-index: 0;
            pointer-events: none;
            opacity: 0;
            visibility: hidden;
        }

        .btn-character.visible {
            z-index: 10 !important;
            transition: transform 0.4s ease;
        }

        .btn-wrapper:hover .btn-character.visible {
            transform: translateY(-8px);
        }

        .main-action-btn {
            position: relative;
            width: 185px;
            height: 185px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, var(--bg-card), var(--bg));
            border: 2px solid var(--border);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            z-index: 1;
            opacity: 0;
            transform: scale(0);
        }

        .btn-wrapper::before {
            content: '';
            position: absolute;
            width: 185px;
            height: 185px;
            border-radius: 50%;
            border: 1px solid var(--gold);
            opacity: 0;
            pointer-events: none;
        }

        .btn-wrapper.pulse-active::before {
            animation: ringPulse 3s ease-out infinite;
        }

        @keyframes ringPulse {
            0% {
                transform: scale(1);
                opacity: 0.4;
            }

            100% {
                transform: scale(1.6);
                opacity: 0;
            }
        }

        .main-action-btn::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, var(--gold), transparent);
            opacity: 0;
            animation: rotate 4s linear infinite;
            transition: opacity 0.5s;
        }

        .main-action-btn:hover::before {
            opacity: 0.3;
        }

        @keyframes rotate {
            100% {
                transform: rotate(360deg);
            }
        }

        .main-action-btn::after {
            content: '';
            position: absolute;
            inset: 3px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, var(--bg-card), var(--bg));
        }

        .main-action-btn:hover {
            border-color: var(--gold);
            box-shadow: 0 0 60px rgba(240, 192, 64, 0.25);
            transform: scale(1.08);
        }

        .main-action-btn .btn-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .main-action-btn .btn-text {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--text-dim);
            transition: all 0.3s;
        }

        .main-action-btn:hover .btn-text {
            color: var(--gold);
            text-shadow: 0 0 20px rgba(240, 192, 64, 0.5);
        }

        /* Particules */
        .particles-container {
            position: absolute;
            width: 300px;
            height: 300px;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 5px;
            height: 5px;
            background: var(--gold);
            border-radius: 50%;
            opacity: 0;
            pointer-events: none;
            box-shadow: 0 0 6px rgba(255, 215, 0, 0.5);
        }

        .particle:nth-child(1) {
            left: 50%;
            top: 50%;
        }

        .particle:nth-child(2) {
            left: 20%;
            top: 30%;
        }

        .particle:nth-child(3) {
            left: 80%;
            top: 20%;
        }

        .particle:nth-child(4) {
            left: 70%;
            top: 70%;
        }

        .particle:nth-child(5) {
            left: 30%;
            top: 80%;
        }

        .particle:nth-child(6) {
            left: 50%;
            top: 10%;
        }

        .particle:nth-child(7) {
            left: 10%;
            top: 50%;
        }

        .particle:nth-child(8) {
            left: 90%;
            top: 50%;
        }

        /* Stats idle */
        .idle-stats {
            display: flex;
            gap: 40px;
        }

        .idle-stat {
            text-align: center;
        }

        .idle-stat-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.8rem;
            color: var(--gold);
            line-height: 1;
        }

        .idle-stat-label {
            font-size: 0.55rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 4px;
        }

        /* Panneau Récentes */
        .recent-games-panel {
            position: fixed;
            left: 20px;
            top: 130px;
            width: 200px;
            opacity: 0;
            z-index: 50;
            transition: all 0.5s ease;
        }

        .recent-games-panel.hidden {
            opacity: 0 !important;
            transform: translateX(-30px);
            pointer-events: none;
        }

        .recent-games-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            padding-left: 14px;
        }

        .recent-games-title {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .recent-games-link {
            color: var(--text-dim);
            opacity: 0.4;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }

        .recent-games-link:hover {
            color: var(--gold);
            opacity: 1;
        }

        .recent-game-item {
            display: flex;
            flex-direction: column;
            padding: 10px 14px;
            margin-bottom: 6px;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(255, 255, 255, 0.03) 15%,
                    rgba(255, 255, 255, 0.03) 85%,
                    transparent 100%);
            border-radius: 6px;
            transition: all 0.3s;
        }

        .recent-game-item:hover {
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(255, 255, 255, 0.05) 15%,
                    rgba(255, 255, 255, 0.05) 85%,
                    transparent 100%);
        }

        .recent-game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .recent-game-date {
            font-size: 0.55rem;
            color: var(--text-dim);
        }

        .recent-game-players {
            font-size: 0.5rem;
            color: var(--text-dim);
            background: rgba(255, 255, 255, 0.05);
            padding: 2px 6px;
            border-radius: 8px;
        }

        .recent-game-winner {
            font-size: 0.7rem;
            font-weight: 400;
            color: var(--gold);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Panneau Leaderboard */
        .lastgame-panel {
            background: transparent;
            padding-top: 0px;
            max-height: 600px;
            overflow: visible;
            position: relative;
            transition: all 0.5s ease;
        }

        .lastgame-panel.hidden {
            opacity: 0 !important;
            transform: translateX(30px);
            pointer-events: none;
        }

        .leaderboard-filters {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            justify-content: flex-end;
        }

        .filter-btn {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: var(--text-dim);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .filter-btn:hover {
            border-color: rgba(255, 215, 0, 0.4);
            color: var(--text);
        }

        .filter-btn.active {
            background: rgba(255, 215, 0, 0.15);
            border-color: rgba(255, 215, 0, 0.5);
            color: var(--gold);
        }

        .lastgame-scroll {
            overflow: hidden;
            height: 480px;
            position: relative;
        }

        .lastgame-scroll::before,
        .lastgame-scroll::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            height: 50px;
            z-index: 2;
            pointer-events: none;
        }

        .lastgame-scroll::before {
            top: 0;
            background: linear-gradient(to bottom, var(--bg), transparent);
        }

        .lastgame-scroll::after {
            bottom: 0;
            background: linear-gradient(to top, var(--bg), transparent);
        }

        .lastgame-list {
            display: flex;
            flex-direction: column;
            animation: scrollUp 45s linear infinite;
        }

        .lastgame-list:hover {
            animation-play-state: paused;
        }

        @keyframes scrollUp {
            0% {
                transform: translateY(0);
            }

            100% {
                transform: translateY(-50%);
            }
        }

        .lastgame-item {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            margin-bottom: 4px;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(255, 255, 255, 0.03) 15%,
                    rgba(255, 255, 255, 0.03) 85%,
                    transparent 100%);
            transition: all 0.3s;
            position: relative;
            flex-shrink: 0;
            cursor: pointer;
        }

        .lastgame-item.top1 {
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(255, 215, 0, 0.15) 15%,
                    rgba(255, 215, 0, 0.15) 85%,
                    transparent 100%);
        }

        .lastgame-item.top1::before,
        .lastgame-item.top1::after {
            content: '';
            position: absolute;
            left: 15%;
            right: 15%;
            height: 1px;
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
        }

        .lastgame-item.top1::before {
            top: 0;
        }

        .lastgame-item.top1::after {
            bottom: 0;
        }

        .lastgame-item.top2 {
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(192, 192, 192, 0.12) 15%,
                    rgba(192, 192, 192, 0.12) 85%,
                    transparent 100%);
        }

        .lastgame-item.top3 {
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(205, 127, 50, 0.12) 15%,
                    rgba(205, 127, 50, 0.12) 85%,
                    transparent 100%);
        }

        .lastgame-item.top10 {
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(240, 192, 64, 0.08) 15%,
                    rgba(240, 192, 64, 0.08) 85%,
                    transparent 100%);
        }

        .lastgame-name {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-dim);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            position: relative;
        }

        .lastgame-rank-badge {
            position: absolute;
            right: 0;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.55rem;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
            min-width: 20px;
            text-align: center;
        }

        .lastgame-item.top1 .lastgame-rank-badge {
            background: rgba(255, 215, 0, 0.2);
            color: #ffd700;
        }

        .lastgame-item.top2 .lastgame-rank-badge {
            background: rgba(192, 192, 192, 0.2);
            color: #c0c0c0;
        }

        .lastgame-item.top3 .lastgame-rank-badge {
            background: rgba(205, 127, 50, 0.2);
            color: #cd7f32;
        }

        .lastgame-item.top10 .lastgame-rank-badge {
            background: rgba(240, 192, 64, 0.15);
            color: var(--gold);
            opacity: 0.8;
        }

        .lastgame-item .lastgame-rank-badge {
            background: rgba(255, 255, 255, 0.08);
            color: var(--text-dim);
            opacity: 0.6;
        }

        .lastgame-item.top1 .lastgame-name {
            color: #ffd700;
            font-weight: 600;
        }

        .lastgame-item.top2 .lastgame-name {
            color: #c0c0c0;
            font-weight: 600;
        }

        .lastgame-item.top3 .lastgame-name {
            color: #cd7f32;
            font-weight: 600;
        }

        .lastgame-item.top10 .lastgame-name {
            color: var(--gold);
        }

        /* ============================================
           TRANSITION ABSORPTION
           ============================================ */
        .absorption-circle {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, var(--bg-elevated) 0%, var(--bg) 100%);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 200;
            pointer-events: none;
            opacity: 0;
        }

        /* ============================================
           ÉTAT LOBBY
           ============================================ */
        .state-lobby {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: none;
            z-index: 150;
            padding: 80px 40px 40px;
            opacity: 0;
        }

        .state-lobby.active {
            display: flex;
        }

        .lobby-layout {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Layout principal 3 colonnes */
        .lobby-content {
            display: grid;
            grid-template-columns: 240px 1fr 200px;
            gap: 25px;
            flex: 1;
            overflow: hidden;
        }

        /* ========== COLONNE GAUCHE - PARAMÈTRES ========== */
        .lobby-settings-panel {
            display: flex;
            flex-direction: column;
            gap: 5px;
            overflow-y: auto;
            padding-right: 10px;
            padding-top: 0;
            max-height: 100%;
        }

        .lobby-settings-panel::-webkit-scrollbar {
            width: 3px;
        }

        .lobby-settings-panel::-webkit-scrollbar-track {
            background: transparent;
        }

        .lobby-settings-panel::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .settings-panel-title {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.5;
            margin-top: 0;
            margin-bottom: 25px;
            padding-left: 2px;
            line-height: 1.8rem;
        }

        .setting-group {
            background: rgba(255, 255, 255, 0.015);
            border: 1px solid rgba(255, 255, 255, 0.04);
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .setting-group.timer-group {
            overflow: visible;
        }

        .setting-group:hover {
            border-color: rgba(255, 255, 255, 0.08);
            background: rgba(255, 255, 255, 0.025);
        }

        .setting-group-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .setting-group-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .setting-group-icon {
            width: 14px;
            height: 14px;
            opacity: 0.4;
            stroke: currentColor;
        }

        .setting-group-label {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .setting-group-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--gold);
            transition: all 0.3s;
        }

        /* Options qui apparaissent au hover */
        .setting-group-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 4px;
            padding: 0 10px;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .setting-group:hover .setting-group-options {
            max-height: 70px;
            padding: 0 10px 8px;
            opacity: 1;
        }

        .setting-option-btn {
            padding: 7px 5px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-size: 0.65rem;
            font-weight: 500;
            color: var(--text-dim);
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }

        .setting-option-btn:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.1);
            color: var(--text);
        }

        .setting-option-btn.active {
            background: rgba(240, 192, 64, 0.12);
            border-color: rgba(240, 192, 64, 0.35);
            color: var(--gold);
        }

        /* Mode de jeu - 2 colonnes */
        .setting-group.mode-group .setting-group-options {
            grid-template-columns: 1fr 1fr;
        }

        .setting-group.mode-group:hover .setting-group-options {
            max-height: 85px;
        }

        .mode-btn {
            padding: 8px 6px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3px;
        }

        .mode-btn-icon {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mode-btn-icon svg {
            width: 14px;
            height: 14px;
            fill: var(--text-dim);
            transition: fill 0.3s;
        }

        .mode-btn.active .mode-btn-icon svg {
            fill: var(--gold);
        }

        .mode-btn:first-child .mode-btn-icon svg {
            fill: #ff6b6b;
        }

        .mode-btn:first-child.active .mode-btn-icon svg {
            fill: #ff6b6b;
        }

        .mode-btn:last-child.active .mode-btn-icon svg {
            fill: var(--gold);
        }

        .mode-btn-label {
            font-size: 0.55rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Questions - 4 colonnes */
        .setting-group.questions-group .setting-group-options {
            grid-template-columns: repeat(4, 1fr);
        }

        .setting-group.questions-group:hover .setting-group-options {
            max-height: 110px;
        }

        /* Animation pour masquer/afficher les groupes selon le mode */
        .setting-group.lives-group,
        .setting-group.questions-group {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            max-height: 150px;
        }

        .setting-group.lives-group.hidden,
        .setting-group.questions-group.hidden {
            max-height: 0 !important;
            opacity: 0;
            margin: 0 !important;
            padding: 0 !important;
            overflow: hidden;
            pointer-events: none;
        }

        /* Difficulté - 2 colonnes */
        .setting-group .difficulty-options {
            grid-template-columns: 1fr 1fr;
        }

        /* Réponses - 2 colonnes */
        .setting-group .answers-options {
            grid-template-columns: 1fr 1fr;
        }

        /* Timer - Slider */
        .setting-group.timer-group .setting-group-options {
            display: flex;
            flex-direction: column;
            gap: 6px;
            max-height: 0;
            padding: 0 12px;
            opacity: 0;
            overflow: visible;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .setting-group.timer-group:hover .setting-group-options {
            max-height: 65px;
            padding: 8px 12px 14px;
            opacity: 1;
        }

        .timer-slider-container {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .timer-slider {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            appearance: none;
            cursor: pointer;
            outline: none;
        }

        .timer-slider::-webkit-slider-thumb {
            appearance: none;
            width: 16px;
            height: 16px;
            background: var(--gold);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(240, 192, 64, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .timer-slider::-webkit-slider-thumb:hover {
            transform: scale(1.15);
            box-shadow: 0 0 15px rgba(240, 192, 64, 0.6);
        }

        .timer-slider::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: var(--gold);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .timer-slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.55rem;
            color: var(--text-dim);
            opacity: 0.5;
        }

        /* Series trigger - no expand, opens modal */
        .setting-group.series-trigger {
            cursor: pointer;
        }

        .setting-group.series-trigger .setting-group-options {
            display: none;
        }

        .setting-group.series-trigger:hover {
            border-color: rgba(240, 192, 64, 0.25);
        }

        .series-value-container {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .series-arrow {
            width: 12px;
            height: 12px;
            stroke: var(--gold);
            opacity: 0.6;
            transition: transform 0.3s, opacity 0.3s;
        }

        .setting-group.series-trigger:hover .series-arrow {
            opacity: 1;
            transform: translateX(3px);
        }

        /* ========== SERIES MODAL ========== */
        .series-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(3px);
            z-index: 500;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .series-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .series-modal {
            position: fixed;
            top: 5%;
            left: 0;
            height: 90%;
            width: 360px;
            background: linear-gradient(165deg, #12151a 0%, #0a0c10 100%);
            border-right: 1px solid rgba(255, 255, 255, 0.06);
            border-top-right-radius: 16px;
            border-bottom-right-radius: 16px;
            z-index: 501;
            opacity: 0;
            visibility: hidden;
            transform: translateX(-30px);
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 20px 0 60px rgba(0, 0, 0, 0.4);
        }

        .series-modal.active {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
        }

        .series-modal-header {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 16px 24px 12px;
        }

        .series-modal-title {
            display: none;
        }

        .series-modal-close {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .series-modal-close svg {
            width: 16px;
            height: 16px;
            stroke: var(--text-dim);
            transition: stroke 0.2s;
        }

        .series-modal-close:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .series-modal-close:hover svg {
            stroke: var(--text);
        }

        .series-search-container {
            padding: 0 24px 16px;
        }

        .series-search-icon {
            display: none;
        }

        .series-search-input {
            width: 100%;
            padding: 11px 16px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            color: var(--text);
            font-size: 0.8rem;
            transition: all 0.2s;
            text-align: center;
        }

        .series-search-input::placeholder {
            color: var(--text-dim);
            opacity: 0.5;
        }

        .series-search-input:focus {
            outline: none;
            border-color: rgba(240, 192, 64, 0.4);
            background: rgba(255, 255, 255, 0.05);
            text-align: left;
        }

        .series-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
            padding: 8px 24px 28px;
            overflow-y: auto;
            flex: 1;
            align-content: start;
        }

        .series-grid::-webkit-scrollbar {
            width: 4px;
        }

        .series-grid::-webkit-scrollbar-track {
            background: transparent;
        }

        .series-grid::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .series-card {
            position: relative;
            height: 92px;
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .series-card-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .series-card-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.35);
            transition: background 0.3s;
        }

        .series-card:hover .series-card-overlay {
            background: rgba(0, 0, 0, 0.25);
        }

        .series-card:hover .series-card-bg {
            transform: scale(1.08);
        }

        .series-card:hover {
            border-color: rgba(255, 255, 255, 0.2);
        }

        .series-card.active {
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(240, 192, 64, 0.2);
        }

        .series-card-check {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 22px;
            height: 22px;
            background: var(--gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.3s ease;
        }

        .series-card-check svg {
            width: 12px;
            height: 12px;
            stroke: var(--bg);
        }

        .series-card.active .series-card-check {
            opacity: 1;
            transform: scale(1);
        }

        .series-card-name {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.75rem;
            font-weight: 600;
            color: #fff;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.6);
            z-index: 2;
            text-align: center;
            width: 90%;
        }

        .series-card-soon {
            position: absolute;
            top: 8px;
            right: 8px;
            padding: 4px 8px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
            border-radius: 5px;
            font-size: 0.55rem;
            font-weight: 700;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            z-index: 2;
        }

        .series-card.soon {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .series-card.soon:hover {
            border-color: transparent;
        }

        .series-card.soon:hover .series-card-bg {
            transform: none;
        }

        /* ========== END SERIES MODAL ========== */

        /* ========== COLONNE CENTRALE - GRILLE ========== */
        .lobby-center {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .lobby-player-count-inline {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.8rem;
            background: linear-gradient(135deg, var(--gold), #e0a830);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: all 0.5s ease;
            line-height: 1;
            animation: countPulse 2s ease-in-out infinite;
        }

        @keyframes countPulse {

            0%,
            100% {
                transform: scale(1);
                filter: drop-shadow(0 0 0 rgba(240, 192, 64, 0));
            }

            50% {
                transform: scale(1.05);
                filter: drop-shadow(0 0 8px rgba(240, 192, 64, 0.4));
            }
        }

        @keyframes countBump {
            0% {
                transform: scale(1);
            }

            30% {
                transform: scale(1.3);
            }

            60% {
                transform: scale(0.95);
            }

            100% {
                transform: scale(1);
            }
        }

        .lobby-player-count-inline.bump {
            animation: countBump 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .lobby-player-count-inline.game-started {
            background: linear-gradient(135deg, var(--green), #00cc6a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .lobby-status-text {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.5;
        }

        .players-grid-lobby {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            overflow-y: auto;
            flex: 1;
            padding: 5px;
            padding-right: 15px;
            align-content: start;
        }

        /* Scrollbar moderne */
        .players-grid-lobby::-webkit-scrollbar {
            width: 4px;
        }

        .players-grid-lobby::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 4px;
        }

        .players-grid-lobby::-webkit-scrollbar-thumb {
            background: rgba(255, 215, 0, 0.3);
            border-radius: 4px;
        }

        .players-grid-lobby::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 215, 0, 0.5);
        }

        /* Mini carte joueur - Design vertical avec zone vies */
        .player-card-mini {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            padding: 14px 10px 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            min-height: 85px;
        }

        /* Accent line top */
        .player-card-mini::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 2px;
            background: var(--gold);
            border-radius: 0 0 2px 2px;
            opacity: 0.6;
            transition: all 0.3s;
        }

        .player-card-mini:hover::before {
            width: 60%;
            opacity: 1;
        }

        .player-card-mini:hover {
            background: rgba(255, 255, 255, 0.04);
            border-color: rgba(240, 192, 64, 0.3);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2), 0 0 30px rgba(240, 192, 64, 0.08);
        }

        /* Status indicator */
        .player-card-mini-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background: var(--gold);
            box-shadow: 0 0 6px rgba(240, 192, 64, 0.6);
            transition: all 0.5s ease;
        }

        .player-card-mini-badge.game-started {
            background: var(--green);
            box-shadow: 0 0 6px rgba(0, 255, 136, 0.6);
        }

        /* Player name */
        .player-card-mini-name {
            font-size: 0.75rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            padding: 0 5px;
            transition: color 0.3s;
        }

        .player-card-mini:hover .player-card-mini-name {
            color: var(--gold);
        }

        .player-card-mini-title {
            font-size: 0.55rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.5;
            text-align: center;
            margin-top: -3px;
        }

        .player-card-mini.champion .player-card-mini-title {
            color: var(--gold);
            opacity: 0.7;
        }

        /* Zone for lives/points - empty in lobby, filled in game */
        .player-card-mini-stats {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            min-height: 18px;
            font-size: 0.7rem;
            opacity: 0.7;
        }

        .player-card-mini-stats .heart {
            color: var(--red);
            font-size: 0.65rem;
        }

        .player-card-mini-stats .heart.lost {
            opacity: 0.25;
        }

        .player-card-mini-stats .points {
            color: var(--gold);
            font-weight: 600;
            font-family: 'Space Grotesk', sans-serif;
        }

        /* Answer overlay - shown after question */
        .player-card-mini-answer {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            border-radius: 12px;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            padding: 8px;
            text-align: center;
        }

        .player-card-mini-answer.correct {
            color: var(--green);
            border: 1px solid rgba(0, 255, 136, 0.4);
        }

        .player-card-mini-answer.wrong {
            color: var(--red);
            border: 1px solid rgba(255, 59, 92, 0.4);
        }

        .player-card-mini:hover .player-card-mini-answer {
            display: flex;
        }

        /* Avatar caché */
        .player-card-mini-avatar {
            display: none;
        }

        /* ========== EFFET CHAMPION - Gagnant dernière partie ========== */
        .player-card-mini.champion {
            border-color: rgba(240, 192, 64, 0.35);
            background: rgba(240, 192, 64, 0.04);
            overflow: visible;
        }

        .player-card-mini.champion::before {
            background: linear-gradient(90deg, transparent 20%, var(--gold) 50%, transparent 80%);
            opacity: 0.6;
        }

        .player-card-mini.champion .player-card-mini-badge {
            background: var(--gold);
        }

        .player-card-mini.champion .player-card-mini-name {
            color: var(--gold);
        }

        /* Couronne du champion */
        .player-card-mini.champion::after {
            content: '';
            position: absolute;
            top: -16px;
            left: 50%;
            transform: translateX(-50%);
            width: 24px;
            height: 24px;
            background-image: url('crown3.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 10;
        }

        /* Colonne droite - Actions simplifiées */

        /* ========== MODAL CARTE JOUEUR ========== */
        .player-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 700;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .player-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .player-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            z-index: 701;
            opacity: 0;
            visibility: hidden;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: visible;
        }

        .player-modal.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .player-modal-close {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.15);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .player-modal-close svg {
            width: 16px;
            height: 16px;
            stroke: var(--text-dim);
            transition: all 0.3s;
        }

        .player-modal-close:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.25);
        }

        .player-modal-close:hover svg {
            stroke: var(--text);
        }

        .player-modal-card {
            position: relative;
            width: 320px;
            background: linear-gradient(165deg, rgba(20, 24, 30, 0.98) 0%, rgba(12, 14, 18, 0.98) 100%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 35px 30px 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            overflow: visible;
        }

        .player-modal-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 2px solid rgba(240, 192, 64, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .player-modal-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .player-modal-avatar::after {
            content: '';
            position: absolute;
            inset: -4px;
            border-radius: 50%;
            border: 1px solid rgba(240, 192, 64, 0.15);
        }

        .player-modal-name {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text);
            letter-spacing: 0.5px;
        }

        .player-modal-badge {
            font-size: 0.65rem;
            color: var(--gold);
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.8;
            margin-top: -10px;
        }

        .player-modal-badge:empty {
            display: none;
        }

        .player-modal-title {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            opacity: 0.5;
            margin-top: -12px;
        }

        .player-modal-title:empty {
            display: none;
        }

        .player-modal-stats {
            display: flex;
            gap: 25px;
            padding: 20px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.06);
            width: 100%;
            justify-content: center;
        }

        .player-modal-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .player-modal-stat .stat-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.8rem;
            color: var(--gold);
            line-height: 1;
        }

        .player-modal-stat .stat-label {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.6;
        }

        /* Champion badge sur la modal */
        .player-modal-card.champion {
            padding-top: 45px;
        }

        .player-modal-card.champion .player-modal-avatar {
            border-color: rgba(240, 192, 64, 0.5);
        }

        .player-modal-card.champion::before {
            content: '';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 32px;
            height: 32px;
            background-image: url('crown3.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        /* ============================================
           ÉTAT GAME (En partie) - PANEL CENTRÉ + SLIDE
        ============================================ */
        .state-game {
            position: fixed;
            top: 56px;
            /* Commence APRÈS le header */
            left: 0;
            right: 0;
            bottom: 0;
            /* PAS de width/height - laisse top/right/bottom/left définir la taille */
            display: none;
            z-index: 160;
            opacity: 0;
        }

        .state-game.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .game-layout {
            position: relative;
            /* AJOUTER */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            width: 100%;
            max-width: 1300px;
        }

        /* ===== WRAPPER QUESTION (panel + boutons) ===== */
        .game-question-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            align-self: center;
            gap: 12px;
            /* État par défaut : invisible */
            opacity: 0;
            transform: translateY(60px) scale(0.95);
        }

        .game-question-wrapper.visible {
            opacity: 1;
            transform: translateY(0) scale(1);
        }


        .game-question-wrapper.entering {
            animation: questionEnter 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }


        .game-question-wrapper.entering-fast {
            animation: questionEnter 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }


        @keyframes questionEnter {
            0% {
                opacity: 0;
                transform: translateY(60px) scale(0.95);
            }

            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .game-question-wrapper.no-transition {
            transition: none !important;
        }

        /* Animation de sortie (collapse) */
        .game-question-wrapper.exiting {
            animation: questionExit 0.35s ease-in forwards;
            transition: none !important;
            /* Bloquer les transitions de margin */
        }

        @keyframes questionExit {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
        }

        .game-question-wrapper.shifted {
            margin-right: -120px;
            margin-top: -30px;
            z-index: 20;
            position: relative;
            transition: margin 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ===== PANEL QUESTION ===== */
        .game-question-panel {
            flex: 0 0 auto;
            width: 460px;
            position: relative;
            background: linear-gradient(165deg, rgba(22, 26, 32, 0.98) 0%, rgba(14, 16, 20, 0.98) 100%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            padding: 46px 30px 38px;
            display: flex;
            flex-direction: column;
            box-shadow:
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.03) inset;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            animation: floatPanel 4s ease-in-out infinite;
        }

        @keyframes floatPanel {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(10px);
            }
        }

        .game-question-wrapper.shifted .game-question-panel {
            width: 420px;
            padding: 32px 20px 24px;
            animation: none;
            box-shadow:
                20px 0 60px rgba(0, 0, 0, 0.6),
                0 20px 60px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.03) inset;
        }

        /* Badge Question X sur le border-top (style onglet) */
        .question-tab-badge {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            padding: 5px 16px;
            background: linear-gradient(135deg, rgba(240, 192, 64, 0.2) 0%, rgba(240, 192, 64, 0.1) 100%);
            border: 1px solid rgba(240, 192, 64, 0.4);
            border-radius: 16px;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.6rem;
            font-weight: 700;
            color: var(--gold);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            white-space: nowrap;
        }

        /* Badges série + difficulté dans le panel */
        .question-badges-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 18px;
            margin-top: -2px;
        }

        .question-series-badge {
            padding: 4px 10px;
            background: rgba(100, 180, 255, 0.12);
            border: 1px solid rgba(100, 180, 255, 0.3);
            border-radius: 5px;
            font-size: 0.55rem;
            font-weight: 700;
            color: #64b4ff;
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .question-difficulty-badge {
            padding: 4px 10px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.25);
            border-radius: 5px;
            font-size: 0.55rem;
            font-weight: 700;
            color: var(--green);
            text-transform: uppercase;
            letter-spacing: 0.8px;
        }

        .question-difficulty-badge.medium {
            background: rgba(240, 192, 64, 0.1);
            border-color: rgba(240, 192, 64, 0.25);
            color: var(--gold);
        }

        .question-difficulty-badge.hard {
            background: rgba(255, 59, 92, 0.1);
            border-color: rgba(255, 59, 92, 0.25);
            color: var(--red);
        }

        /* Timer circulaire */
        .timer-container {
            position: absolute;
            top: 24px;
            right: 20px;
            width: 40px;
            height: 40px;
        }

        .timer-circle {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .timer-circle-bg {
            fill: none;
            stroke: rgba(255, 255, 255, 0.08);
            stroke-width: 3;
        }

        .timer-circle-progress {
            fill: none;
            stroke: var(--gold);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-dasharray: 138;
            stroke-dashoffset: 0;
            transition: stroke-dashoffset 1s linear, stroke 0.3s ease;
        }

        .timer-circle-progress.warning {
            stroke: var(--red);
        }

        .timer-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.1rem;
            color: var(--gold);
            transition: color 0.3s ease;
        }

        .timer-text.warning {
            color: var(--red);
            animation: timerPulse 0.5s ease infinite;
        }

        @keyframes timerPulse {

            0%,
            100% {
                transform: translate(-50%, -50%) scale(1);
            }

            50% {
                transform: translate(-50%, -50%) scale(1.15);
            }
        }

        /* Texte de la question */
        .question-text {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
            line-height: 1.5;
            text-align: center;
            margin-bottom: 28px;
            padding: 0 35px 0 5px;
        }

        .game-question-wrapper.shifted .question-text {
            font-size: 0.82rem;
            padding-right: 25px;
            margin-bottom: 18px;
        }

        /* Zone réponses - colonne, avec plus d'espace */
        .answers-grid {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .answer-option {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 16px 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .answer-option:hover:not(.revealed) {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(240, 192, 64, 0.3);
            transform: translateX(5px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .answer-option:hover:not(.revealed) .answer-text {
            color: var(--gold);
        }

        .answer-option::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 0%;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.06), transparent);
            transition: width 0.5s ease;
        }

        .answer-text {
            font-size: 0.78rem;
            color: var(--text);
            font-weight: 500;
            position: relative;
            z-index: 1;
            text-align: center;
            flex: 1;
            margin-right: 50px;
            margin-left: 50px;
        }

        /* Pourcentages TOUJOURS visibles */
        .answer-percent {
            position: absolute;
            right: 14px;
            font-family: 'Bebas Neue', sans-serif;
            font-size: 0.95rem;
            /*color: var(--gold); */
            color: rgba(255, 255, 255, 0.6);
            /* Couleur dorée au lieu de gris */
            opacity: 0.2;
            /* Plus visible */
            transition: all 0.4s ease;
            z-index: 2;
        }

        .answer-option:hover .answer-percent {
            opacity: 0.7;
        }

        /* États des réponses après révélation */
        .answer-option.correct {
            border-color: rgba(0, 255, 136, 0.5);
            background: rgba(0, 255, 136, 0.1);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.15);
        }

        .answer-option.correct .answer-text {
            color: var(--green);
            font-weight: 600;
        }

        .answer-option.correct .answer-percent {
            color: var(--green);
            opacity: 1;
        }

        .answer-option.wrong {
            opacity: 0.4;
        }

        .answer-option.revealed .answer-percent {
            opacity: 1;
        }

        .answer-option.revealed::before {
            width: var(--percent, 0%);
        }


        /* Mini boutons en haut à gauche du panel */
        .panel-mini-actions {
            position: absolute;
            top: -12px;
            left: 20px;
            display: flex;
            gap: 6px;
            z-index: 10;
            opacity: 0;
            transform: translateY(5px);
            pointer-events: none;
            transition: all 0.3s ease;
        }


        .game-question-wrapper.shifted .panel-mini-actions {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .mini-action-btn {
            width: 32px;
            /* était 28px */
            height: 28px;
            /* était 24px */
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.25s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .mini-action-btn svg {
            width: 14px;
            /* était 12px */
            height: 14px;
            transition: all 0.25s ease;
        }


        /* Bouton Signaler - teinte rouge */
        .mini-action-btn.report {
            background: linear-gradient(135deg, rgba(255, 59, 92, 0.15) 0%, rgba(255, 59, 92, 0.08) 100%);
            border: 1px solid rgba(255, 59, 92, 0.3);
        }


        .mini-action-btn.report svg {
            stroke: rgba(255, 59, 92, 0.7);
        }

        .mini-action-btn.report:hover {
            background: linear-gradient(135deg, rgba(255, 59, 92, 0.2) 0%, rgba(255, 59, 92, 0.1) 100%);
            border-color: rgba(255, 59, 92, 0.4);
        }

        .mini-action-btn.report:hover svg {
            stroke: var(--red);
        }


        .mini-action-btn.auto-toggle {
            background: linear-gradient(135deg, rgba(100, 180, 255, 0.15) 0%, rgba(100, 180, 255, 0.08) 100%);
            border: 1px solid rgba(100, 180, 255, 0.3);
        }

        .mini-action-btn.auto-toggle svg {
            stroke: rgba(100, 180, 255, 0.7);
        }

        .mini-action-btn.auto-toggle:hover {
            background: linear-gradient(135deg, rgba(100, 180, 255, 0.25) 0%, rgba(100, 180, 255, 0.15) 100%);
            border-color: rgba(100, 180, 255, 0.5);
        }

        .mini-action-btn.auto-toggle:hover svg {
            stroke: #64b4ff;
        }

        .mini-action-btn.auto-toggle.active {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.2) 0%, rgba(0, 255, 136, 0.1) 100%);
            border-color: rgba(0, 255, 136, 0.5);
        }

        .mini-action-btn.auto-toggle.active svg {
            stroke: var(--green);
        }

        /* Boutons SOUS le panel */
        .question-actions {
            display: flex;
            width: 100%;
            max-width: 460px;
            opacity: 0;
            transform: translateY(8px);
            pointer-events: none;
            transition: all 0.4s ease;
        }

        .game-question-wrapper.shifted .question-actions {
            max-width: 420px;
        }

        .question-actions.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .question-action-btn span {
            font-size: 0.6rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .question-action-btn svg {
            width: 12px;
            height: 12px;
        }

        .question-action-btn.next {
            width: 100%;
            padding: 14px 20px;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(240, 192, 64, 0.2) 0%, rgba(240, 192, 64, 0.08) 100%);
            border: 1px solid rgba(240, 192, 64, 0.4);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }


        .question-action-btn.next::after {
            content: '';
            position: absolute;
            inset: -3px;
            border-radius: 16px;
            border: 1px solid var(--gold);
            opacity: 0;
            animation: btnPulse 2s ease-in-out infinite;
        }

        @keyframes btnPulse {

            0%,
            100% {
                opacity: 0;
                transform: scale(1);
            }

            50% {
                opacity: 0.4;
                transform: scale(1.02);
            }
        }


        .question-action-btn.next::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(240, 192, 64, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .question-action-btn.next:hover::before {
            left: 100%;
        }

        .question-action-btn.next span {
            font-size: 0.75rem;
            /* était 0.85rem */
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--gold);
        }

        .question-action-btn.next svg {
            width: 18px;
            height: 18px;
            stroke: var(--gold);
            transition: transform 0.3s ease;
        }


        /* Container pour les 2 boutons du bas */
        .question-actions-row {
            display: flex;
            gap: 10px;
            width: 100%;
        }

        /* Boutons Signaler et Auto/Manuel */
        .question-action-btn.secondary {
            flex: 1;
            padding: 10px 16px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.03);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .question-action-btn.secondary span {
            font-size: 0.6rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-dim);
        }

        .question-action-btn.secondary svg {
            width: 14px;
            height: 14px;
            stroke: var(--text-dim);
        }

        .question-action-btn.next:hover {
            background: linear-gradient(135deg, rgba(240, 192, 64, 0.35) 0%, rgba(240, 192, 64, 0.15) 100%);
            border-color: rgba(240, 192, 64, 0.7);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(240, 192, 64, 0.25);
        }


        .question-action-btn.next:hover svg {
            transform: translateX(4px);
        }

        .question-action-btn.report span {
            color: var(--red);
        }

        .question-action-btn.report svg {
            stroke: var(--red);
        }

        .question-action-btn.report:hover {
            background: rgba(255, 59, 92, 0.1);
            border-color: rgba(255, 59, 92, 0.3);
        }


        .question-action-btn.report:hover span {
            color: var(--red);
        }

        .question-action-btn.report:hover svg {
            stroke: var(--red);
        }


        .question-action-btn.auto-toggle {
            position: relative;
        }


        .question-action-btn.auto-toggle:hover {
            background: rgba(100, 180, 255, 0.1);
            border-color: rgba(100, 180, 255, 0.3);
        }

        .question-action-btn.auto-toggle:hover span {
            color: #64b4ff;
        }


        .question-action-btn.auto-toggle:hover svg {
            stroke: #64b4ff;
        }

        /* État actif pour Auto */
        .question-action-btn.auto-toggle.active {
            background: rgba(0, 255, 136, 0.1);
            border-color: rgba(0, 255, 136, 0.4);
        }


        .question-action-btn.auto-toggle.active span {
            color: var(--green);
        }

        .question-action-btn.auto-toggle.active svg {
            stroke: var(--green);
        }

        /* ===== PANEL GRILLE/STATS (DROITE) ===== */
        .game-main-panel {
            flex: 0 0 0;
            width: 0;
            min-height: 550px;
            max-height: 600px;
            align-self: center;
            background: linear-gradient(165deg, rgba(18, 20, 26, 0.98) 0%, rgba(12, 14, 18, 0.98) 100%);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 16px;
            overflow: hidden;
            opacity: 0;
            z-index: 10;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        }

        .game-main-panel.visible {
            flex: 0 0 1000px;
            width: 1000px;
            opacity: 1;
        }

        /* Tabs du panel */
        .panel-tabs {
            display: flex;
            justify-content: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            padding: 0 20px;
            background: rgba(0, 0, 0, 0.2);
        }

        .panel-tab {
            padding: 16px 25px;
            background: none;
            border: none;
            color: var(--text-dim);
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .panel-tab::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gold);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .panel-tab.active {
            color: var(--gold);
        }

        .panel-tab.active::after {
            transform: scaleX(1);
        }

        .panel-tab:hover:not(.active) {
            color: var(--text);
        }

        /* Contenu du panel */
        .panel-content {
            flex: 1;
            overflow: hidden;
            position: relative;
        }


        .panel-tab-content {
            position: absolute;
            inset: 0;
            padding: 50px 40px 20px 200px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            overflow-y: auto;
        }

        #tabGrille {
            padding-top: 60px;
        }

        .panel-tab-content.active {
            opacity: 1;
            visibility: visible;
        }

        .panel-tab-content::-webkit-scrollbar {
            width: 5px;
        }

        .panel-tab-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .panel-tab-content::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }

        /* Header stats dans panel */
        .panel-header-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .panel-stat {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-stat-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.6rem;
            color: var(--green);
        }

        .panel-stat-label {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .panel-stat.answered .panel-stat-value {
            color: var(--gold);
        }

        /* Grille joueurs */
        .players-grid-game {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            /* 4 colonnes fixes */
            gap: 20px;
            /* Augmenté de 14px à 20px */
            justify-content: center;
            max-width: 700px;
            /* Limiter la largeur pour centrer */
            margin: 0 auto;
            /* Centrer */
        }

        /* Cartes joueurs */
        .player-card-game {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            padding: 16px 14px;
            /* était 14px 12px */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            min-height: 95px;
            /* était 85px */
            min-width: 140px;
            /* AJOUTER - largeur minimum */
        }

        .player-card-game:hover {
            border-color: rgba(240, 192, 64, 0.3);
            background: rgba(255, 255, 255, 0.04);
            transform: translateY(-2px);
        }

        .player-card-game::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            /* Augmenté de 30px à 60% */
            height: 2px;
            background: var(--gold);
            border-radius: 0 0 2px 2px;
            opacity: 0.5;
            transition: all 0.3s ease;
            box-shadow: 0 0 8px rgba(240, 192, 64, 0.4);
            /* Glow effect */
        }

        .player-card-game:hover::before {
            width: 50px;
            opacity: 0.7;
        }

        /* Overlay réponse au hover */
        .player-card-game-answer-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.92);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 8px 10px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.25s ease;
            z-index: 10;
            pointer-events: none;
        }

        .player-card-game:hover .player-card-game-answer-overlay {
            opacity: 1;
            visibility: visible;
        }

        .player-card-game-answer-overlay .answer-label {
            display: none;
        }

        .player-card-game-answer-overlay .answer-text-display {
            font-size: 0.65rem;
            font-weight: 600;
            color: var(--green);
            line-height: 1.3;
            text-align: center;
            word-break: break-word;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .player-card-game-answer-overlay .answer-text-display.wrong {
            color: var(--red);
        }

        .player-card-game-answer-overlay .answer-text-display.no-answer {
            color: var(--text-dim);
            font-style: italic;
        }

        .player-card-game-name {
            font-size: 0.7rem;
            font-weight: 500;
            color: var(--text);
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            padding-bottom: 8px;
            margin-bottom: 8px;
            position: relative;
        }

        .player-card-game-name::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40%;
            height: 1px;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.15),
                    transparent);
        }


        /* Ligne qui prend la couleur selon le statut */
        .player-card-game.correct-answer .player-card-game-name::after {
            background: linear-gradient(90deg,
                    transparent,
                    rgba(0, 255, 136, 0.3),
                    transparent);
        }

        .player-card-game.wrong-answer .player-card-game-name::after {
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 59, 92, 0.3),
                    transparent);
        }

        .player-card-game-lives {
            display: flex;
            gap: 3px;
            align-items: center;
        }

        .player-card-game-lives .heart {
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }


        .player-card-game-lives .heart {
            width: 16px;
            height: 16px;
            background-image: url('hhheart.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .player-card-game-lives .heart svg {
            display: none;
            /* Cacher le SVG */
        }


        .player-card-game-lives .heart.lost {
            opacity: 0.2;
            filter: grayscale(100%);
        }

        .player-card-game-lives .heart.lost svg {
            fill: #333;
            opacity: 0.3;
        }

        .player-card-game-points {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1rem;
            color: var(--gold);
        }

        /* Indicateur "a répondu" */
        .player-card-game .answered-indicator {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 7px;
            height: 7px;
            border-radius: 50%;
            background: var(--green);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .player-card-game.has-answered .answered-indicator {
            opacity: 1;
        }

        /* États après révélation */
        .player-card-game.correct-answer {
            border-color: rgba(0, 255, 136, 0.5);
            background: rgba(0, 255, 136, 0.02);
            /* Réduit de 0.04 à 0.02 */
        }


        .player-card-game.correct-answer::before {
            background: var(--green);
            width: 80%;
            opacity: 0.8;
            box-shadow: 0 0 12px rgba(0, 255, 136, 0.6);
        }

        .player-card-game.wrong-answer {
            border-color: rgba(255, 59, 92, 0.5);
            background: rgba(255, 59, 92, 0.02);
            /* Réduit de 0.04 à 0.02 */
        }

        .player-card-game.wrong-answer {
            border-color: rgba(255, 59, 92, 0.4);
            background: rgba(255, 59, 92, 0.08);
        }

        .player-card-game.wrong-answer::before {
            background: var(--red);
            width: 80%;
            opacity: 0.8;
            box-shadow: 0 0 12px rgba(255, 59, 92, 0.6);
        }

        .player-card-game.eliminated {
            opacity: 0.25;
        }

        .player-card-game.eliminated::after {
            content: 'X';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.3rem;
            font-weight: bold;
            color: var(--red);
            opacity: 0.6;
        }

        /* Champion */
        .player-card-game.champion {
            border-color: rgba(240, 192, 64, 0.4);
            background: rgba(240, 192, 64, 0.05);
        }

        .player-card-game.champion::before {
            background: var(--gold);
            opacity: 0.8;
            width: 40px;
        }

        .player-card-game.champion .player-card-game-name {
            color: var(--gold);
        }

        .player-card-game.champion .player-card-game-answer-overlay {
            border: 1px solid rgba(240, 192, 64, 0.5);
        }

        /* Champion avec bonne réponse = vert */
        .player-card-game.champion.correct-answer {
            border-color: rgba(0, 255, 136, 0.5);
            background: rgba(0, 255, 136, 0.1);
        }

        .player-card-game.champion.correct-answer::before {
            background: var(--green);
        }

        /* Champion avec mauvaise réponse = rouge */
        .player-card-game.champion.wrong-answer {
            border-color: rgba(255, 59, 92, 0.5);
            background: rgba(255, 59, 92, 0.1);
        }

        .player-card-game.champion.wrong-answer::before {
            background: var(--red);
        }

        /* Stats content */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            max-width: 600px;
            margin: 0 auto;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 18px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .stat-card-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.2rem;
            color: var(--gold);
        }

        .stat-card-label {
            font-size: 0.65rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
            text-align: center;
        }

        .stat-card.green .stat-card-value {
            color: var(--green);
        }

        .stat-card.red .stat-card-value {
            color: var(--red);
        }

        /* ===== ANIMATION GAME START ===== */
        .game-start-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.92);
            z-index: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .game-start-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .game-start-text {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 10rem;
            color: var(--gold);
            text-shadow: 0 0 80px rgba(240, 192, 64, 0.5);
            transform: scale(0.5);
            opacity: 0;
            letter-spacing: 0.05em;
        }

        /* Background text pendant le jeu */
        .bg-text.game-active {
            font-size: 15vw;
            color: rgba(240, 192, 64, 0.035);
        }

        /* Header status en mode game */
        .status-pill.game-mode {
            background: rgba(240, 192, 64, 0.1);
            border-color: rgba(240, 192, 64, 0.3);
        }

        .status-pill.game-mode .status-dot {
            background: var(--gold);
            box-shadow: 0 0 8px rgba(240, 192, 64, 0.6);
        }

        .status-pill.game-mode #statusText {
            color: var(--gold);
        }

        /* ========== HEADER GRID ========== */
        .lobby-grid-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 0 5px;
        }

        .lobby-header-left {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: 15px;
        }

        .lobby-header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        /* Boutons texte dans le header (Actualiser, Fermer) */
        .header-text-btn {
            padding: 0;
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .header-text-btn span {
            font-size: 0.65rem;
            font-weight: 500;
            color: var(--text-dim);
            opacity: 0.5;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
        }

        .header-text-btn svg {
            width: 14px;
            height: 14px;
            stroke: var(--text-dim);
            opacity: 0.5;
            transition: all 0.3s;
        }

        /* Ligne futuriste au hover */
        .header-text-btn::before,
        .header-text-btn::after {
            content: '';
            position: absolute;
            height: 1px;
            background: var(--gold);
            transition: all 0.3s ease;
            opacity: 0;
        }

        .header-text-btn::before {
            top: -4px;
            left: 50%;
            right: 50%;
        }

        .header-text-btn::after {
            bottom: -4px;
            left: 50%;
            right: 50%;
        }

        .header-text-btn:hover span {
            color: var(--gold);
            opacity: 1;
            text-shadow: 0 0 20px rgba(240, 192, 64, 0.5);
        }

        .header-text-btn:hover svg {
            stroke: var(--gold);
            opacity: 1;
        }

        .header-text-btn:hover::before,
        .header-text-btn:hover::after {
            left: 0;
            right: 0;
            opacity: 0.6;
        }

        /* Copy button - icon only */
        .header-text-btn.copy {
            padding: 5px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
        }

        .header-text-btn.copy svg {
            width: 13px;
            height: 13px;
            opacity: 0.5;
        }

        .header-text-btn.copy::before,
        .header-text-btn.copy::after {
            display: none;
        }

        .header-text-btn.copy:hover {
            background: rgba(240, 192, 64, 0.1);
            border-color: rgba(240, 192, 64, 0.3);
        }

        .header-text-btn.copy:hover svg {
            stroke: var(--gold);
            opacity: 1;
        }

        .header-text-btn.copy.copied {
            background: rgba(0, 255, 136, 0.1);
            border-color: rgba(0, 255, 136, 0.3);
        }

        .header-text-btn.copy.copied svg {
            stroke: var(--green);
            opacity: 1;
        }

        .header-action-btn {
            width: 42px;
            height: 42px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .header-action-btn svg {
            width: 18px;
            height: 18px;
            stroke: var(--text-dim);
            transition: all 0.3s;
        }

        .header-action-btn:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.15);
        }

        .header-action-btn:hover svg {
            stroke: var(--text);
        }

        .header-action-btn.simulate:hover {
            background: rgba(240, 192, 64, 0.08);
            border-color: rgba(240, 192, 64, 0.25);
        }

        .header-action-btn.simulate:hover svg {
            stroke: var(--gold);
        }

        .header-action-btn.close:hover {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
        }

        .header-action-btn.close:hover svg {
            stroke: #ef4444;
        }

        /* Bouton Fermer lobby - texte simple */
        .header-close-btn {
            padding: 0;
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;

        }

        .header-close-btn span {
            font-size: 0.65rem;
            font-weight: 500;
            color: var(--text-dim);
            opacity: 0.5;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
            position: relative;
        }

        /* Ligne futuriste au hover */
        .header-close-btn::before,
        .header-close-btn::after {
            content: '';
            position: absolute;
            height: 1px;
            background: var(--gold);
            transition: all 0.3s ease;
            opacity: 0;
        }

        .header-close-btn::before {
            top: -4px;
            left: 50%;
            right: 50%;
        }

        .header-close-btn::after {
            bottom: -4px;
            left: 50%;
            right: 50%;
        }

        .header-close-btn:hover span {
            color: var(--gold);
            opacity: 1;
            text-shadow: 0 0 20px rgba(240, 192, 64, 0.5);
        }

        .header-close-btn:hover::before,
        .header-close-btn:hover::after {
            left: 0;
            right: 0;
            opacity: 0.6;
        }

        /* Glitch effect on hover */
        @keyframes glitchText {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-2px);
            }

            75% {
                transform: translateX(2px);
            }
        }

        .header-close-btn:hover span {
            animation: glitchText 0.3s ease;
        }

        /* ========== COLONNE DROITE - GAMING HUD STYLE ========== */
        .lobby-actions-full {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
            height: 100%;
            padding: 30px 10px;
        }

        .action-full-btn {
            width: 100%;
            position: relative;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: transparent;
            border: none;
            padding: 0;
        }

        /* Hexagon shape with clip-path */
        .action-full-content {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 28px 20px;
            gap: 6px;
            clip-path: polygon(10% 0%, 90% 0%, 100% 50%, 90% 100%, 10% 100%, 0% 50%);
            transition: all 0.3s ease;
        }

        /* Scan line effect */
        .action-full-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, currentColor, transparent);
            opacity: 0;
            transform: translateY(0);
            transition: all 0.4s ease;
        }

        .action-full-btn:hover .action-full-content::before {
            opacity: 0.6;
            animation: scanLine 1s ease-in-out infinite;
        }

        @keyframes scanLine {
            0% {
                transform: translateY(0);
                opacity: 0.6;
            }

            100% {
                transform: translateY(70px);
                opacity: 0;
            }
        }

        /* Corner accents */
        .action-full-content::after {
            content: '';
            position: absolute;
            inset: 0;
            clip-path: polygon(10% 0%, 90% 0%, 100% 50%, 90% 100%, 10% 100%, 0% 50%);
            border: 1px solid currentColor;
            opacity: 0.3;
            transition: opacity 0.3s;
        }

        .action-full-btn:hover .action-full-content::after {
            opacity: 0.6;
        }

        .action-full-label {
            font-size: 0.9rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 3px;
            transition: all 0.3s;
            position: relative;
            z-index: 2;
        }

        .action-full-sub {
            font-size: 0.55rem;
            opacity: 0.5;
            letter-spacing: 1px;
            transition: all 0.3s;
            position: relative;
            z-index: 2;
        }

        /* Decorative lines */
        .action-hud-line {
            position: absolute;
            background: currentColor;
            opacity: 0.2;
            transition: all 0.3s;
        }

        .action-hud-line.top {
            top: -8px;
            left: 20%;
            right: 20%;
            height: 1px;
        }

        .action-hud-line.bottom {
            bottom: -8px;
            left: 20%;
            right: 20%;
            height: 1px;
        }

        .action-full-btn:hover .action-hud-line {
            opacity: 0.5;
            left: 10%;
            right: 10%;
        }

        /* Bouton Démarrer - Gaming HUD */
        .action-full-btn.start {
            color: var(--gold);
        }

        .action-full-btn.start .action-full-content {
            background: linear-gradient(180deg, rgba(240, 192, 64, 0.12) 0%, rgba(240, 192, 64, 0.04) 100%);
        }

        .action-full-btn.start .action-full-label {
            color: var(--gold);
            text-shadow: 0 0 20px rgba(240, 192, 64, 0.5);
        }

        .action-full-btn.start .action-full-sub {
            color: var(--gold);
        }

        .action-full-btn.start:hover {
            transform: scale(1.02);
        }

        .action-full-btn.start:hover .action-full-content {
            background: linear-gradient(180deg, rgba(240, 192, 64, 0.2) 0%, rgba(240, 192, 64, 0.08) 100%);
        }

        .action-full-btn.start:hover .action-full-label {
            text-shadow: 0 0 30px rgba(240, 192, 64, 0.8);
        }

        /* Bouton Fermer - Gaming HUD */
        .action-full-btn.close {
            color: var(--text-dim);
        }

        .action-full-btn.close .action-full-content {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.01) 100%);
        }

        .action-full-btn.close .action-full-label {
            color: var(--text-dim);
        }

        .action-full-btn.close .action-full-sub {
            color: var(--text-dim);
        }

        .action-full-btn.close:hover {
            color: #ef4444;
            transform: scale(1.02);
        }

        .action-full-btn.close:hover .action-full-content {
            background: linear-gradient(180deg, rgba(239, 68, 68, 0.12) 0%, rgba(239, 68, 68, 0.04) 100%);
        }

        .action-full-btn.close:hover .action-full-label {
            color: #ef4444;
            text-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
        }

        .action-full-btn.close:hover .action-full-sub {
            color: #ef4444;
        }

        /* État started - Gaming HUD */
        .action-full-btn.start.started {
            color: var(--green);
        }

        .action-full-btn.start.started .action-full-content {
            background: linear-gradient(180deg, rgba(0, 255, 136, 0.15) 0%, rgba(0, 255, 136, 0.05) 100%);
        }

        .action-full-btn.start.started .action-full-label {
            color: var(--green);
            text-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .action-full-btn.start.started .action-full-sub {
            color: var(--green);
        }

        /* État disabled - pas assez de joueurs */
        .action-full-btn.start.disabled {
            pointer-events: none;
            opacity: 0.4;
        }

        .action-full-btn.start.disabled .action-full-content {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.01) 100%);
        }

        .action-full-btn.start.disabled .action-full-label {
            color: var(--text-dim);
            text-shadow: none;
        }

        .action-full-btn.start.disabled .action-full-sub {
            color: var(--text-dim);
        }

        .action-full-btn.start.disabled .action-hud-line {
            opacity: 0.1;
        }

        /* Animation d'activation du bouton */
        @keyframes buttonActivate {
            0% {
                opacity: 0.4;
                transform: scale(1);
            }

            30% {
                opacity: 1;
                transform: scale(1.08);
            }

            50% {
                transform: scale(0.95);
            }

            70% {
                transform: scale(1.03);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes glowPulse {

            0%,
            100% {
                box-shadow: 0 0 0 rgba(240, 192, 64, 0);
            }

            50% {
                box-shadow: 0 0 40px rgba(240, 192, 64, 0.4);
            }
        }

        .action-full-btn.start.just-activated {
            animation: buttonActivate 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        .action-full-btn.start.just-activated .action-full-content {
            animation: glowPulse 0.8s ease-out;
        }

        /* Bouton temporaire pour ajouter des joueurs */
        .temp-add-player-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 22px;
            background: rgba(240, 192, 64, 0.1);
            border: 1px solid rgba(240, 192, 64, 0.3);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .temp-add-player-btn svg {
            width: 20px;
            height: 20px;
            stroke: var(--gold);
        }

        .temp-add-player-btn span {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--gold);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .temp-add-player-btn:hover {
            background: rgba(240, 192, 64, 0.2);
            border-color: rgba(240, 192, 64, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(240, 192, 64, 0.2);
        }

        .temp-add-player-btn:active {
            transform: translateY(0) scale(0.98);
        }

        /* Badge compteur sur le bouton */
        .temp-add-player-btn::after {
            content: 'TEST';
            position: absolute;
            top: -8px;
            right: -8px;
            padding: 3px 8px;
            background: var(--gold);
            color: var(--bg);
            font-size: 0.5rem;
            font-weight: 700;
            border-radius: 4px;
            letter-spacing: 0.5px;
        }

        /* ============================================
           PANEL PARAMÈTRES (slide)
           ============================================ */
        .settings-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 300;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .settings-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .settings-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 360px;
            height: 100%;
            background: linear-gradient(180deg, #0f1117 0%, #0a0b0f 100%);
            border-left: 1px solid rgba(255, 255, 255, 0.06);
            z-index: 301;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            box-shadow: -20px 0 60px rgba(0, 0, 0, 0.5);
        }

        .settings-panel.active {
            transform: translateX(0);
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 28px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }

        .settings-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .settings-close {
            width: 34px;
            height: 34px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .settings-close:hover {
            border-color: rgba(255, 59, 92, 0.4);
            background: rgba(255, 59, 92, 0.1);
        }

        .settings-close svg {
            width: 14px;
            height: 14px;
            stroke: var(--text-dim);
            transition: stroke 0.3s;
        }

        .settings-close:hover svg {
            stroke: var(--red);
        }

        .settings-content {
            flex: 1;
            padding: 28px;
            overflow-y: auto;
        }

        /* Scrollbar settings panel */
        .settings-content::-webkit-scrollbar {
            width: 4px;
        }

        .settings-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .settings-content::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }

        .settings-content::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .setting-group {
            margin-bottom: 28px;
        }

        .setting-label {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 14px;
            opacity: 0.7;
        }

        .setting-options {
            display: flex;
            gap: 10px;
        }

        .setting-option {
            flex: 1;
            padding: 16px 12px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .setting-option:hover {
            border-color: rgba(255, 255, 255, 0.15);
            background: rgba(255, 255, 255, 0.04);
        }

        .setting-option.active {
            border-color: var(--gold);
            background: rgba(240, 192, 64, 0.08);
            box-shadow: 0 0 20px rgba(240, 192, 64, 0.1);
        }

        .setting-option-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dim);
            transition: color 0.3s;
        }

        .setting-option.active .setting-option-value {
            color: var(--gold);
        }

        .mode-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .mode-option {
            padding: 22px 16px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .mode-option:hover {
            border-color: rgba(255, 255, 255, 0.15);
            background: rgba(255, 255, 255, 0.04);
        }

        .mode-option.active {
            border-color: var(--gold);
            background: rgba(240, 192, 64, 0.06);
            box-shadow: 0 0 25px rgba(240, 192, 64, 0.08);
        }

        .mode-icon {
            font-size: 1.4rem;
            margin-bottom: 10px;
        }

        .mode-name {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-dim);
            transition: color 0.3s;
        }

        .mode-option.active .mode-name {
            color: var(--gold);
        }

        .mode-desc {
            font-size: 0.6rem;
            color: var(--text-dim);
            margin-top: 6px;
            opacity: 0.6;
        }

        /* Dropdown style */
        .setting-dropdown {
            width: 100%;
            padding: 16px 18px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            color: var(--text);
            font-size: 0.85rem;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            transition: all 0.3s ease;
        }

        .setting-dropdown:hover {
            border-color: rgba(255, 255, 255, 0.15);
            background-color: rgba(255, 255, 255, 0.04);
        }

        .setting-dropdown:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(240, 192, 64, 0.1);
        }

        .setting-dropdown option {
            background: var(--bg-card);
            color: var(--text);
            padding: 12px;
        }

        /* ============================================
           CARTE JOUEUR 3D (hover leaderboard)
           ============================================ */
        .player-card-container {
            position: fixed;
            right: 40px;
            top: 50%;
            transform: translateY(-50%) translateX(60px);
            perspective: 1000px;
            z-index: 200;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.4s ease, transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .player-card-container.visible {
            opacity: 1;
            transform: translateY(-50%) translateX(0);
        }

        .player-card {
            width: 240px;
            background: linear-gradient(145deg,
                    rgba(30, 30, 35, 0.98) 0%,
                    rgba(20, 20, 25, 0.98) 100%);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 14px;
            padding: 18px;
            transform: rotateY(-15deg) rotateX(5deg);
            transform-style: preserve-3d;
            box-shadow:
                -20px 20px 60px rgba(0, 0, 0, 0.5),
                0 0 40px rgba(255, 215, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: cardFloat 3s ease-in-out infinite;
            position: relative;
            overflow: hidden;
        }

        .player-card-shine {
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.08),
                    transparent);
            animation: cardShine 4s ease-in-out infinite;
            pointer-events: none;
            border-radius: 14px;
        }

        @keyframes cardFloat {

            0%,
            100% {
                transform: rotateY(-15deg) rotateX(5deg) translateY(0);
            }

            50% {
                transform: rotateY(-15deg) rotateX(5deg) translateY(-8px);
            }
        }

        @keyframes cardShine {

            0%,
            100% {
                left: -100%;
            }

            50% {
                left: 150%;
            }
        }

        .player-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 14px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .player-card-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold) 0%, #b8860b 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
            overflow: hidden;
        }

        .player-card-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .player-card-identity {
            flex: 1;
        }

        .player-card-name {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 4px;
            max-width: 120px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-card-title {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 20px;
            background: rgba(255, 215, 0, 0.15);
            color: var(--gold);
        }

        .player-card-rank-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.6rem;
            font-weight: 700;
            letter-spacing: 0.5px;
            z-index: 10;
        }

        .player-card-rank-badge.top1 {
            background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
            color: #1a1a1a;
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.5);
        }

        .player-card-rank-badge.top2 {
            background: linear-gradient(135deg, #e8e8e8 0%, #b8b8b8 100%);
            color: #1a1a1a;
        }

        .player-card-rank-badge.top3 {
            background: linear-gradient(135deg, #cd9a5b 0%, #b87333 100%);
            color: #1a1a1a;
        }

        .player-card-rank-badge.top10 {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 170, 0, 0.15) 100%);
            color: var(--gold);
            border: 1px solid rgba(255, 215, 0, 0.4);
        }

        .player-card-rank-badge.top50 {
            background: rgba(255, 255, 255, 0.06);
            color: var(--text-dim);
            border: 1px solid rgba(255, 255, 255, 0.12);
        }

        .player-card-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 14px;
        }

        .player-card-stat {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }

        .player-card-stat-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 2px;
        }

        .player-card-stat-value.gold {
            color: var(--gold);
        }

        .player-card-stat-value.green {
            color: var(--green);
        }

        .player-card-stat-label {
            font-size: 0.6rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .player-card-winrate {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 14px;
        }

        .player-card-winrate-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }

        .player-card-winrate-label {
            font-size: 0.65rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .player-card-winrate-value {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--green);
        }

        .player-card-winrate-bar {
            height: 5px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }

        .player-card-winrate-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--green), #00ff88);
            border-radius: 3px;
            transition: width 0.6s ease;
        }

        .player-card-lastplace {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 8px 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .player-card-lastplace-label {
            font-size: 0.55rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .player-card-lastplace-value {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--gold);
        }

        .player-card-lastplace-value.top1 {
            color: #ffd700;
        }

        .player-card-lastplace-value.top3 {
            color: #c0c0c0;
        }

        .player-card-lastplace-value.normal {
            color: var(--text-dim);
        }

        /* Effet TOP 10 - Néon glow */
        .player-card.top10-card {
            border: 2px solid rgba(255, 215, 0, 0.8);
            box-shadow:
                -20px 20px 60px rgba(0, 0, 0, 0.5),
                0 0 15px rgba(255, 215, 0, 0.4),
                0 0 30px rgba(255, 215, 0, 0.2),
                0 0 45px rgba(255, 215, 0, 0.1),
                inset 0 0 20px rgba(255, 215, 0, 0.05);
            animation: cardFloat 3s ease-in-out infinite, neonPulse 2s ease-in-out infinite;
        }

        @keyframes neonPulse {

            0%,
            100% {
                box-shadow:
                    -20px 20px 60px rgba(0, 0, 0, 0.5),
                    0 0 15px rgba(255, 215, 0, 0.4),
                    0 0 30px rgba(255, 215, 0, 0.2),
                    0 0 45px rgba(255, 215, 0, 0.1),
                    inset 0 0 20px rgba(255, 215, 0, 0.05);
                border-color: rgba(255, 215, 0, 0.8);
            }

            50% {
                box-shadow:
                    -20px 20px 60px rgba(0, 0, 0, 0.5),
                    0 0 20px rgba(255, 215, 0, 0.6),
                    0 0 40px rgba(255, 215, 0, 0.3),
                    0 0 60px rgba(255, 215, 0, 0.15),
                    inset 0 0 25px rgba(255, 215, 0, 0.08);
                border-color: rgba(255, 215, 0, 1);
            }
        }

        /* Effet TOP 1 - Néon intense + reflets holographiques */
        .player-card.top1-card {
            border: 2px solid rgba(255, 215, 0, 1);
            box-shadow:
                -20px 20px 60px rgba(0, 0, 0, 0.5),
                0 0 20px rgba(255, 215, 0, 0.6),
                0 0 40px rgba(255, 215, 0, 0.4),
                0 0 60px rgba(255, 215, 0, 0.2),
                0 0 80px rgba(255, 215, 0, 0.1),
                inset 0 0 30px rgba(255, 215, 0, 0.1);
            animation: cardFloat 3s ease-in-out infinite, neonPulseTop1 1.5s ease-in-out infinite;
        }

        .player-card.top1-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 60%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent,
                    rgba(255, 255, 255, 0.15),
                    rgba(255, 215, 0, 0.1),
                    transparent);
            animation: holoShine 3s ease-in-out infinite;
            pointer-events: none;
            border-radius: 14px;
        }

        @keyframes neonPulseTop1 {

            0%,
            100% {
                box-shadow:
                    -20px 20px 60px rgba(0, 0, 0, 0.5),
                    0 0 20px rgba(255, 215, 0, 0.6),
                    0 0 40px rgba(255, 215, 0, 0.4),
                    0 0 60px rgba(255, 215, 0, 0.2),
                    0 0 80px rgba(255, 215, 0, 0.1),
                    inset 0 0 30px rgba(255, 215, 0, 0.1);
            }

            50% {
                box-shadow:
                    -20px 20px 60px rgba(0, 0, 0, 0.5),
                    0 0 25px rgba(255, 215, 0, 0.8),
                    0 0 50px rgba(255, 215, 0, 0.5),
                    0 0 75px rgba(255, 215, 0, 0.3),
                    0 0 100px rgba(255, 215, 0, 0.15),
                    inset 0 0 35px rgba(255, 215, 0, 0.15);
            }
        }

        @keyframes holoShine {
            0% {
                left: -100%;
            }

            50%,
            100% {
                left: 150%;
            }
        }

        /* Dropdown style */
        .setting-dropdown {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text);
            font-size: 0.85rem;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
        }

        .setting-dropdown:focus {
            outline: none;
            border-color: var(--gold);
        }

        .game-main-panel.collapsing {
            animation: panelCollapse 0.4s ease-in forwards;
        }

        @keyframes panelCollapse {
            0% {
                opacity: 1;
                transform: scale(1);
            }

            100% {
                opacity: 0;
                transform: scale(0.95) translateX(30px);
            }
        }

        /* Animation fermeture panel question - s'écrase vers la gauche */
        .game-question-wrapper.closing {
            animation: closeToLeft 0.15s cubic-bezier(0.4, 0, 1, 1) forwards;
        }

        @keyframes closeToLeft {
            0% {
                opacity: 1;
                transform: translateX(0) scaleX(1);
            }

            100% {
                opacity: 0;
                transform: translateX(-60px) scaleX(0.8);
            }
        }

        /* Animation fermeture panel droit - s'écrase vers la droite */
        .game-main-panel.closing {
            animation: closeToRight 0.15s cubic-bezier(0.4, 0, 1, 1) forwards;
        }

        @keyframes closeToRight {
            0% {
                opacity: 1;
                transform: translateX(0) scaleX(1);
            }

            100% {
                opacity: 0;
                transform: translateX(60px) scaleX(0.8);
            }
        }


        /* ========== MODAL SIGNALEMENT ========== */
        .report-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
            z-index: 600;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .report-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .report-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            width: 420px;
            background: linear-gradient(165deg, #151a22 0%, #0d1015 100%);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            z-index: 601;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .report-modal.active {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .report-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 28px 20px;
        }

        .report-modal-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
        }

        .report-modal-close {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.25s ease;
        }

        .report-modal-close svg {
            width: 18px;
            height: 18px;
            stroke: var(--text-dim);
            transition: all 0.25s ease;
        }

        .report-modal-close:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.15);
        }

        .report-modal-close:hover svg {
            stroke: var(--text);
        }

        .report-modal-content {
            padding: 0 28px 28px;
        }

        .report-question-display {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 10px;
            padding: 14px 18px;
            font-size: 0.85rem;
            color: var(--text-dim);
            margin-bottom: 24px;
            line-height: 1.5;
        }

        .report-field {
            margin-bottom: 24px;
        }

        .report-label {
            display: block;
            font-size: 0.65rem;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 10px;
        }

        .report-select-wrapper {
            position: relative;
        }

        .report-select {
            width: 100%;
            padding: 14px 18px;
            padding-right: 45px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(240, 192, 64, 0.4);
            border-radius: 10px;
            color: var(--text);
            font-size: 0.9rem;
            cursor: pointer;
            appearance: none;
            transition: all 0.25s ease;
        }

        .report-select:hover {
            border-color: rgba(240, 192, 64, 0.6);
            background: rgba(255, 255, 255, 0.05);
        }

        .report-select:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 20px rgba(240, 192, 64, 0.15);
        }

        .report-select option {
            background: #1a1f28;
            color: var(--text);
            padding: 12px;
        }

        .report-select-arrow {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            stroke: var(--gold);
            pointer-events: none;
        }

        .report-actions {
            display: flex;
            gap: 12px;
        }

        .report-btn {
            flex: 1;
            padding: 14px 20px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .report-btn.cancel {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-dim);
        }

        .report-btn.cancel:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.2);
            color: var(--text);
        }

        .report-btn.submit {
            background: linear-gradient(135deg, rgba(240, 192, 64, 0.2) 0%, rgba(240, 192, 64, 0.1) 100%);
            border: 1px solid rgba(240, 192, 64, 0.4);
            color: var(--gold);
        }

        .report-btn.submit:hover {
            background: linear-gradient(135deg, rgba(240, 192, 64, 0.3) 0%, rgba(240, 192, 64, 0.15) 100%);
            border-color: rgba(240, 192, 64, 0.6);
            box-shadow: 0 4px 20px rgba(240, 192, 64, 0.2);
        }




        /* Bouton Fermer en jeu - style comme lobby */
        .game-close-text-btn {
            position: absolute;
            top: -25px;
            right: 20px;
            padding: 0;
            background: transparent;
            border: none;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 50;
        }

        .game-close-text-btn.visible {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }

        .game-close-text-btn span {
            font-size: 0.6rem;
            /* Réduit de 0.65rem */
            font-weight: 500;
            color: var(--text-dim);
            opacity: 0.5;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
        }

        /* Barre au dessus - cachée par défaut */
        .game-close-text-btn::before {
            content: '';
            position: absolute;
            top: -4px;
            left: 50%;
            right: 50%;
            height: 1px;
            background: var(--gold);
            opacity: 0;
            transition: all 0.3s ease;
        }

        /* Hover - affiche la barre au dessus */
        .game-close-text-btn:hover span {
            color: var(--gold);
            opacity: 1;
            text-shadow: 0 0 20px rgba(240, 192, 64, 0.5);
        }

        .game-close-text-btn:hover::before {
            left: 0;
            right: 0;
            opacity: 0.6;
        }


        /* ============================================
        STATS PIE CHARTS - VERSION MINIMALISTE
        ============================================ */

        .stats-charts-container {
            display: flex;
            gap: 32px;
            justify-content: center;
            align-items: stretch;
            padding: 16px 0 10px;
            opacity: 0;
            transform: translateY(15px);
            animation: statsAppear 0.5s ease forwards;
            animation-delay: 0.1s;
        }

        @keyframes statsAppear {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Bloc chart - avec délimiteur sobre entre les blocs */
        .chart-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 200px;
            padding: 20px 28px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 14px;
            background: linear-gradient(165deg, rgba(255, 255, 255, 0.02) 0%, rgba(255, 255, 255, 0.005) 100%);
            opacity: 0;
            transform: translateY(10px);
            animation: blockAppear 0.4s ease forwards;
        }


        .chart-block:nth-child(1) {
            animation-delay: 0.15s;
        }

        .chart-block:nth-child(2) {
            animation-delay: 0.25s;
        }

        @keyframes blockAppear {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Titre du chart - léger */
        .chart-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 0.9rem;
            font-weight: 400;
            color: var(--text-dim, rgba(255, 255, 255, 0.5));
            text-align: center;
            margin-bottom: 16px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        /* Wrapper du pie */
        .chart-wrapper {
            display: flex;
            justify-content: center;
            margin-bottom: 18px;
        }

        /* Pie Chart - bordure en box-shadow pour éviter débordement */
        .pie-chart {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            position: relative;
            background: conic-gradient(var(--pie-color-1, #00ff88) 0deg var(--pie-angle-1, 0deg),
                    var(--pie-color-2, #ff3b5c) var(--pie-angle-1, 0deg) var(--pie-angle-2, 0deg),
                    var(--pie-color-3, #f0c040) var(--pie-angle-2, 0deg) 360deg);
            box-shadow:
                0 0 0 3px rgba(255, 255, 255, 0.08),
                0 4px 20px rgba(0, 0, 0, 0.4);

            /* Animation */
            transform: rotate(-90deg) scale(0);
            animation: pieReveal 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }

        .chart-block:nth-child(1) .pie-chart {
            animation-delay: 0.3s;
        }

        .chart-block:nth-child(2) .pie-chart {
            animation-delay: 0.4s;
        }

        @keyframes pieReveal {
            0% {
                transform: rotate(-90deg) scale(0);
            }

            60% {
                transform: rotate(-90deg) scale(1.05);
            }

            100% {
                transform: rotate(-90deg) scale(1);
            }
        }

        /* Légende - taille ajustée */
        .chart-legend {
            display: flex;
            flex-direction: column;
            gap: 5px;
            width: 100%;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 4px 0;
            opacity: 0;
            transform: translateX(-8px);
            animation: legendSlide 0.3s ease forwards;
        }

        .chart-block:nth-child(1) .legend-item:nth-child(1) {
            animation-delay: 0.45s;
        }

        .chart-block:nth-child(1) .legend-item:nth-child(2) {
            animation-delay: 0.5s;
        }

        .chart-block:nth-child(1) .legend-item:nth-child(3) {
            animation-delay: 0.55s;
        }

        .chart-block:nth-child(2) .legend-item:nth-child(1) {
            animation-delay: 0.55s;
        }

        .chart-block:nth-child(2) .legend-item:nth-child(2) {
            animation-delay: 0.6s;
        }

        .chart-block:nth-child(2) .legend-item:nth-child(3) {
            animation-delay: 0.65s;
        }

        .chart-block:nth-child(2) .legend-item:nth-child(4) {
            animation-delay: 0.7s;
        }

        @keyframes legendSlide {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Icône colorée */
        .legend-icon {
            font-size: 0.75rem;
            min-width: 32px;
            text-align: left;
            letter-spacing: -1px;
        }

        .legend-item.correct .legend-icon {
            color: var(--green, #00ff88);
        }

        .legend-item.wrong .legend-icon {
            color: var(--red, #ff3b5c);
        }

        .legend-item.timeout .legend-icon {
            color: var(--gold, #f0c040);
        }

        .legend-item.lives-3 .legend-icon {
            color: #00ff88;
        }

        .legend-item.lives-2 .legend-icon {
            color: #f0c040;
        }

        .legend-item.lives-1 .legend-icon {
            color: #ff9f43;
        }

        .legend-item.lives-0 .legend-icon {
            color: #6b7280;
        }

        .legend-text {
            font-size: 0.8rem;
            font-weight: 400;
            color: var(--text-dim, rgba(255, 255, 255, 0.6));
            flex: 1;
        }

        .legend-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1rem;
            font-weight: 400;
            color: var(--text-light, rgba(255, 255, 255, 0.9));
            min-width: 24px;
            text-align: right;
        }

        /* Plus rapide - centré en bas, plus discret */
        .fastest-player {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 0;
            margin-top: 12px;
            opacity: 0;
            animation: fadeIn 0.4s ease forwards;
            animation-delay: 0.8s;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        .fastest-label {
            font-size: 0.6rem;
            font-weight: 400;
            color: var(--text-dim, rgba(255, 255, 255, 0.35));
            letter-spacing: 0.5px;
        }

        .fastest-name {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--gold, #f0c040);
        }

        .fastest-time {
            font-family: 'Space Grotesk', sans-serif;
            /* au lieu de Bebas Neue */
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--green, #00ff88);
        }

        /* Mode Points : cacher le chart des vies */
        .stats-charts-container.mode-points #livesChartBlock {
            display: none;
        }

        .stats-charts-container.mode-points .chart-block {
            min-width: 260px;
            border-radius: 14px;
            border-right: 1px solid rgba(255, 255, 255, 0.06);
        }

        .stats-charts-container.mode-points .pie-chart {
            width: 150px;
            height: 150px;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .stats-charts-container {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }

            .chart-block {
                width: 90%;
                max-width: 280px;
            }
        }


        /* ============================================
   WINNER SCREEN
   ============================================ */

        /* Bouton Test */
        .test-winner-btn {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 12px 24px;
            background: rgba(240, 192, 64, 0.2);
            border: 1px solid rgba(240, 192, 64, 0.4);
            border-radius: 8px;
            color: var(--gold, #f0c040);
            font-weight: 600;
            font-size: 0.8rem;
            cursor: pointer;
            z-index: 2000;
            transition: all 0.3s;
        }

        .test-winner-btn:hover {
            background: rgba(240, 192, 64, 0.3);
            transform: scale(1.05);
        }

        /* Overlay */
        .winner-overlay {
            position: fixed;
            inset: 0;
            background: var(--bg, #08090d);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s ease;
        }

        .winner-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Particules dorées */
        .winner-particles {
            position: absolute;
            inset: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .w-particle {
            position: absolute;
            background: var(--gold, #f0c040);
            border-radius: 50%;
            pointer-events: none;
            visibility: hidden;
        }


        .w-particle.active {
            visibility: visible;
            animation: particleFloat 8s ease-out forwards;
        }

        /* Rayons lumineux */
        .winner-rays {
            position: absolute;
            top: 50%;
            left: 35%;
            transform: translate(-50%, -50%);
            width: 800px;
            height: 800px;
            pointer-events: none;
            opacity: 0;
            animation: raysRotate 60s linear infinite;
        }

        @keyframes raysRotate {
            from {
                transform: translate(-50%, -50%) rotate(0deg);
            }

            to {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        .winner-ray {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 2px;
            height: 400px;
            background: linear-gradient(to top, transparent 0%, rgba(240, 192, 64, 0.12) 50%, transparent 100%);
            transform-origin: bottom center;
        }

        /* Layout principal */
        .winner-layout {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 50px;
            z-index: 10;
            width: 100%;
            max-width: 1300px;
            padding: 0 40px;
            transition: all 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .winner-layout.with-grid {
            justify-content: center;
        }

        /* Container Vainqueur (gauche) */
        .winner-container {
            position: absolute;
            left: 50%;
            top: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.9);
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .winner-container.visible {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }

        .winner-container.shifted {
            left: 30%;
            transform: translate(-50%, -50%) scale(1);
        }

        /* Nom du gagnant */
        .winner-name {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 5.5rem;
            letter-spacing: 4px;
            background: linear-gradient(180deg, #ffd700 0%, #f0c040 50%, #c9a227 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .winner-name.visible {
            opacity: 1;
            transform: scale(1);
        }

        .winner-name::after {
            content: attr(data-name);
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, #ffd700 0%, #f0c040 50%, #c9a227 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: blur(25px);
            opacity: 0.6;
            z-index: -1;
        }

        /* Ligne décorative */
        .winner-line {
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--gold, #f0c040), transparent);
            margin: 12px 0 22px;
            transition: all 0.5s ease;
        }

        .winner-line.visible {
            width: 180px;
        }

        /* Stats du gagnant */
        .winner-stats {
            display: flex;
            gap: 45px;
            margin-bottom: 28px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .winner-stats.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .winner-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .winner-stat-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2rem;
            color: var(--text, #ffffff);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .winner-stat-value .heart {
            color: var(--red, #ff3b5c);
            font-size: 1.2rem;
        }

        .winner-stat-value.gold {
            color: var(--gold, #f0c040);
        }

        .winner-stat-label {
            font-size: 0.6rem;
            color: var(--text-dim, #6b7280);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* Infos de la partie */
        .winner-game-info {
            display: flex;
            gap: 35px;
            padding: 14px 28px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 10px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .winner-game-info.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .winner-info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 3px;
        }

        .winner-info-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text, #ffffff);
        }

        .winner-info-label {
            font-size: 0.55rem;
            color: var(--text-dim, #6b7280);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* ============================================
   GRILLE JOUEURS (droite)
   ============================================ */
        .winner-players-grid {
            position: absolute;
            right: 5%;
            top: 50%;
            transform: translateY(-50%) translateX(80px);
            width: 650px;
            max-height: 520px;
            opacity: 0;
            transition: all 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .winner-players-grid.visible {
            opacity: 1;
            transform: translateY(-50%) translateX(0);
        }

        .winner-grid-inner {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 16px;
            max-height: 520px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        /* Scrollbar stylée */
        .winner-grid-inner::-webkit-scrollbar {
            width: 4px;
        }

        .winner-grid-inner::-webkit-scrollbar-track {
            background: transparent;
        }

        .winner-grid-inner::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        /* Carte joueur - même style que la grille en partie */
        .winner-player-card {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: 12px;
            padding: 16px 12px 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: default;
            position: relative;
            min-height: 80px;
        }


        .winner-player-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 2px;
            background: var(--gold, #f0c040);
            border-radius: 0 0 2px 2px;
            opacity: 0.6;
            transition: all 0.3s;
        }


        .winner-player-card:hover::before {
            width: 60%;
            opacity: 1;
        }

        .winner-player-card:hover {
            background: rgba(255, 255, 255, 0.04);
            border-color: rgba(240, 192, 64, 0.3);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2), 0 0 30px rgba(240, 192, 64, 0.08);
        }

        /* Indicateur réponse (bordure + glow) */
        .winner-player-card.correct {
            border-color: rgba(0, 255, 136, 0.5);
        }

        .winner-player-card.correct::before {
            background: var(--green, #00ff88);
            width: 50%;
            opacity: 0.8;
        }

        .winner-player-card.wrong {
            border-color: rgba(255, 59, 92, 0.5);
        }


        .winner-player-card.wrong::before {
            background: var(--red, #ff3b5c);
            width: 50%;
            opacity: 0.8;
        }

        .winner-player-card.timeout {
            border-color: rgba(240, 192, 64, 0.4);
        }


        .winner-player-card.timeout::before {
            background: var(--gold, #f0c040);
            width: 40%;
            opacity: 0.6;
        }

        .winner-player-card.eliminated {
            opacity: 0.7;
        }

        .winner-player-card.eliminated:hover {
            opacity: 0.5;
        }

        /* Avatar - même style que le jeu */
        .winner-player-avatar {
            display: none;
        }

        .winner-player-card.correct .winner-player-avatar {
            background: linear-gradient(135deg, #00ff88 0%, #00cc6a 100%);
        }

        .winner-player-card.wrong .winner-player-avatar {
            background: linear-gradient(135deg, #ff3b5c 0%, #cc2f4a 100%);
        }

        .winner-player-card.timeout .winner-player-avatar {
            background: linear-gradient(135deg, #f0c040 0%, #d4a82a 100%);
        }

        .winner-player-card.eliminated .winner-player-avatar {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }

        /* Nom joueur */
        .winner-player-name {
            font-size: 0.75rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            padding: 0 5px;
            padding-bottom: 8px;
            /* AJOUTER */
            margin-bottom: 6px;
            /* AJOUTER */
            position: relative;
            /* AJOUTER */
            transition: color 0.3s;
        }


        .winner-player-name::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15), transparent);
        }

        /* Ligne colorée selon le statut */
        .winner-player-card.correct .winner-player-name::after {
            background: linear-gradient(90deg, transparent, rgba(0, 255, 136, 0.3), transparent);
        }

        .winner-player-card.wrong .winner-player-name::after {
            background: linear-gradient(90deg, transparent, rgba(255, 59, 92, 0.3), transparent);
        }

        .winner-player-card.winner .winner-player-name::after {
            background: linear-gradient(90deg, transparent, rgba(240, 192, 64, 0.4), transparent);
        }

        /* Vies */
        .winner-player-lives {
            font-size: 0.6rem;
            color: var(--red, #ff3b5c);
            letter-spacing: 2px;
            min-height: 14px;
        }

        /* Gagnant highlight */
        .winner-player-card.winner {
            background: rgba(240, 192, 64, 0.08);
            border-color: rgba(240, 192, 64, 0.6);
            box-shadow: 0 0 25px rgba(240, 192, 64, 0.2),
                inset 0 0 30px rgba(240, 192, 64, 0.08);
        }

        .winner-player-card.winner::before {
            background: linear-gradient(90deg, transparent, var(--gold, #f0c040), transparent);
            width: 80%;
            opacity: 1;
        }

        .winner-player-card.winner:hover {
            box-shadow: 0 0 35px rgba(240, 192, 64, 0.3),
                inset 0 0 30px rgba(240, 192, 64, 0.1);
        }

        .winner-player-card.winner .winner-player-avatar {
            background: linear-gradient(135deg, #ffd700 0%, #f0c040 50%, #d4a82a 100%);
            box-shadow: 0 4px 15px rgba(240, 192, 64, 0.4);
        }

        .winner-player-card.winner .winner-player-name {
            color: var(--gold, #f0c040);
        }

        /* ============================================
        BOUTON FERMER LOBBY
        ============================================ */
        .winner-close-lobby {
            margin-top: 35px;
            padding: 10px 24px;
            background: transparent;
            border: none;
            color: var(--text-dim, #6b7280);
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            z-index: 20;
            position: relative;
        }


        /* Barre jaune en dessous */
        .winner-close-lobby::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            right: 50%;
            height: 1px;
            background: var(--gold, #f0c040);
            transition: all 0.3s ease;
            opacity: 0;
        }

        .winner-close-lobby:hover::after {
            left: 0;
            right: 0;
            opacity: 0.8;
        }

        .winner-close-lobby.visible {
            opacity: 1;
        }

        .winner-close-lobby:hover {
            color: var(--gold, #f0c040);
            text-shadow: 0 0 20px rgba(240, 192, 64, 0.5);
        }

        /* Confettis */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0;
        }

        .confetti.square {
            border-radius: 2px;
        }

        .confetti.circle {
            border-radius: 50%;
        }

        .confetti.ribbon {
            width: 4px;
            height: 16px;
            border-radius: 2px;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(0) scale(1);
                opacity: 0.6;
            }

            /* ✅ Pas d'opacity forcée */
            100% {
                transform: translateY(-100vh) scale(0.2);
                opacity: 0;
            }
        }


        /* Animation sortie panel question - slide vers gauche */
        .game-question-wrapper.winner-exit {
            animation: panelLiftExit 0.5s cubic-bezier(0.4, 0, 1, 1) forwards;
        }

        @keyframes questionWinnerExit {
            0% {
                opacity: 1;
                transform: translateX(0) scale(1);
            }

            60% {
                opacity: 0.5;
                transform: translateX(-80px) scale(0.9);
            }

            100% {
                opacity: 0;
                transform: translateX(-150px) scale(0.8);
            }
        }

        /* Animation sortie panel droit - slide vers droite */
        .game-main-panel.winner-exit {
            animation: panelLiftExit 0.5s cubic-bezier(0.4, 0, 1, 1) forwards;
            animation-delay: 0.08s;
            /* Léger décalage */
        }

        @keyframes panelLiftExit {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateY(-60px) scale(0.95);
            }
        }

        /* Animation sortie boutons question */
        .question-actions.winner-exit {
            animation: actionsLiftExit 0.3s ease-out forwards;
        }

        @keyframes actionsLiftExit {
            0% {
                opacity: 1;
                transform: translateY(0);
            }

            100% {
                opacity: 0;
                transform: translateY(-30px);
            }
        }


        /* Médailles sur les 3 premiers */
        .winner-player-medal {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.2rem;
            z-index: 10;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.4));
        }

        /* Animation d'apparition des médailles */
        .winner-player-card.has-medal {
            margin-top: 14px;
        }

        .winner-player-medal.gold {
            filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.6));
        }

        .winner-player-medal.silver {
            filter: drop-shadow(0 0 6px rgba(192, 192, 192, 0.5));
        }

        .winner-player-medal.bronze {
            filter: drop-shadow(0 0 6px rgba(205, 127, 50, 0.5));
        }


        /* ============================================
   LOGS EN DIRECT - STYLE TIKTOK
   ============================================ */

        /* Container des logs - bas droite */
        .game-logs-container {
            position: fixed;
            bottom: 80px;
            right: 0;
            width: 280px;
            max-height: 300px;
            display: flex;
            flex-direction: column;
            padding-right: 10px;
            justify-content: flex-end;
            pointer-events: none;
            z-index: 100;
            overflow: hidden;
            mask-image: linear-gradient(to bottom, transparent 0%, black 20%, black 100%);
            -webkit-mask-image: linear-gradient(to bottom, transparent 0%, black 20%, black 100%);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .game-logs-container.hidden {
            opacity: 0;
            transform: translateY(20px);
        }

        /* Liste des logs */
        .game-logs-list {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 6px;
            padding: 10px;
        }

        /* Item de log */
        .game-log-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: rgba(0, 0, 0, 0.2);
            /* était 0.3 */
            backdrop-filter: blur(4px);
            border-radius: 20px;
            width: fit-content;
            max-width: 100%;
            opacity: 0;
            transform: translateX(30px);
            animation: logSlideIn 0.3s ease forwards;
        }

        @keyframes logSlideIn {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Animation de sortie (fade out après quelques secondes) */
        .game-log-item.fading {
            animation: logFadeOut 0.5s ease forwards;
        }

        @keyframes logFadeOut {
            to {
                opacity: 0;
                transform: translateX(-20px);
            }
        }

        /* Icône du log */
        .game-log-icon {
            display: none;
        }

        /* Texte du log */
        .game-log-text {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.55);
            /* était 0.7 */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .game-log-text .player-name {
            color: rgba(240, 192, 64, 0.7);
            /* était 0.85 */
            font-weight: 400;
        }

        /* Types de logs */
        .game-log-item.answered .game-log-icon {
            color: var(--green, #00ff88);
        }

        .game-log-item.bonus .game-log-icon {
            color: #a855f7;
        }

        .game-log-item.disconnected .game-log-icon {
            color: var(--red, #ff3b5c);
        }

        .game-log-item.reconnected .game-log-icon {
            color: var(--green, #00ff88);
        }

        /* Bonus spécifiques */
        .game-log-item.bonus .bonus-name {
            color: #a855f7;
            font-weight: 500;
        }

        /* ============================================
   BOUTON TOGGLE LOGS
   ============================================ */
        .game-logs-toggle {
            position: fixed;
            bottom: 20px;
            right: 15px;
            width: 38px;
            height: 38px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 101;
        }

        .game-logs-toggle svg {
            width: 16px;
            height: 16px;
            stroke: var(--text-dim, #6b7280);
            transition: all 0.3s ease;
            transform: scaleX(-1);
            /* AJOUTER - flip horizontal */
        }

        .game-logs-toggle:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.25);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
        }

        .game-logs-toggle:hover svg {
            stroke: var(--text, #ffffff);
        }

        /* État actif (logs visibles) */
        .game-logs-toggle.active {
            background: rgba(255, 255, 255, 0.08);
            /* était rgba(240, 192, 64, 0.15) */
            border-color: rgba(255, 255, 255, 0.15);
            /* était rgba(240, 192, 64, 0.4) */
        }

        .game-logs-toggle.active svg {
            stroke: var(--text, #ffffff);
            /* était var(--gold) */
        }



        /* Cacher dans le winner screen */
        .winner-overlay.active~.game-logs-container,
        .winner-overlay.active~.game-logs-toggle {
            opacity: 0;
            pointer-events: none;
        }

        /* Question card 6 réponses - plus large */
        .question-card.six-answers {
            min-width: 750px;
            min-height: 450px;
            padding: 30px 40px 35px;
        }

        /* Grille 6 réponses */
        .answers-grid.six-answers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            max-width: 100%;
            gap: 10px;
        }

        .answers-grid.six-answers .answer-option {
            min-width: unset;
            width: 100%;
            padding: 12px 18px;
            box-sizing: border-box;
        }

        .answers-grid.six-answers .answer-text {
            font-size: 0.75rem;
            margin-left: 10px;
            margin-right: 10px;
        }

        .answers-grid.six-answers .answer-percent {
            font-size: 0.7rem;
            margin-left: 8px;
        }


        /* ============================================
   TOP 10 - WINNER SCREEN
   ============================================ */
        .winner-top10 {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%) translateX(-100%);
            width: 180px;
            padding: 20px 15px 20px 20px;
            background: linear-gradient(90deg, rgba(0, 0, 0, 0.4) 0%, transparent 100%);
            border-right: 1px solid rgba(255, 255, 255, 0.04);
            opacity: 0;
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 5;
        }

        .winner-top10.visible {
            opacity: 1;
            transform: translateY(-50%) translateX(0);
        }

        .winner-top10-header {
            text-align: center;
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        }

        .winner-top10-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.65rem;
            font-weight: 600;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0.5;
        }

        .winner-top10-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .winner-top10-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 10px;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.02);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateX(-20px);
        }

        .winner-top10-item.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .winner-top10-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .winner-top10-rank {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 0.9rem;
            min-width: 18px;
            color: var(--text-dim);
            opacity: 0.4;
        }

        .winner-top10-item:nth-child(1) .winner-top10-rank {
            color: #ffd700;
            opacity: 1;
        }

        .winner-top10-item:nth-child(2) .winner-top10-rank {
            color: #c0c0c0;
            opacity: 0.9;
        }

        .winner-top10-item:nth-child(3) .winner-top10-rank {
            color: #cd7f32;
            opacity: 0.9;
        }

        .winner-top10-name {
            font-size: 0.7rem;
            font-weight: 500;
            color: var(--text);
            opacity: 0.7;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }

        .winner-top10-item:nth-child(1) .winner-top10-name {
            color: #ffd700;
            opacity: 1;
        }

        .winner-top10-item:nth-child(2) .winner-top10-name,
        .winner-top10-item:nth-child(3) .winner-top10-name {
            opacity: 0.85;
        }

        .winner-top10-wins {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 0.6rem;
            font-weight: 600;
            color: var(--gold);
            opacity: 0.5;
        }

        .winner-top10-item:nth-child(1) .winner-top10-wins {
            opacity: 0.9;
        }
    </style>
</head>

<body>
    <!-- Background -->
    <div class="bg-grid"></div>
    <div class="bg-text" id="bgText">MASTER</div>

    <!-- Header -->
    <header class="header">
        <div class="logo">
            <div class="logo-text">Shonen<span>Master</span></div>
        </div>
        <div class="header-right">
            <div class="status-pill">
                <div class="status-dot" id="statusDot"></div>
                <span id="statusText">Inactif</span>
            </div>
        </div>
    </header>

    <!-- Cercle d'absorption -->
    <div class="absorption-circle" id="absorptionCircle"></div>

    <!-- Main Container -->
    <main class="main-container">

        <!-- Panneau Récentes -->
        <div class="recent-games-panel" id="recentPanel">
            <div class="recent-games-header">
                <span class="recent-games-title">Récentes</span>
                <a href="#" class="recent-games-link" title="Voir toutes les parties">
                    <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                        <polyline points="15 3 21 3 21 9" />
                        <line x1="10" y1="14" x2="21" y2="3" />
                    </svg>
                </a>
            </div>
            <div class="recent-game-item">
                <div class="recent-game-header">
                    <span class="recent-game-date">Il y a 2h</span>
                    <span class="recent-game-players">47 joueurs</span>
                </div>
                <div class="recent-game-winner">🏆 Gojo_Satoru</div>
            </div>
            <div class="recent-game-item">
                <div class="recent-game-header">
                    <span class="recent-game-date">Il y a 5h</span>
                    <span class="recent-game-players">32 joueurs</span>
                </div>
                <div class="recent-game-winner">🏆 OnePieceKing</div>
            </div>
            <div class="recent-game-item">
                <div class="recent-game-header">
                    <span class="recent-game-date">Hier</span>
                    <span class="recent-game-players">89 joueurs</span>
                </div>
                <div class="recent-game-winner">🏆 LuffyD</div>
            </div>
            <div class="recent-game-item">
                <div class="recent-game-header">
                    <span class="recent-game-date">Hier</span>
                    <span class="recent-game-players">24 joueurs</span>
                </div>
                <div class="recent-game-winner">🏆 Mikasa</div>
            </div>
            <div class="recent-game-item">
                <div class="recent-game-header">
                    <span class="recent-game-date">Il y a 2j</span>
                    <span class="recent-game-players">56 joueurs</span>
                </div>
                <div class="recent-game-winner">🏆 Tanjiro</div>
            </div>
            <div class="recent-game-item">
                <div class="recent-game-header">
                    <span class="recent-game-date">Il y a 2j</span>
                    <span class="recent-game-players">41 joueurs</span>
                </div>
                <div class="recent-game-winner">🏆 AllMight</div>
            </div>
            <div class="recent-game-item">
                <div class="recent-game-header">
                    <span class="recent-game-date">Il y a 3j</span>
                    <span class="recent-game-players">63 joueurs</span>
                </div>
                <div class="recent-game-winner">🏆 Eren_Jaeger</div>
            </div>
        </div>

        <!-- ÉTAT IDLE -->
        <div class="state-idle" id="stateIdle">
            <div class="idle-main">
                <div class="btn-wrapper" id="btnWrapper">
                    <div class="particles-container">
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                    </div>
                    <img src="newkoko2.png" alt="" class="btn-character">
                    <div class="main-action-btn" id="openLobbyBtn">
                        <div class="btn-content">
                            <span class="btn-text">Jouer</span>
                        </div>
                    </div>
                </div>
                <div class="idle-stats">
                    <div class="idle-stat">
                        <div class="idle-stat-value">127</div>
                        <div class="idle-stat-label">Parties</div>
                    </div>
                    <div class="idle-stat">
                        <div class="idle-stat-value">2.4K</div>
                        <div class="idle-stat-label">Joueurs</div>
                    </div>
                    <div class="idle-stat">
                        <div class="idle-stat-value">+500</div>
                        <div class="idle-stat-label">Questions</div>
                    </div>
                </div>
            </div>

            <div class="lastgame-panel" id="lastgamePanel">
                <div class="leaderboard-filters">
                    <button class="filter-btn active" data-filter="all">Tous</button>
                    <button class="filter-btn" data-filter="top10">Top 10</button>
                </div>
                <div class="lastgame-scroll">
                    <div class="lastgame-list" id="lastgameList"></div>
                </div>
            </div>
        </div>

        <!-- ÉTAT LOBBY -->
        <div class="state-lobby" id="stateLobby">
            <div class="lobby-layout">
                <!-- Contenu principal -->
                <div class="lobby-content">
                    <!-- Paramètres gauche -->
                    <div class="lobby-settings-panel">
                        <div class="settings-panel-title">Paramètres</div>

                        <!-- Mode de jeu -->
                        <div class="setting-group mode-group">
                            <div class="setting-group-header">
                                <div class="setting-group-left">
                                    <svg class="setting-group-icon" viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <polygon points="12 2 22 8.5 22 15.5 12 22 2 15.5 2 8.5 12 2" />
                                    </svg>
                                    <span class="setting-group-label">Mode</span>
                                </div>
                                <span class="setting-group-value" id="modeValue">Vies</span>
                            </div>
                            <div class="setting-group-options">
                                <button class="setting-option-btn mode-btn active" data-mode="vie" data-value="Vies">
                                    <span class="mode-btn-icon"><svg viewBox="0 0 24 24" fill="currentColor" width="14"
                                            height="14">
                                            <path
                                                d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
                                        </svg></span>
                                    <span class="mode-btn-label">Vies</span>
                                </button>
                                <button class="setting-option-btn mode-btn" data-mode="point" data-value="Points">
                                    <span class="mode-btn-icon"><svg viewBox="0 0 24 24" fill="currentColor" width="14"
                                            height="14">
                                            <polygon
                                                points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" />
                                        </svg></span>
                                    <span class="mode-btn-label">Points</span>
                                </button>
                            </div>
                        </div>

                        <!-- Nombre de vies (visible en mode Vies) -->
                        <div class="setting-group lives-group" id="livesGroup">
                            <div class="setting-group-header">
                                <div class="setting-group-left">
                                    <svg class="setting-group-icon" viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <path
                                            d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
                                    </svg>
                                    <span class="setting-group-label">Vies</span>
                                </div>
                                <span class="setting-group-value" id="livesValue">3</span>
                            </div>
                            <div class="setting-group-options">
                                <button class="setting-option-btn" data-value="1">1</button>
                                <button class="setting-option-btn" data-value="2">2</button>
                                <button class="setting-option-btn active" data-value="3">3</button>
                            </div>
                        </div>

                        <!-- Questions (caché en mode Vies par défaut) -->
                        <div class="setting-group questions-group hidden" id="questionsGroup"
                            style="display: none; opacity: 0;">
                            <div class="setting-group-header">
                                <div class="setting-group-left">
                                    <svg class="setting-group-icon" viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <circle cx="12" cy="12" r="10" />
                                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                                        <line x1="12" y1="17" x2="12.01" y2="17" />
                                    </svg>
                                    <span class="setting-group-label">Questions</span>
                                </div>
                                <span class="setting-group-value" id="questionsValue">20</span>
                            </div>
                            <div class="setting-group-options questions-options">
                                <button class="setting-option-btn" data-value="15">15</button>
                                <button class="setting-option-btn active" data-value="20">20</button>
                                <button class="setting-option-btn" data-value="25">25</button>
                                <button class="setting-option-btn" data-value="30">30</button>
                                <button class="setting-option-btn" data-value="35">35</button>
                                <button class="setting-option-btn" data-value="40">40</button>
                                <button class="setting-option-btn" data-value="45">45</button>
                                <button class="setting-option-btn" data-value="50">50</button>
                            </div>
                        </div>


                        <!-- Timer - Slider -->
                        <div class="setting-group timer-group">
                            <div class="setting-group-header">
                                <div class="setting-group-left">
                                    <svg class="setting-group-icon" viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <circle cx="12" cy="12" r="10" />
                                        <polyline points="12 6 12 12 16 14" />
                                    </svg>
                                    <span class="setting-group-label">Timer</span>
                                </div>
                                <span class="setting-group-value" id="timerValue">10s</span>
                            </div>
                            <div class="setting-group-options timer-slider-container">
                                <input type="range" class="timer-slider" id="timerSlider" min="5" max="15" value="10">
                                <div class="timer-slider-labels">
                                    <span>5s</span>
                                    <span>15s</span>
                                </div>
                            </div>
                        </div>

                        <!-- Réponses -->
                        <div class="setting-group">
                            <div class="setting-group-header">
                                <div class="setting-group-left">
                                    <svg class="setting-group-icon" viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <rect x="3" y="3" width="7" height="7" />
                                        <rect x="14" y="3" width="7" height="7" />
                                        <rect x="14" y="14" width="7" height="7" />
                                        <rect x="3" y="14" width="7" height="7" />
                                    </svg>
                                    <span class="setting-group-label">Réponses</span>
                                </div>
                                <span class="setting-group-value" id="answersValue">4</span>
                            </div>
                            <div class="setting-group-options answers-options">
                                <button class="setting-option-btn active" data-value="4">4</button>
                                <button class="setting-option-btn" data-value="6">6</button>
                            </div>
                        </div>



                        <!-- Difficulté -->
                        <div class="setting-group">
                            <div class="setting-group-header">
                                <div class="setting-group-left">
                                    <svg class="setting-group-icon" viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <path
                                            d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" />
                                    </svg>
                                    <span class="setting-group-label">Difficulté</span>
                                </div>
                                <span class="setting-group-value" id="difficultyValue">Croissante</span>
                            </div>
                            <div class="setting-group-options difficulty-options">
                                <button class="setting-option-btn active" data-value="Croissante">Croissante</button>
                                <button class="setting-option-btn" data-value="Aléatoire">Aléatoire</button>
                            </div>
                        </div>

                        <!-- Série - Opens Modal -->
                        <div class="setting-group series-trigger" id="seriesTrigger">
                            <div class="setting-group-header">
                                <div class="setting-group-left">
                                    <svg class="setting-group-icon" viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2" />
                                        <line x1="8" y1="21" x2="16" y2="21" />
                                        <line x1="12" y1="17" x2="12" y2="21" />
                                    </svg>
                                    <span class="setting-group-label">Série</span>
                                </div>
                                <div class="series-value-container">
                                    <span class="setting-group-value" id="seriesValue">Overall</span>
                                    <svg class="series-arrow" viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <polyline points="9 18 15 12 9 6" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Grille joueurs centre -->
                    <div class="lobby-center">
                        <div class="lobby-grid-header">
                            <div class="lobby-header-left">
                                <span class="lobby-player-count-inline" id="lobbyPlayerCount">0</span>
                                <span class="lobby-status-text">joueurs en attente</span>
                            </div>
                            <div class="lobby-header-right">

                                <button class="header-text-btn refresh" id="refreshPlayersBtn">
                                    <span>Actualiser</span>
                                    <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                        <circle cx="8.5" cy="7" r="4" />
                                    </svg>
                                </button>

                                <button class="header-close-btn" id="closeLobbyBtn">
                                    <span>Fermer lobby</span>
                                </button>

                            </div>
                        </div>
                        <div class="players-grid-lobby" id="playersGridLobby"></div>
                    </div>

                    <!-- Actions droite - Gaming HUD -->
                    <div class="lobby-actions-full">
                        <button class="action-full-btn start disabled" id="startGameBtn">
                            <span class="action-hud-line top"></span>
                            <div class="action-full-content">
                                <span class="action-full-label">Démarrer</span>
                                <span class="action-full-sub">Lancer la partie</span>
                            </div>
                            <span class="action-hud-line bottom"></span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Bouton temporaire pour ajouter des joueurs (test) -->
            <button class="temp-add-player-btn" id="tempAddPlayerBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="8.5" cy="7" r="4" />
                    <line x1="20" y1="8" x2="20" y2="14" />
                    <line x1="23" y1="11" x2="17" y2="11" />
                </svg>
                <span>+ Joueur</span>
            </button>


        </div>

        <!-- ÉTAT GAME (En partie) -->
        <div class="state-game" id="stateGame">
            <div class="game-layout">
                <!-- Wrapper Question (panel + boutons) -->
                <div class="game-question-wrapper" id="gameQuestionWrapper">
                    <!-- Panel Question -->
                    <div class="game-question-panel" id="gameQuestionPanel">


                        <div class="panel-mini-actions">
                            <button class="mini-action-btn report" title="Signaler">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"></path>
                                    <line x1="4" y1="22" x2="4" y2="15"></line>
                                </svg>
                            </button>
                            <button class="mini-action-btn auto-toggle" id="autoToggleBtn" title="Auto/Manuel">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                                </svg>
                            </button>
                        </div>

                        <!-- Badge Question X sur le border-top -->
                        <span class="question-tab-badge" id="questionTabBadge">Question 1</span>

                        <!-- Timer circulaire -->
                        <div class="timer-container">
                            <svg class="timer-circle" viewBox="0 0 50 50">
                                <circle class="timer-circle-bg" cx="25" cy="25" r="22" />
                                <circle class="timer-circle-progress" id="timerProgress" cx="25" cy="25" r="22" />
                            </svg>
                            <span class="timer-text" id="timerText">10</span>
                        </div>

                        <!-- Badges série + difficulté -->
                        <div class="question-badges-row">
                            <span class="question-series-badge" id="questionSeries">NARUTO</span>
                            <span class="question-difficulty-badge" id="questionDifficulty">Facile</span>
                        </div>

                        <!-- Question -->
                        <p class="question-text" id="questionText">Dans quel village réside Naruto ?</p>

                        <!-- Réponses sans numéros -->
                        <div class="answers-grid" id="answersGrid">
                            <div class="answer-option" data-answer="0">
                                <span class="answer-text">Konoha</span>
                                <span class="answer-percent">0%</span>
                            </div>
                            <div class="answer-option" data-answer="1">
                                <span class="answer-text">Suna</span>
                                <span class="answer-percent">0%</span>
                            </div>
                            <div class="answer-option" data-answer="2">
                                <span class="answer-text">Kiri</span>
                                <span class="answer-percent">0%</span>
                            </div>
                            <div class="answer-option" data-answer="3">
                                <span class="answer-text">Oto</span>
                                <span class="answer-percent">0%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Boutons SOUS le panel -->
                    <div class="question-actions" id="questionActions">
                        <button class="question-action-btn next" id="nextQuestionBtn">
                            <span>Suivante</span>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                                <path d="M5 12h14M12 5l7 7-7 7" />
                            </svg>
                        </button>
                    </div>


                </div>

                <div class="game-logs-container" id="gameLogsContainer">
                    <div class="game-logs-list" id="gameLogsList">
                        <!-- Les logs apparaîtront ici -->
                    </div>
                </div>

                <!-- Bouton toggle logs - en bas à droite -->
                <button class="game-logs-toggle" id="gameLogsToggle" title="Afficher/Masquer les logs">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                </button>



                <!-- Panel Grille/Stats (DROITE) -->
                <div class="game-main-panel" id="gameMainPanel">

                    <button class="game-close-text-btn" id="gameCloseBtn">
                        <span>Fermer lobby</span>
                    </button>

                    <div class="panel-tabs">
                        <button class="panel-tab active" data-tab="stats">Stats</button>
                        <button class="panel-tab" data-tab="grille">Grille</button>
                    </div>
                    <div class="panel-content">


                        <!-- STRUCTURE HTML pour l'onglet Stats -->
                        <div class="panel-tab-content active" id="tabStats">
                            <div class="stats-charts-container">

                                <!-- PIE CHART 1 : Réponses -->
                                <div class="chart-block">
                                    <h3 class="chart-title">Réponses</h3>
                                    <div class="chart-wrapper">
                                        <div class="pie-chart" id="responsesPie"></div>
                                    </div>
                                    <div class="chart-legend" id="responsesLegend">
                                        <div class="legend-item correct">
                                            <span class="legend-icon">✓</span>
                                            <span class="legend-text">Bonne</span>
                                            <span class="legend-value" id="correctCount">0</span>
                                        </div>
                                        <div class="legend-item wrong">
                                            <span class="legend-icon">✗</span>
                                            <span class="legend-text">Mauvaise</span>
                                            <span class="legend-value" id="wrongCount">0</span>
                                        </div>
                                        <div class="legend-item timeout">
                                            <span class="legend-icon">⏱</span>
                                            <span class="legend-text">Pas répondu</span>
                                            <span class="legend-value" id="timeoutCount">0</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- PIE CHART 2 : Vies (seulement en mode Vie) -->
                                <div class="chart-block" id="livesChartBlock">
                                    <h3 class="chart-title">Vies</h3>
                                    <div class="chart-wrapper">
                                        <div class="pie-chart" id="livesPie"></div>
                                    </div>
                                    <div class="chart-legend" id="livesLegend">
                                        <div class="legend-item lives-3">
                                            <span class="legend-icon">❤❤❤</span>
                                            <span class="legend-text">3 vies</span>
                                            <span class="legend-value" id="lives3Count">0</span>
                                        </div>
                                        <div class="legend-item lives-2">
                                            <span class="legend-icon">❤❤</span>
                                            <span class="legend-text">2 vies</span>
                                            <span class="legend-value" id="lives2Count">0</span>
                                        </div>
                                        <div class="legend-item lives-1">
                                            <span class="legend-icon">❤</span>
                                            <span class="legend-text">1 vie</span>
                                            <span class="legend-value" id="lives1Count">0</span>
                                        </div>
                                        <div class="legend-item lives-0">
                                            <span class="legend-icon">💀</span>
                                            <span class="legend-text">Éliminé</span>
                                            <span class="legend-value" id="lives0Count">0</span>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <!-- Plus rapide - centré en bas -->
                            <div class="fastest-player" id="fastestPlayer">
                                <span class="fastest-label">Plus rapide:</span>
                                <span class="fastest-name" id="fastestName">-</span>
                                <span class="fastest-time" id="fastestTime">-</span>
                            </div>
                        </div>



                        <!-- Onglet Grille -->
                        <div class="panel-tab-content" id="tabGrille">
                            <div class="players-grid-game" id="playersGridGame">
                                <!-- Cartes joueurs générées dynamiquement -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>


        <!-- Overlay GAME START -->
        <div class="game-start-overlay" id="gameStartOverlay">
            <div class="game-start-text" id="gameStartText">LET'S GO</div>
        </div>
    </main>

    <!-- Modal Séries -->
    <div class="series-modal-overlay" id="seriesModalOverlay"></div>
    <div class="series-modal" id="seriesModal">
        <div class="series-modal-header">
            <button class="series-modal-close" id="seriesModalClose">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18" />
                    <line x1="6" y1="6" x2="18" y2="18" />
                </svg>
            </button>
        </div>

        <div class="series-search-container">
            <input type="text" class="series-search-input" id="seriesSearchInput" placeholder="Rechercher une série...">
        </div>

        <div class="series-grid" id="seriesGrid">
            <!-- Overall -->
            <div class="series-card active" data-series="overall" data-name="Overall">
                <img src="overall.jpg" alt="Overall" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <div class="series-card-check">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="3">
                        <polyline points="20 6 9 17 4 12" />
                    </svg>
                </div>
                <span class="series-card-name">Overall</span>
            </div>

            <!-- Mainstream -->
            <div class="series-card" data-series="mainstream" data-name="Mainstream">
                <img src="overall.jpg" alt="Mainstream" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <div class="series-card-check">
                    <svg viewBox="0 0 24 24" fill="none" stroke-width="3">
                        <polyline points="20 6 9 17 4 12" />
                    </svg>
                </div>
                <span class="series-card-name">Mainstream</span>
            </div>

            <!-- Big 3 -->
            <div class="series-card soon" data-series="big3" data-name="Big 3">
                <img src="overall.jpg" alt="Big 3" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Big 3</span>
            </div>

            <!-- One Piece -->
            <div class="series-card soon" data-series="onepiece" data-name="One Piece">
                <img src="overall.jpg" alt="One Piece" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">One Piece</span>
            </div>

            <!-- Naruto -->
            <div class="series-card soon" data-series="naruto" data-name="Naruto">
                <img src="overall.jpg" alt="Naruto" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Naruto</span>
            </div>

            <!-- Dragon Ball -->
            <div class="series-card soon" data-series="dragonball" data-name="Dragon Ball">
                <img src="overall.jpg" alt="Dragon Ball" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Dragon Ball</span>
            </div>

            <!-- Bleach -->
            <div class="series-card soon" data-series="bleach" data-name="Bleach">
                <img src="overall.jpg" alt="Bleach" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Bleach</span>
            </div>

            <!-- Demon Slayer -->
            <div class="series-card soon" data-series="demonslayer" data-name="Demon Slayer">
                <img src="overall.jpg" alt="Demon Slayer" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Demon Slayer</span>
            </div>

            <!-- Jujutsu Kaisen -->
            <div class="series-card soon" data-series="jjk" data-name="Jujutsu Kaisen">
                <img src="overall.jpg" alt="Jujutsu Kaisen" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Jujutsu Kaisen</span>
            </div>

            <!-- My Hero Academia -->
            <div class="series-card soon" data-series="mha" data-name="My Hero Academia">
                <img src="overall.jpg" alt="My Hero Academia" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">My Hero Academia</span>
            </div>

            <!-- Attack on Titan -->
            <div class="series-card soon" data-series="aot" data-name="Attack on Titan">
                <img src="overall.jpg" alt="Attack on Titan" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Attack on Titan</span>
            </div>

            <!-- Hunter x Hunter -->
            <div class="series-card soon" data-series="hxh" data-name="Hunter x Hunter">
                <img src="overall.jpg" alt="Hunter x Hunter" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Hunter x Hunter</span>
            </div>

            <!-- Fullmetal Alchemist -->
            <div class="series-card soon" data-series="fma" data-name="Fullmetal Alchemist">
                <img src="overall.jpg" alt="Fullmetal Alchemist" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Fullmetal Alchemist</span>
            </div>

            <!-- Death Note -->
            <div class="series-card soon" data-series="deathnote" data-name="Death Note">
                <img src="overall.jpg" alt="Death Note" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Death Note</span>
            </div>

            <!-- Tokyo Revengers -->
            <div class="series-card soon" data-series="tokyorev" data-name="Tokyo Revengers">
                <img src="overall.jpg" alt="Tokyo Revengers" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Tokyo Revengers</span>
            </div>

            <!-- Chainsaw Man -->
            <div class="series-card soon" data-series="csm" data-name="Chainsaw Man">
                <img src="overall.jpg" alt="Chainsaw Man" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Chainsaw Man</span>
            </div>

            <!-- Spy x Family -->
            <div class="series-card soon" data-series="spyxfamily" data-name="Spy x Family">
                <img src="overall.jpg" alt="Spy x Family" class="series-card-bg">
                <div class="series-card-overlay"></div>
                <span class="series-card-soon">SOON</span>
                <span class="series-card-name">Spy x Family</span>
            </div>
        </div>
    </div>

    <!-- Overlay Paramètres -->
    <!-- OLD SETTINGS OVERLAY - Commented out
    <div class="settings-overlay" id="settingsOverlay"></div>
    -->

    <!-- Carte Joueur 3D -->
    <div class="player-card-container" id="playerCard">
        <div class="player-card" id="playerCardInner">
            <div class="player-card-shine"></div>
            <div class="player-card-rank-badge" id="cardRankBadge">TOP 10</div>

            <div class="player-card-header">
                <div class="player-card-avatar">
                    <img src="cardpic.png" alt="">
                </div>
                <div class="player-card-identity">
                    <div class="player-card-name" id="cardName">Gojo_Satoru</div>
                    <div class="player-card-title" id="cardTitle">Novice</div>
                </div>
            </div>
            <div class="player-card-stats">
                <div class="player-card-stat">
                    <div class="player-card-stat-value gold" id="cardWins">24</div>
                    <div class="player-card-stat-label">Victoires</div>
                </div>
                <div class="player-card-stat">
                    <div class="player-card-stat-value" id="cardGames">31</div>
                    <div class="player-card-stat-label">Parties</div>
                </div>
                <div class="player-card-stat">
                    <div class="player-card-stat-value green" id="cardTitles">2</div>
                    <div class="player-card-stat-label">Titres</div>
                </div>
                <div class="player-card-stat">
                    <div class="player-card-stat-value" id="cardBadges">5</div>
                    <div class="player-card-stat-label">Badges</div>
                </div>
            </div>
            <div class="player-card-winrate">
                <div class="player-card-winrate-header">
                    <span class="player-card-winrate-label">Winrate</span>
                    <span class="player-card-winrate-value" id="cardWinrate">77%</span>
                </div>
                <div class="player-card-winrate-bar">
                    <div class="player-card-winrate-fill" id="cardWinrateFill" style="width: 77%"></div>
                </div>
            </div>
            <div class="player-card-lastplace">
                <span class="player-card-lastplace-label">Dernier placement</span>
                <span class="player-card-lastplace-value" id="cardLastPlace">1er</span>
            </div>
        </div>
    </div>


    <!-- Modal carte joueur -->
    <div class="player-modal-overlay" id="playerModalOverlay"></div>
    <div class="player-modal" id="playerModal">
        <button class="player-modal-close" id="playerModalClose">
            <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18" />
                <line x1="6" y1="6" x2="18" y2="18" />
            </svg>
        </button>

        <div class="player-modal-card">
            <div class="player-modal-avatar">
                <img src="cardpic.png" alt="">
            </div>

            <div class="player-modal-name" id="playerModalName">PlayerName</div>
            <div class="player-modal-badge" id="playerModalBadge"></div>
            <div class="player-modal-title" id="playerModalTitle"></div>

            <div class="player-modal-stats">
                <div class="player-modal-stat">
                    <span class="stat-value" id="statGames">42</span>
                    <span class="stat-label">Parties</span>
                </div>
                <div class="player-modal-stat">
                    <span class="stat-value" id="statWins">12</span>
                    <span class="stat-label">Victoires</span>
                </div>
                <div class="player-modal-stat">
                    <span class="stat-value" id="statWinrate">28%</span>
                    <span class="stat-label">Winrate</span>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal Signalement -->
    <div class="report-modal-overlay" id="reportModalOverlay"></div>
    <div class="report-modal" id="reportModal">
        <div class="report-modal-header">
            <h3 class="report-modal-title">Signaler une erreur</h3>
            <button class="report-modal-close" id="reportModalClose">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="report-modal-content">
            <!-- Question affichée -->
            <div class="report-question-display" id="reportQuestionText">
                Dans quel village réside Naruto ?
            </div>

            <!-- Motif -->
            <div class="report-field">
                <label class="report-label">Motif du signalement</label>
                <div class="report-select-wrapper">
                    <select class="report-select" id="reportReason">
                        <option value="difficulty-up">Augmenter la difficulté</option>
                        <option value="difficulty-down">Baisser la difficulté</option>
                        <option value="correct">Corriger la question / réponses</option>
                        <option value="wrong-answer">Changer la bonne réponse</option>
                        <option value="reformulate">Reformuler la question</option>
                        <option value="duplicate">Enlever doublon</option>
                        <option value="other">Autre</option>
                    </select>
                    <svg class="report-select-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
            </div>

            <!-- Actions -->
            <div class="report-actions">
                <button class="report-btn cancel" id="reportCancelBtn">Annuler</button>
                <button class="report-btn submit" id="reportSubmitBtn">Signaler</button>
            </div>
        </div>





    </div>


    <!-- ============================================
                        WINNER SCREEN OVERLAY
                        ============================================ -->
    <div class="winner-overlay" id="winnerOverlay">
        <!-- Rayons lumineux -->
        <div class="winner-rays" id="winnerRays"></div>

        <!-- Particules -->
        <div class="winner-particles" id="winnerParticles"></div>

        <!-- Layout principal : Vainqueur à gauche, Grille à droite -->
        <div class="winner-layout">

            <!-- Colonne Vainqueur -->
            <div class="winner-container" id="winnerContainer">
                <!-- Nom du gagnant -->
                <div class="winner-name" id="winnerName" data-name="">-</div>

                <!-- Ligne décorative -->
                <div class="winner-line" id="winnerLine"></div>

                <!-- Stats -->
                <div class="winner-stats" id="winnerStats">
                    <div class="winner-stat">
                        <div class="winner-stat-value" id="winnerLives"><span class="heart">❤</span>
                            1</div>
                        <div class="winner-stat-label">Vies restantes</div>
                    </div>
                    <div class="winner-stat">
                        <div class="winner-stat-value gold" id="winnerTotalWins">0</div>
                        <div class="winner-stat-label">Victoires totales</div>
                    </div>
                </div>

                <!-- Infos partie -->
                <div class="winner-game-info" id="winnerGameInfo">
                    <div class="winner-info-item">
                        <div class="winner-info-value" id="infoQuestions">0</div>
                        <div class="winner-info-label">Questions</div>
                    </div>
                    <div class="winner-info-item">
                        <div class="winner-info-value" id="infoDuration">0s</div>
                        <div class="winner-info-label">Durée</div>
                    </div>
                    <div class="winner-info-item">
                        <div class="winner-info-value" id="infoPlayers">0</div>
                        <div class="winner-info-label">Joueurs</div>
                    </div>
                </div>

                <!-- Bouton Fermer Lobby -->
                <button class="winner-close-lobby" id="winnerCloseLobby" onclick="closeWinner()">
                    Fermer le lobby
                </button>
            </div>

            <!-- Colonne Grille Joueurs -->
            <div class="winner-players-grid" id="winnerPlayersGrid">
                <div class="winner-grid-inner" id="winnerGridInner">
                    <!-- Joueurs générés dynamiquement -->
                </div>
            </div>

        </div>


        <!-- Top 10 - Côté gauche -->
        <div class="winner-top10" id="winnerTop10">
            <div class="winner-top10-header">
                <span class="winner-top10-title">Top 10</span>
            </div>
            <div class="winner-top10-list" id="winnerTop10List">
                <!-- Généré dynamiquement -->
            </div>
        </div>


    </div>

    <!-- Bouton test winner -->
    <button class="test-winner-btn" onclick="testShowWinner()">
        Test Winner
    </button>

    <!-- OLD SETTINGS PANEL - Commented out, now using inline settings
    <div class="settings-panel" id="settingsPanelOLD">
    </div>
    -->

    <script>
        // ============================================
        // INITIALISATION
        // ============================================
        const mockPlayers = [
            'NarutoFan42', 'OnePieceKing', 'SasukeUchiha', 'LuffyD',
            'ZoroSensei', 'GohanSSJ', 'VegetaPrince', 'GokuMaster',
            'AllMight', 'Deku_Hero', 'Todoroki', 'Bakugo',
            'Tanjiro', 'Zenitsu', 'Inosuke', 'Nezuko',
            'Gojo_Satoru', 'Itadori', 'Megumi', 'Nobara',
            'Eren_Jaeger', 'Mikasa', 'Levi_Heichou', 'Armin',
            'Killua_Z', 'Gon_Freecss', 'Kurapika', 'Leorio',
            'Light_Y', 'Ryuk_Shinigami', 'Spike_Cow', 'EdwardElric',
            'Alphonse', 'Roy_Mustang', 'Saitama_OPM', 'Genos',
            'Mob_100', 'Reigen', 'Shinji_Eva', 'Asuka',
            'Rei_Ayanami', 'Ichigo_Ban', 'Rukia'
        ];


        let filteredQuestions = [];


        const allDbPlayers = [
            { name: 'Gojo_Satoru', rank: 1 },
            { name: 'OnePieceKing', rank: 2 },
            { name: 'LuffyD', rank: 3 },
            { name: 'Levi_Heichou', rank: 4 },
            { name: 'NarutoFan42', rank: 5 },
            { name: 'AllMight', rank: 6 },
            { name: 'Tanjiro', rank: 7 },
            { name: 'VegetaPrince', rank: 8 },
            { name: 'Deku_Hero', rank: 9 },
            { name: 'Mikasa', rank: 10 },
            { name: 'Eren_Jaeger', rank: 11 },
            { name: 'Bakugo', rank: 12 },
            { name: 'Todoroki', rank: 15 },
            { name: 'Zenitsu', rank: 18 },
            { name: 'Nezuko_Chan', rank: 22 },
            { name: 'Itachi_Uchiha', rank: 25 },
            { name: 'Sasuke', rank: 28 },
            { name: 'Kakashi_Sensei', rank: 31 },
            { name: 'Zoro_3Swords', rank: 35 },
            { name: 'Sanji_Cook', rank: 38 },
            { name: 'Nami_Swan', rank: 42 },
            { name: 'Killua_Zoldyck', rank: 45 },
            { name: 'Gon_Freecss', rank: 48 }
        ];

        // ============================================
        // ANIMATION BOUTON AU CHARGEMENT
        // ============================================
        anime({
            targets: '.main-action-btn',
            scale: [0, 1],
            opacity: [0, 1],
            duration: 650,
            easing: 'easeOutBack',
            delay: 300,
            complete: () => {
                document.getElementById('btnWrapper').classList.add('pulse-active');
            }
        });

        // Personnage surgit de derrière le bouton
        // Bouton: delay 300ms + duration 650ms = 950ms pour apparaître
        // Personnage: 950ms + 500ms = 1450ms
        const btnCharacter = document.querySelector('.btn-character');
        btnCharacter.style.opacity = '0';
        btnCharacter.style.zIndex = '0';
        btnCharacter.style.visibility = 'hidden';

        setTimeout(() => {
            btnCharacter.style.visibility = 'visible';

            anime({
                targets: '.btn-character',
                opacity: [0, 0.95],
                translateY: [50, 0],
                scale: [0.85, 1],
                duration: 550,
                easing: 'easeOutCubic',
                complete: () => {
                    // Les mains passent devant à la fin
                    btnCharacter.style.zIndex = '10';
                    btnCharacter.classList.add('visible');
                }
            });
        }, 1450);

        anime({
            targets: '.idle-stats',
            opacity: [0, 1],
            translateY: [30, 0],
            duration: 600,
            easing: 'easeOutCubic',
            delay: 500
        });

        anime({
            targets: '.recent-games-panel',
            opacity: [0, 1],
            translateX: [-40, 0],
            duration: 600,
            easing: 'easeOutCubic',
            delay: 400
        });

        anime({
            targets: '.recent-game-item',
            opacity: [0, 1],
            translateX: [-20, 0],
            delay: anime.stagger(80, { start: 600 }),
            duration: 400,
            easing: 'easeOutCubic'
        });

        anime({
            targets: '.lastgame-panel',
            opacity: [0, 1],
            translateX: [40, 0],
            duration: 600,
            easing: 'easeOutCubic',
            delay: 400
        });

        anime({
            targets: '.lastgame-item',
            opacity: [0, 1],
            translateX: [20, 0],
            delay: anime.stagger(50, { start: 600 }),
            duration: 400,
            easing: 'easeOutCubic'
        });

        // Particules
        const particles = document.querySelectorAll('.particle');
        let isHovering = false;
        let hoverTransition = 0;
        let time = 0;
        let movementFadeIn = 0;

        anime({
            targets: '.particle',
            opacity: [0, 0.6],
            scale: [0, 1],
            delay: anime.stagger(100, { start: 1200 }),
            duration: 600,
            easing: 'easeOutCubic',
            complete: startContinuousAnimation
        });

        function startContinuousAnimation() {
            function animate() {
                time += 0.016;
                if (movementFadeIn < 1) movementFadeIn += 0.02;

                const targetTransition = isHovering ? 1 : 0;
                hoverTransition += (targetTransition - hoverTransition) * 0.08;

                const radius = 130;
                const orbitSpeed = 0.8;

                particles.forEach((particle, i) => {
                    const floatX = Math.sin(time * 0.5 + i * 0.8) * 12 * movementFadeIn;
                    const floatY = Math.cos(time * 0.4 + i * 1.2) * 10 * movementFadeIn;
                    const floatScale = 1 + Math.sin(time * 0.3 + i) * 0.1 * movementFadeIn;
                    const floatOpacity = 0.6 + Math.sin(time * 0.25 + i * 0.5) * 0.1 * movementFadeIn;

                    const angle = (i / particles.length) * Math.PI * 2 + time * orbitSpeed;
                    const orbitX = Math.cos(angle) * radius;
                    const orbitY = Math.sin(angle) * radius;
                    const orbitScale = 0.8;
                    const orbitOpacity = 0.55;

                    const x = floatX + (orbitX - floatX) * hoverTransition;
                    const y = floatY + (orbitY - floatY) * hoverTransition;
                    const scale = floatScale + (orbitScale - floatScale) * hoverTransition;
                    const opacity = floatOpacity + (orbitOpacity - floatOpacity) * hoverTransition;

                    particle.style.transform = `translate(${x}px, ${y}px) scale(${scale})`;
                    particle.style.opacity = opacity;
                });

                requestAnimationFrame(animate);
            }
            animate();
        }

        const btnWrapper = document.querySelector('.btn-wrapper');
        btnWrapper.addEventListener('mouseenter', () => isHovering = true);
        btnWrapper.addEventListener('mouseleave', () => isHovering = false);

        // ============================================
        // LEADERBOARD
        // ============================================
        function getRankClass(rank) {
            if (rank === 1) return 'top1';
            if (rank === 2) return 'top2';
            if (rank === 3) return 'top3';
            if (rank <= 10) return 'top10';
            return '';
        }

        function getRankBadgeNumber(rank) {
            if (rank <= 3) return rank;
            if (rank <= 10) return '10';
            if (rank <= 50) return '50';
            return '';
        }

        function populateLastGame() {
            const list = document.getElementById('lastgameList');
            list.innerHTML = '';
            const allPlayers = [...allDbPlayers, ...allDbPlayers];

            allPlayers.forEach(player => {
                const item = document.createElement('div');
                item.className = `lastgame-item ${getRankClass(player.rank)}`;
                item.dataset.playerRank = player.rank;
                item.dataset.playerName = player.name;

                const badgeNumber = getRankBadgeNumber(player.rank);
                const badgeHtml = badgeNumber ? `<span class="lastgame-rank-badge">${badgeNumber}</span>` : '';

                item.innerHTML = `<div class="lastgame-name">${player.name}${badgeHtml}</div>`;
                list.appendChild(item);
            });
        }

        populateLastGame();

        // Filtres avec animations
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                const filter = btn.dataset.filter;
                const items = document.querySelectorAll('.lastgame-item');

                items.forEach((item, index) => {
                    const rank = parseInt(item.dataset.playerRank);
                    const shouldShow = filter === 'all' || rank <= 10;

                    if (shouldShow) {
                        item.style.display = 'flex';
                        anime({
                            targets: item,
                            opacity: [0, 1],
                            translateX: [20, 0],
                            duration: 300,
                            delay: index * 20,
                            easing: 'easeOutCubic'
                        });
                    } else {
                        anime({
                            targets: item,
                            opacity: [1, 0],
                            translateX: [0, -20],
                            duration: 200,
                            easing: 'easeOutCubic',
                            complete: () => {
                                item.style.display = 'none';
                            }
                        });
                    }
                });
            });
        });

        // ============================================
        // CARTE JOUEUR 3D AU HOVER
        // ============================================
        const playerCard = document.getElementById('playerCard');
        const playerCardInner = document.getElementById('playerCardInner');
        const cardRankBadge = document.getElementById('cardRankBadge');
        let hideCardTimeout;

        // Données fictives des joueurs
        const playerData = {
            'Gojo_Satoru': { wins: 24, games: 31, titles: 3, badges: 7, title: 'Maître', lastPlace: 1 },
            'OnePieceKing': { wins: 19, games: 28, titles: 2, badges: 5, title: 'Expert', lastPlace: 2 },
            'LuffyD': { wins: 22, games: 35, titles: 2, badges: 6, title: 'Expert', lastPlace: 1 },
            'Levi_Heichou': { wins: 20, games: 29, titles: 2, badges: 5, title: 'Expert', lastPlace: 3 },
            'NarutoFan42': { wins: 17, games: 26, titles: 1, badges: 4, title: 'Avancé', lastPlace: 4 },
            'AllMight': { wins: 16, games: 24, titles: 1, badges: 4, title: 'Avancé', lastPlace: 5 },
            'Tanjiro': { wins: 15, games: 22, titles: 1, badges: 4, title: 'Avancé', lastPlace: 5 },
            'VegetaPrince': { wins: 14, games: 23, titles: 1, badges: 3, title: 'Avancé', lastPlace: 6 },
            'Deku_Hero': { wins: 13, games: 21, titles: 1, badges: 3, title: 'Avancé', lastPlace: 7 },
            'Mikasa': { wins: 18, games: 25, titles: 1, badges: 4, title: 'Avancé', lastPlace: 3 },
            'Eren_Jaeger': { wins: 12, games: 20, titles: 1, badges: 3, title: 'Avancé', lastPlace: 8 },
            'Bakugo': { wins: 11, games: 19, titles: 0, badges: 2, title: 'Intermédiaire', lastPlace: 10 },
            'Todoroki': { wins: 10, games: 18, titles: 0, badges: 2, title: 'Intermédiaire', lastPlace: 12 },
            'Zenitsu': { wins: 8, games: 16, titles: 0, badges: 2, title: 'Novice', lastPlace: 15 },
            'default': { wins: 5, games: 12, titles: 0, badges: 1, title: 'Novice', lastPlace: 20 }
        };

        function getRankBadgeClass(rank) {
            if (rank === 1) return 'top1';
            if (rank === 2) return 'top2';
            if (rank === 3) return 'top3';
            if (rank <= 10) return 'top10';
            if (rank <= 50) return 'top50';
            return '';
        }

        function getRankBadgeText(rank) {
            if (rank <= 3) return 'TOP ' + rank;
            if (rank <= 10) return 'TOP 10';
            if (rank <= 50) return 'TOP 50';
            return '';
        }

        function getPlaceClass(place) {
            if (place === 1) return 'top1';
            if (place <= 3) return 'top3';
            return 'normal';
        }

        function setupPlayerCardEvents() {
            const items = document.querySelectorAll('.lastgame-item');

            items.forEach(item => {
                item.addEventListener('mouseenter', () => {
                    clearTimeout(hideCardTimeout);

                    const name = item.dataset.playerName;
                    const rank = parseInt(item.dataset.playerRank);
                    const data = playerData[name] || playerData['default'];

                    // Mettre à jour la carte
                    const cardNameEl = document.getElementById('cardName');
                    cardNameEl.textContent = name;

                    // Adapter la taille selon la longueur du pseudo
                    if (name.length > 14) {
                        cardNameEl.style.fontSize = '0.7rem';
                    } else if (name.length > 10) {
                        cardNameEl.style.fontSize = '0.8rem';
                    } else {
                        cardNameEl.style.fontSize = '0.85rem';
                    }

                    document.getElementById('cardTitle').textContent = data.title;
                    document.getElementById('cardWins').textContent = data.wins;
                    document.getElementById('cardGames').textContent = data.games;
                    document.getElementById('cardTitles').textContent = data.titles;
                    document.getElementById('cardBadges').textContent = data.badges;

                    const winrate = Math.round((data.wins / data.games) * 100);
                    document.getElementById('cardWinrate').textContent = winrate + '%';
                    document.getElementById('cardWinrateFill').style.width = winrate + '%';

                    // Dernier placement
                    const lastPlaceEl = document.getElementById('cardLastPlace');
                    lastPlaceEl.textContent = data.lastPlace;
                    lastPlaceEl.className = 'player-card-lastplace-value ' + getPlaceClass(data.lastPlace);

                    // Badge de rang
                    const badgeClass = getRankBadgeClass(rank);
                    cardRankBadge.className = 'player-card-rank-badge ' + badgeClass;
                    cardRankBadge.textContent = getRankBadgeText(rank);
                    cardRankBadge.style.display = badgeClass ? 'flex' : 'none';

                    // Reset classes de la carte
                    playerCardInner.classList.remove('top1-card', 'top10-card');

                    // Effets spéciaux selon le rang
                    if (rank === 1) {
                        playerCardInner.classList.add('top1-card');
                    } else if (rank <= 10) {
                        playerCardInner.classList.add('top10-card');
                    }

                    // Afficher la carte
                    playerCard.classList.add('visible');
                });

                item.addEventListener('mouseleave', () => {
                    hideCardTimeout = setTimeout(() => {
                        playerCard.classList.remove('visible');
                    }, 150);
                });
            });
        }

        // Appeler après populateLastGame
        setupPlayerCardEvents();

        // ============================================
        // ANIMATION ABSORPTION - OUVERTURE LOBBY
        // ============================================
        const openLobbyBtn = document.getElementById('openLobbyBtn');
        const absorptionCircle = document.getElementById('absorptionCircle');
        const stateIdle = document.getElementById('stateIdle');
        const stateLobby = document.getElementById('stateLobby');
        const recentPanel = document.getElementById('recentPanel');
        const lastgamePanel = document.getElementById('lastgamePanel');
        const bgText = document.getElementById('bgText');
        const statusDot = document.getElementById('statusDot');
        const statusText = document.getElementById('statusText');

        openLobbyBtn.addEventListener('click', () => {
            // Position du bouton
            const btnRect = openLobbyBtn.getBoundingClientRect();
            const centerX = btnRect.left + btnRect.width / 2;
            const centerY = btnRect.top + btnRect.height / 2;

            // Calculer la taille nécessaire pour couvrir tout l'écran
            const maxDim = Math.max(
                Math.hypot(centerX, centerY),
                Math.hypot(window.innerWidth - centerX, centerY),
                Math.hypot(centerX, window.innerHeight - centerY),
                Math.hypot(window.innerWidth - centerX, window.innerHeight - centerY)
            ) * 2;

            // Cacher les panneaux latéraux
            recentPanel.classList.add('hidden');
            lastgamePanel.classList.add('hidden');

            // Désactiver le pulse
            btnWrapper.classList.remove('pulse-active');

            // Animation d'absorption
            absorptionCircle.style.left = centerX + 'px';
            absorptionCircle.style.top = centerY + 'px';
            absorptionCircle.style.opacity = '1';

            anime({
                targets: absorptionCircle,
                width: [185, maxDim],
                height: [185, maxDim],
                duration: 800,
                easing: 'easeInOutQuart',
                complete: () => {
                    // Cacher l'état idle
                    stateIdle.style.display = 'none';

                    // Afficher le lobby
                    stateLobby.classList.add('active');
                    bgText.textContent = 'LOBBY';
                    bgText.classList.add('lobby-active');
                    statusDot.classList.add('active');
                    statusText.textContent = 'Lobby ouvert';

                    // Populer les joueurs
                    populateLobbyPlayers();

                    // Fade out du cercle
                    anime({
                        targets: absorptionCircle,
                        opacity: [1, 0],
                        duration: 400,
                        easing: 'easeOutQuad',
                        complete: () => {
                            absorptionCircle.style.width = '0';
                            absorptionCircle.style.height = '0';
                        }
                    });

                    // Animation d'entrée du lobby
                    anime({
                        targets: stateLobby,
                        opacity: [0, 1],
                        duration: 500,
                        easing: 'easeOutQuad'
                    });

                    anime({
                        targets: '.lobby-stats',
                        opacity: [0, 1],
                        translateX: [-30, 0],
                        duration: 600,
                        delay: 200,
                        easing: 'easeOutCubic'
                    });

                    anime({
                        targets: '.lobby-actions-full',
                        opacity: [0, 1],
                        translateX: [30, 0],
                        duration: 600,
                        delay: 250,
                        easing: 'easeOutCubic'
                    });
                }
            });

            // Fade out des éléments idle
            anime({
                targets: ['.idle-main', '.idle-stats'],
                opacity: 0,
                duration: 300,
                easing: 'easeOutQuad'
            });
        });

        // ============================================
        // GRILLE JOUEURS LOBBY
        // ============================================
        function populateLobbyPlayers() {
            const grid = document.getElementById('playersGridLobby');
            const countEl = document.getElementById('lobbyPlayerCount');
            grid.innerHTML = '';

            // Démarrer avec 0 joueurs pour test
            const startWithPlayers = []; // mockPlayers pour avoir des joueurs

            startWithPlayers.forEach((player, i) => {
                const card = document.createElement('div');
                card.className = 'player-card-mini';

                // En lobby : pas de stats affichées
                // En jeu : on affichera les coeurs ou points ici
                card.innerHTML = `
                    <div class="player-card-mini-badge"></div>
                    <div class="player-card-mini-name">${player}</div>
                    <div class="player-card-mini-stats">
                        <!-- Vide en lobby, rempli en jeu -->
                    </div>
                `;
                card.style.opacity = '0';
                grid.appendChild(card);

                anime({
                    targets: card,
                    opacity: [0, 1],
                    translateY: [12, 0],
                    delay: 300 + i * 30,
                    duration: 350,
                    easing: 'easeOutCubic'
                });
            });

            // Animer le compteur
            countEl.textContent = '0';
        }

        // ============================================
        // FERMETURE LOBBY
        // ============================================
        document.getElementById('closeLobbyBtn').addEventListener('click', () => {
            // Animation de sortie
            anime({
                targets: stateLobby,
                opacity: [1, 0],
                duration: 400,
                easing: 'easeOutQuad',
                complete: () => {
                    stateLobby.classList.remove('active');
                    stateIdle.style.display = 'grid';

                    // Réafficher les panneaux
                    recentPanel.classList.remove('hidden');
                    lastgamePanel.classList.remove('hidden');

                    // Reset background
                    bgText.textContent = 'MASTER';
                    bgText.classList.remove('lobby-active');
                    statusDot.classList.remove('active');
                    statusText.textContent = 'Inactif';

                    // Réactiver le pulse
                    btnWrapper.classList.add('pulse-active');

                    // Animation de retour
                    anime({
                        targets: '.idle-main',
                        opacity: [0, 1],
                        translateY: [20, 0],
                        duration: 500,
                        easing: 'easeOutCubic'
                    });

                    anime({
                        targets: '.idle-stats',
                        opacity: [0, 1],
                        duration: 500,
                        delay: 100,
                        easing: 'easeOutCubic'
                    });
                }
            });
        });

        // ============================================
        // ============================================
        // PARAMÈTRES INLINE - Gestion des options
        // ============================================

        // Options génériques (vies, questions, timer, difficulté)
        document.querySelectorAll('.setting-group:not(.mode-group):not(.series-group) .setting-option-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const group = btn.closest('.setting-group');
                const valueDisplay = group.querySelector('.setting-group-value');

                // Retirer active des autres
                group.querySelectorAll('.setting-option-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                // Mettre à jour la valeur affichée
                valueDisplay.textContent = btn.dataset.value;

                // Animation
                anime({
                    targets: valueDisplay,
                    scale: [1.15, 1],
                    duration: 300,
                    easing: 'easeOutBack'
                });
            });
        });

        // Mode de jeu (Vies/Points)
        document.querySelectorAll('.mode-group .setting-option-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const group = btn.closest('.setting-group');
                const valueDisplay = document.getElementById('modeValue');
                const livesGroup = document.getElementById('livesGroup');
                const questionsGroup = document.getElementById('questionsGroup');

                group.querySelectorAll('.setting-option-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                valueDisplay.textContent = btn.dataset.value;

                // Mode Vies : afficher vies, cacher questions
                if (btn.dataset.mode === 'vie') {
                    // Afficher vies
                    livesGroup.style.display = 'block';
                    livesGroup.classList.remove('hidden');
                    anime({
                        targets: livesGroup,
                        opacity: [0, 1],
                        translateY: [-10, 0],
                        duration: 300,
                        easing: 'easeOutCubic'
                    });

                    // Cacher questions
                    anime({
                        targets: questionsGroup,
                        opacity: [1, 0],
                        translateY: [0, -10],
                        duration: 200,
                        easing: 'easeInCubic',
                        complete: () => {
                            questionsGroup.style.display = 'none';
                            questionsGroup.classList.add('hidden');
                        }
                    });
                }
                // Mode Points : cacher vies, afficher questions
                else {
                    // Cacher vies
                    anime({
                        targets: livesGroup,
                        opacity: [1, 0],
                        translateY: [0, -10],
                        duration: 200,
                        easing: 'easeInCubic',
                        complete: () => {
                            livesGroup.style.display = 'none';
                            livesGroup.classList.add('hidden');
                        }
                    });

                    // Afficher questions
                    questionsGroup.style.display = 'block';
                    questionsGroup.classList.remove('hidden');
                    anime({
                        targets: questionsGroup,
                        opacity: [0, 1],
                        translateY: [-10, 0],
                        duration: 300,
                        easing: 'easeOutCubic'
                    });
                }
            });
        });

        // Dropdown séries - REMOVED, now using modal

        // Timer slider
        document.getElementById('timerSlider').addEventListener('input', (e) => {
            const value = e.target.value;
            document.getElementById('timerValue').textContent = value + 's';
        });

        // ============================================
        // SERIES MODAL
        // ============================================
        const seriesTrigger = document.getElementById('seriesTrigger');
        const seriesModal = document.getElementById('seriesModal');
        const seriesModalOverlay = document.getElementById('seriesModalOverlay');
        const seriesModalClose = document.getElementById('seriesModalClose');
        const seriesSearchInput = document.getElementById('seriesSearchInput');
        const seriesCards = document.querySelectorAll('.series-card:not(.soon)');
        const allSeriesCards = document.querySelectorAll('.series-card');

        function openSeriesModal() {
            seriesModal.classList.add('active');
            seriesModalOverlay.classList.add('active');
            seriesSearchInput.focus();
        }

        function closeSeriesModal() {
            seriesModal.classList.remove('active');
            seriesModalOverlay.classList.remove('active');
            seriesSearchInput.value = '';
            filterSeries('');
        }

        seriesTrigger.addEventListener('click', openSeriesModal);
        seriesModalOverlay.addEventListener('click', closeSeriesModal);
        seriesModalClose.addEventListener('click', closeSeriesModal);

        // Series card selection
        seriesCards.forEach(card => {
            card.addEventListener('click', () => {
                // Remove active from all
                document.querySelectorAll('.series-card').forEach(c => c.classList.remove('active'));
                // Add active to clicked
                card.classList.add('active');

                // Update value display
                const seriesName = card.dataset.name;
                document.getElementById('seriesValue').textContent = seriesName;

                // Animate check
                anime({
                    targets: card.querySelector('.series-card-check'),
                    scale: [0.5, 1.2, 1],
                    duration: 400,
                    easing: 'easeOutBack'
                });

                // Close modal after short delay
                setTimeout(closeSeriesModal, 300);
            });
        });

        // Search filter
        function filterSeries(query) {
            const lowerQuery = query.toLowerCase();
            allSeriesCards.forEach(card => {
                const name = card.dataset.name.toLowerCase();
                if (name.includes(lowerQuery)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        seriesSearchInput.addEventListener('input', (e) => {
            filterSeries(e.target.value);
        });

        // Close on Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && seriesModal.classList.contains('active')) {
                closeSeriesModal();
            }
        });

        // ============================================
        // SIMULER NOUVEAU JOUEUR
        // ============================================
        const randomNames = [
            'Shinra_Fire', 'Arthur_Knight', 'Maki_Oze', 'Tamaki_Cat',
            'Asta_Clover', 'Yuno_Wind', 'Noelle_Silva', 'Luck_Voltia',
            'Senku_Stone', 'Chrome_Sci', 'Kohaku_Speed', 'Gen_Asagiri',
            'Denji_Chainsaw', 'Power_Blood', 'Aki_Hayakawa', 'Makima',
            'Yuji_Pink', 'Todo_Best', 'Maki_Zen', 'Panda_Senpai',
            'Shikamaru', 'Rock_Lee', 'Hinata_Hyuga', 'Gaara_Sand'
        ];

        let playerIndex = 0;
        let currentPlayerCount = 0;

        // ============================================
        // MODAL CARTE JOUEUR
        // ============================================
        const playerModalOverlay = document.getElementById('playerModalOverlay');
        const playerModal = document.getElementById('playerModal');
        const playerModalClose = document.getElementById('playerModalClose');

        function openPlayerModal(playerName, isChampion, playerTitle) {
            // Générer des stats aléatoires pour la démo
            const games = Math.floor(Math.random() * 100) + 10;
            const wins = Math.floor(Math.random() * games * 0.4);
            const winrate = Math.round((wins / games) * 100);

            // Remplir les données
            document.getElementById('playerModalName').textContent = playerName;

            if (isChampion) {
                document.getElementById('playerModalBadge').textContent = 'Dernier vainqueur';
                document.getElementById('playerModalTitle').textContent = playerTitle || '';
            } else {
                document.getElementById('playerModalBadge').textContent = playerTitle || '';
                document.getElementById('playerModalTitle').textContent = '';
            }

            document.getElementById('statGames').textContent = games;
            document.getElementById('statWins').textContent = wins;
            document.getElementById('statWinrate').textContent = winrate + '%';

            // Champion styling
            const modalCard = document.querySelector('.player-modal-card');
            if (isChampion) {
                modalCard.classList.add('champion');
            } else {
                modalCard.classList.remove('champion');
            }

            // Afficher la modal
            document.getElementById('playerModalOverlay').classList.add('active');
            document.getElementById('playerModal').classList.add('active');
        }

        function closePlayerModal() {
            playerModalOverlay.classList.remove('active');
            playerModal.classList.remove('active');
        }

        playerModalClose.addEventListener('click', closePlayerModal);
        playerModalOverlay.addEventListener('click', closePlayerModal);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && playerModal.classList.contains('active')) {
                closePlayerModal();
            }
        });


        // Bouton temporaire pour ajouter des joueurs
        const playerTitles = [
            'Novice', 'Apprenti', 'Otaku', 'Connaisseur', 'Expert',
            'Maître', 'Légende', 'Weeb', 'Senpai', 'Sensei'
        ];

        document.getElementById('tempAddPlayerBtn').addEventListener('click', () => {
            const grid = document.getElementById('playersGridLobby');
            const countEl = document.getElementById('lobbyPlayerCount');
            const startBtn = document.getElementById('startGameBtn');

            // Générer un nouveau nom et titre
            const newName = randomNames[playerIndex % randomNames.length] + '_' + Math.floor(Math.random() * 99);
            const playerTitle = playerTitles[Math.floor(Math.random() * playerTitles.length)];
            playerIndex++;
            currentPlayerCount++;

            // Créer la nouvelle carte
            const card = document.createElement('div');
            // Premier joueur = champion (demo)
            const isChampion = currentPlayerCount === 1;
            card.className = 'player-card-mini' + (isChampion ? ' champion' : '');
            card.innerHTML = `
                <div class="player-card-mini-badge"></div>
                <div class="player-card-mini-name">${newName}</div>
                <div class="player-card-mini-title">${playerTitle}</div>
                <div class="player-card-mini-stats"></div>
            `;

            // Ajouter le click pour ouvrir la modal
            card.style.cursor = 'pointer';
            card.addEventListener('click', () => {
                openPlayerModal(newName, isChampion, playerTitle);
            });

            // Style initial pour l'animation
            card.style.opacity = '0';
            card.style.transform = 'scale(0.3) translateY(-20px)';

            // Ajouter au début de la grille
            grid.insertBefore(card, grid.firstChild);

            // Animation de la carte (pop + glow)
            anime({
                targets: card,
                opacity: [0, 1],
                scale: [0.3, 1.08, 1],
                translateY: [-20, 0],
                duration: 500,
                easing: 'easeOutBack',
                complete: () => {
                    // Flash doré sur la carte
                    anime({
                        targets: card,
                        boxShadow: [
                            '0 0 0 rgba(240, 192, 64, 0)',
                            '0 0 30px rgba(240, 192, 64, 0.4)',
                            '0 0 0 rgba(240, 192, 64, 0)'
                        ],
                        duration: 600,
                        easing: 'easeOutQuad'
                    });
                }
            });

            // Animation de la bordure dorée
            anime({
                targets: card,
                borderColor: [
                    'rgba(240, 192, 64, 0.6)',
                    'rgba(255, 255, 255, 0.06)'
                ],
                duration: 800,
                delay: 400,
                easing: 'easeOutQuad'
            });

            // Animation du compteur
            countEl.textContent = currentPlayerCount;
            countEl.classList.add('bump');
            setTimeout(() => countEl.classList.remove('bump'), 500);

            // Activer le bouton démarrer si c'est le premier joueur
            if (currentPlayerCount === 1 && startBtn.classList.contains('disabled')) {
                startBtn.classList.remove('disabled');
                startBtn.classList.add('just-activated');

                // Retirer la classe d'animation après
                setTimeout(() => {
                    startBtn.classList.remove('just-activated');
                }, 800);
            }

            // Scroll vers le haut pour voir la nouvelle carte
            grid.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // ============================================
        // ÉTAT GAME - SYSTÈME COMPLET
        // ============================================
        let gameStarted = false;
        let currentQuestion = 0;
        let timerInterval = null;
        let timerValue = 10;
        let gameSettings = {
            mode: 'vie',
            lives: 3,
            timer: 10,
            totalQuestions: 20
        };

        // Questions de démo (incluant des questions/réponses longues pour test)
        const demoQuestions = [
            // Questions 4 réponses
            { series: 'NARUTO', difficulty: 'Facile', text: 'Dans quel village réside Naruto ?', answers: ['Konoha', 'Suna', 'Kiri', 'Oto'], correct: 0 },
            { series: 'VINLAND SAGA', difficulty: 'Difficile', text: 'Au cours de sa fuite face à Thorkell, Askeladd tombe sur un village en pleine nuit et décide de décimer tous les habitants, combien étaient-ils ?', answers: ['Une centaine de villageois environ', 'Moins de cinquante personnes', 'Plus de deux cents habitants', 'Environ trois cents âmes'], correct: 0 },
            { series: 'ONE PIECE', difficulty: 'Moyen', text: 'Quel est le nom du bateau de Luffy ?', answers: ['Le Thousand Sunny', 'Le Going Merry', 'Le Oro Jackson', 'Le Red Force'], correct: 0 },
            { series: 'DRAGON BALL', difficulty: 'Facile', text: 'Combien de Dragon Balls faut-il réunir ?', answers: ['Cinq', 'Six', 'Sept', 'Huit'], correct: 2 },
            { series: 'DEMON SLAYER', difficulty: 'Moyen', text: 'Quel est le prénom de Tanjiro ?', answers: ['Tanjiro', 'Zenitsu', 'Inosuke', 'Giyu'], correct: 0 },
            { series: 'JJK', difficulty: 'Difficile', text: 'Quel est le domaine de Gojo ?', answers: ['Chimera Shadow Garden', 'Infinite Void', 'Malevolent Shrine', 'Horizon of the Captivating Skandha'], correct: 1 },
            { series: 'AOT', difficulty: 'Difficile', text: 'Qui prononce "Si on ne se bat pas, on ne peut pas gagner" ?', answers: ['Eren Jäger', 'Mikasa Ackerman', 'Erwin Smith', 'Levi Ackerman'], correct: 2 },

            // Questions 6 réponses
            // Questions 6 réponses avec phrases longues
            { series: 'ONE PIECE', difficulty: 'Moyen', text: 'Pourquoi Arlong a-t-il tué Belmer ?', answers: ['Elle a tenté de libérer Nami de la base d\'Arlong', 'Elle a insulté Arlong de lâche', 'Elle n\'a pas pu payer la taxe du village', 'Elle était au courant des affaires entre la Marine et Arlong', 'Elle a tué un des hommes d\'Arlong', 'Elle s\'est interposée pour protéger Nojiko'], correct: 2 },

            { series: 'ONE PIECE', difficulty: 'Moyen', text: 'Pourquoi Kuro s\'est-il fait passer pour un majordome ?', answers: ['Pour finir par toucher l\'héritage de Kaya', 'Pour se rapprocher de Kaya et l\'épouser', 'Pour respecter la volonté de son prédécesseur', 'Parce qu\'il est recherché par un groupe de mercenaires', 'Parce qu\'il a perdu la mémoire', 'Parce qu\'il adore les majordomes'], correct: 0 },

            { series: 'BLEACH', difficulty: 'Difficile', text: 'Quel est le pouvoir du Zanpakuto de Izuru Kira ?', answers: ['Il peut doubler le poids de ce qu\'il touche', 'Il absorbe l\'énergie spirituelle de ses adversaires', 'Il paralyse la cible pendant quelques secondes', 'Il réduit la vitesse de son ennemi', 'Il peut téléporter ses ennemis vers une autre dimension magique infinie', 'Il peut changer la forme de sa cible'], correct: 0 },
            { series: 'DEMON SLAYER', difficulty: 'Difficile', text: 'Quel pilier n\'existe PAS dans Demon Slayer ?', answers: ['Pilier de l\'Eau', 'Pilier du Feu', 'Pilier de la Foudre', 'Pilier du Vent', 'Pilier de la Terre', 'Pilier du Son'], correct: 4 },
            { series: 'JJK', difficulty: 'Moyen', text: 'Lequel n\'est PAS un élève de l\'école de Tokyo ?', answers: ['Yuji Itadori', 'Megumi Fushiguro', 'Nobara Kugisaki', 'Maki Zenin', 'Todo Aoi', 'Toge Inumaki'], correct: 4 },
        ];

        // Joueurs en jeu
        let gamePlayers = [];

        // Fonction pour vérifier si le bouton démarrer doit être actif
        function updateStartButton() {
            const startBtn = document.getElementById('startGameBtn');
            const playerCount = document.querySelectorAll('.player-card-mini').length;

            if (playerCount >= 1) {
                startBtn.classList.remove('disabled');
            } else {
                startBtn.classList.add('disabled');
            }
        }

        // Récupérer les paramètres actuels
        function getGameSettings() {
            gameSettings.mode = document.getElementById('modeValue').textContent.toLowerCase().includes('vie') ? 'vie' : 'point';
            gameSettings.lives = parseInt(document.getElementById('livesValue')?.textContent || 3);
            gameSettings.timer = parseInt(document.getElementById('timerValue').textContent);
            gameSettings.answersCount = parseInt(document.getElementById('answersValue').textContent);  // AJOUTER
        }

        // Créer les cartes joueurs en mode jeu (style lobby)
        function createGamePlayerCards() {
            const lobbyCards = document.querySelectorAll('.player-card-mini');
            const gameGrid = document.getElementById('playersGridGame');
            gameGrid.innerHTML = '';
            gamePlayers = [];

            lobbyCards.forEach((card, index) => {
                const name = card.querySelector('.player-card-mini-name').textContent;
                const isChampion = card.classList.contains('champion');
                const titleEl = card.querySelector('.player-card-mini-title');
                const playerTitle = titleEl ? titleEl.textContent : '';

                const playerData = {
                    name: name,
                    lives: gameSettings.lives,
                    points: 0,
                    isChampion: isChampion,
                    title: playerTitle,
                    eliminated: false,
                    hasAnswered: false,
                    answer: null
                };
                gamePlayers.push(playerData);

                const gameCard = document.createElement('div');
                gameCard.className = 'player-card-game' + (isChampion ? ' champion' : '');
                gameCard.dataset.playerIndex = index;

                if (gameSettings.mode === 'vie') {
                    let heartsHtml = '';
                    for (let i = 0; i < gameSettings.lives; i++) {
                        heartsHtml += '<span class="heart"></span>';
                    }
                    gameCard.innerHTML = `
                <div class="answered-indicator"></div>
                <div class="player-card-game-name">${name}</div>
                <div class="player-card-game-lives">${heartsHtml}</div>
                <div class="player-card-game-answer-overlay">
                    <span class="answer-text-display no-answer">Pas répondu</span>
                </div>
            `;
                } else {
                    gameCard.innerHTML = `
                <div class="answered-indicator"></div>
                <div class="player-card-game-name">${name}</div>
                <div class="player-card-game-points">0</div>
                <div class="player-card-game-answer-overlay">
                    <span class="answer-text-display no-answer">Pas répondu</span>
                </div>
            `;
                }

                // ===== CLIC SUR CARTE JOUEUR =====
                gameCard.style.cursor = 'pointer';
                gameCard.addEventListener('click', (e) => {
                    // Empêcher le clic si on survole l'overlay
                    if (e.target.closest('.player-card-game-answer-overlay')) return;

                    openPlayerModal(name, isChampion, playerTitle);
                });

                gameGrid.appendChild(gameCard);
            });
        }

        // Afficher une question
        function showQuestion(questionIndex) {
            const q = filteredQuestions[questionIndex % filteredQuestions.length];
            const questionWrapper = document.getElementById('gameQuestionWrapper');
            const mainPanel = document.getElementById('gameMainPanel');
            const questionActions = document.getElementById('questionActions');
            const questionCard = document.querySelector('.question-card');
            const answersGrid = document.getElementById('answersGrid');

            // Cacher le panel droit et recentrer
            if (mainPanel) mainPanel.classList.remove('visible');
            if (questionWrapper) questionWrapper.classList.remove('shifted');
            if (questionActions) questionActions.classList.remove('visible');

            // Mettre à jour les badges
            const questionTabBadge = document.getElementById('questionTabBadge');
            const questionSeries = document.getElementById('questionSeries');
            if (questionTabBadge) questionTabBadge.textContent = `Question ${questionIndex + 1}`;
            if (questionSeries) questionSeries.textContent = q.series;

            // Difficulté avec couleur
            const diffBadge = document.getElementById('questionDifficulty');
            if (diffBadge) {
                diffBadge.textContent = q.difficulty;
                diffBadge.className = 'question-difficulty-badge';
                if (q.difficulty.toLowerCase() === 'moyen' || q.difficulty.toLowerCase() === 'medium') {
                    diffBadge.classList.add('medium');
                } else if (q.difficulty.toLowerCase() === 'difficile' || q.difficulty.toLowerCase() === 'hard') {
                    diffBadge.classList.add('hard');
                }
            }

            const questionText = document.getElementById('questionText');
            if (questionText) questionText.textContent = q.text;

            // Reset grille
            if (!answersGrid) return;
            answersGrid.innerHTML = '';

            // Détecter 6 réponses et adapter le layout
            if (q.answers.length === 6) {
                answersGrid.classList.add('six-answers');
                if (questionCard) questionCard.classList.add('six-answers');
            } else {
                answersGrid.classList.remove('six-answers');
                if (questionCard) questionCard.classList.remove('six-answers');
            }

            // Créer les réponses
            q.answers.forEach((answer, i) => {
                const answerEl = document.createElement('div');
                answerEl.className = 'answer-option';
                answerEl.dataset.answer = i;
                answerEl.innerHTML = `
            <span class="answer-text">${answer}</span>
            <span class="answer-percent">0%</span>
        `;
                answersGrid.appendChild(answerEl);
            });

            // Reset cartes joueurs
            document.querySelectorAll('.player-card-game').forEach(card => {
                card.classList.remove('has-answered', 'correct-answer', 'wrong-answer');
            });
            gamePlayers.forEach(p => {
                p.hasAnswered = false;
                p.answer = null;
            });

            // Lancer le timer
            startTimer();

            // Simuler les réponses des joueurs
            simulatePlayerAnswers(q.correct);
        }

        // Timer
        function startTimer() {
            timerValue = gameSettings.timer;
            updateTimerDisplay();

            const progress = document.getElementById('timerProgress');
            const circumference = 2 * Math.PI * 22; // radius 22
            progress.style.strokeDasharray = circumference;
            progress.style.strokeDashoffset = '0';
            progress.classList.remove('warning');
            document.getElementById('timerText').classList.remove('warning');

            timerInterval = setInterval(() => {
                timerValue--;
                updateTimerDisplay();

                // Avertissement à 3 secondes
                if (timerValue <= 3) {
                    progress.classList.add('warning');
                    document.getElementById('timerText').classList.add('warning');
                }

                if (timerValue <= 0) {
                    clearInterval(timerInterval);
                    revealAnswers();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            document.getElementById('timerText').textContent = timerValue;

            const progress = document.getElementById('timerProgress');
            const circumference = 2 * Math.PI * 22; // radius 22
            const offset = circumference * (1 - timerValue / gameSettings.timer);
            progress.style.strokeDashoffset = offset;
        }

        // Simuler les réponses des joueurs (démo)
        function simulatePlayerAnswers(correctAnswer) {
            const gameCards = document.querySelectorAll('.player-card-game:not(.eliminated)');
            const answersCount = gameSettings.answersCount || 4;  // AJOUTER

            gameCards.forEach((card, i) => {
                const delay = Math.random() * (gameSettings.timer * 800) + 500;

                setTimeout(() => {
                    if (timerValue <= 0) return;

                    const playerIndex = parseInt(card.dataset.playerIndex);
                    const player = gamePlayers[playerIndex];

                    if (!player || player.eliminated) return;

                    // Simuler une réponse (70% de chance de bonne réponse)
                    const isCorrect = Math.random() < 0.7;
                    player.answer = isCorrect ? correctAnswer : ((correctAnswer + 1 + Math.floor(Math.random() * (answersCount - 1))) % answersCount);  // MODIFIÉ
                    player.hasAnswered = true;

                    card.classList.add('has-answered');

                    updateLivePercentages();
                }, delay);
            });
        }

        // Mettre à jour les pourcentages en temps réel
        function updateLivePercentages() {
            const answerCounts = [0, 0, 0, 0, 0, 0];
            let totalAnswers = 0;

            gamePlayers.forEach(player => {
                if (player.eliminated) return;
                if (player.hasAnswered && player.answer !== null) {
                    answerCounts[player.answer]++;
                    totalAnswers++;
                }
            });

            document.querySelectorAll('.answer-option').forEach((option, i) => {
                const percent = totalAnswers > 0 ? Math.round((answerCounts[i] / totalAnswers) * 100) : 0;
                option.querySelector('.answer-percent').textContent = percent + '%';
            });
        }

        // Révéler les réponses
        function revealAnswers() {
            const questionWrapper = document.getElementById('gameQuestionWrapper');
            const mainPanel = document.getElementById('gameMainPanel');
            const questionActions = document.getElementById('questionActions');

            const q = demoQuestions[currentQuestion % demoQuestions.length];
            const correctAnswer = q.correct;

            // Compter les réponses par option
            const answerCounts = [0, 0, 0, 0, 0, 0];
            let totalAnswers = 0;
            let correctCount = 0;
            let wrongCount = 0;
            let noAnswerCount = 0;
            let eliminatedThisTurn = 0;

            gamePlayers.forEach(player => {
                if (player.eliminated) return;
                if (player.hasAnswered && player.answer !== null) {
                    answerCounts[player.answer]++;
                    totalAnswers++;
                    if (player.answer === correctAnswer) {
                        correctCount++;
                    } else {
                        wrongCount++;
                    }
                } else {
                    noAnswerCount++;
                }
            });

            // Mettre à jour les options de réponse avec animation
            document.querySelectorAll('.answer-option').forEach((option, i) => {
                const percent = totalAnswers > 0 ? Math.round((answerCounts[i] / totalAnswers) * 100) : 0;
                option.querySelector('.answer-percent').textContent = percent + '%';
                option.style.setProperty('--percent', percent + '%');
                option.classList.add('revealed');

                setTimeout(() => {
                    if (i === correctAnswer) {
                        option.classList.add('correct');
                    } else {
                        option.classList.add('wrong');
                    }
                }, 100 + i * 50);
            });

            // Effet de poussée : wrapper slide à gauche, panel droit apparaît
            setTimeout(() => {
                questionWrapper.classList.add('shifted');
                mainPanel.classList.add('visible');
                questionActions.classList.add('visible');
                showGameCloseBtn();

                // Animation des cartes joueurs
                setTimeout(() => {
                    anime({
                        targets: '.player-card-game',
                        scale: [0.9, 1],
                        opacity: [0, 1],
                        delay: anime.stagger(10),
                        duration: 200,
                        easing: 'easeOutCubic'
                    });
                }, 150);
            }, 350);

            // Mettre à jour les cartes joueurs
            document.querySelectorAll('.player-card-game:not(.eliminated)').forEach(card => {
                const playerIndex = parseInt(card.dataset.playerIndex);
                const player = gamePlayers[playerIndex];

                if (!player) return;

                // Mettre à jour l'overlay de réponse avec le TEXTE de la réponse
                const overlay = card.querySelector('.player-card-game-answer-overlay');
                const answerTextEl = overlay?.querySelector('.answer-text-display');

                if (answerTextEl) {
                    if (player.hasAnswered && player.answer !== null) {
                        const isCorrect = player.answer === correctAnswer;
                        // Afficher le texte de la réponse choisie
                        answerTextEl.textContent = q.answers[player.answer];
                        answerTextEl.classList.remove('no-answer', 'wrong');
                        if (!isCorrect) {
                            answerTextEl.classList.add('wrong');
                        }
                    } else {
                        answerTextEl.textContent = 'Pas répondu';
                        answerTextEl.classList.add('no-answer');
                        answerTextEl.classList.remove('wrong');
                    }
                }

                setTimeout(() => {
                    if (player.hasAnswered) {
                        const isCorrect = player.answer === correctAnswer;

                        if (isCorrect) {
                            card.classList.add('correct-answer');

                            if (gameSettings.mode === 'point') {
                                player.points += 100;
                                const pointsEl = card.querySelector('.player-card-game-points');
                                if (pointsEl) pointsEl.textContent = player.points;
                            }
                        } else {
                            card.classList.add('wrong-answer');

                            if (gameSettings.mode === 'vie') {
                                player.lives--;
                                const hearts = card.querySelectorAll('.heart');
                                if (hearts[player.lives]) {
                                    hearts[player.lives].classList.add('lost');
                                }

                                if (player.lives <= 0) {
                                    player.eliminated = true;
                                    eliminatedThisTurn++;
                                    setTimeout(() => {
                                        card.classList.add('eliminated');
                                    }, 400);
                                }
                            }
                        }
                    } else {
                        // N'a pas répondu = mauvaise réponse
                        card.classList.add('wrong-answer');

                        if (gameSettings.mode === 'vie') {
                            player.lives--;
                            const hearts = card.querySelectorAll('.heart');
                            if (hearts[player.lives]) {
                                hearts[player.lives].classList.add('lost');
                            }

                            if (player.lives <= 0) {
                                player.eliminated = true;
                                eliminatedThisTurn++;
                                setTimeout(() => {
                                    card.classList.add('eliminated');
                                }, 400);
                            }
                        }
                    }
                }, 500 + Math.random() * 150);
            });

            // Mettre à jour les stats
            setTimeout(() => {
                document.getElementById('statCorrect').textContent = correctCount;
                document.getElementById('statWrong').textContent = wrongCount;
                document.getElementById('statNoAnswer').textContent = noAnswerCount;
                document.getElementById('statEliminated').textContent = eliminatedThisTurn;
            }, 700);
        }

        // Question suivante
        document.getElementById('nextQuestionBtn').addEventListener('click', () => {
            const questionWrapper = document.getElementById('gameQuestionWrapper');
            const mainPanel = document.getElementById('gameMainPanel');
            const questionActions = document.getElementById('questionActions');

            hideGameCloseBtn();

            if (questionWrapper.classList.contains('closing')) return;

            // Cacher les boutons
            questionActions.classList.remove('visible');

            // 1. LES 2 PANELS S'ÉCRASENT VERS LEURS BORDS
            questionWrapper.classList.add('closing');
            mainPanel.classList.add('closing');

            // 2. Attendre la fin de l'animation
            setTimeout(() => {
                // 3. Reset
                questionWrapper.style.display = 'none';
                mainPanel.style.display = 'none';

                questionWrapper.classList.remove('closing', 'visible', 'shifted');
                mainPanel.classList.remove('visible', 'closing');

                // 4. Charger nouvelle question
                currentQuestion++;
                showQuestion(currentQuestion);

                // 5. Pause puis nouvelle question apparaît
                setTimeout(() => {
                    questionWrapper.style.display = '';
                    mainPanel.style.display = '';

                    questionWrapper.classList.add('entering-fast');

                    questionWrapper.addEventListener('animationend', function enterHandler(e) {
                        if (e.animationName !== 'questionEnter') return;
                        questionWrapper.removeEventListener('animationend', enterHandler);
                        questionWrapper.classList.remove('entering-fast');
                        questionWrapper.classList.add('visible');
                    });
                }, 950);

            }, 150);
        });





        // Tab switching pour le panel
        document.querySelectorAll('.panel-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const targetTab = tab.dataset.tab;

                // Update tab buttons
                document.querySelectorAll('.panel-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update tab content
                document.querySelectorAll('.panel-tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById('tab' + targetTab.charAt(0).toUpperCase() + targetTab.slice(1)).classList.add('active');
            });
        });

        // Transition vers l'état Game
        function transitionToGame() {
            const stateLobby = document.getElementById('stateLobby');
            const stateGame = document.getElementById('stateGame');
            const bgText = document.querySelector('.bg-text');
            const overlay = document.getElementById('gameStartOverlay');
            const startText = document.getElementById('gameStartText');
            const statusPill = document.querySelector('.status-pill');
            const questionWrapper = document.getElementById('gameQuestionWrapper');

            // Récupérer les paramètres
            getGameSettings();


            filteredQuestions = demoQuestions.filter(q => q.answers.length === gameSettings.answersCount);

            if (filteredQuestions.length === 0) {
                filteredQuestions = demoQuestions;
            }

            setStatsMode(gameSettings.mode === 'point' ? 'points' : 'vie');

            // Créer les cartes joueurs
            createGamePlayerCards();

            // Reset complet du wrapper
            questionWrapper.className = 'game-question-wrapper';
            questionWrapper.removeAttribute('style');

            // Mettre à jour le header status
            if (statusPill) {
                statusPill.classList.add('game-mode');
                document.getElementById('statusText').textContent = 'En partie';
            }

            // 1. Afficher l'overlay GAME START
            overlay.classList.add('active');

            // 2. Animation du texte GAME START
            anime({
                targets: startText,
                keyframes: [
                    { scale: 0.5, opacity: 0 },
                    { scale: 1.1, opacity: 1 },
                    { scale: 1, opacity: 1 },
                    { scale: 20, opacity: 0 }
                ],
                duration: 2000,
                easing: 'easeInOutQuad',
                complete: () => {
                    overlay.classList.remove('active');
                    startText.style.transform = '';
                    startText.style.opacity = '';
                }
            });

            // 3. Transition du lobby vers le jeu
            setTimeout(() => {
                stateLobby.style.opacity = '0';
                stateLobby.style.transition = 'opacity 0.4s';

                setTimeout(() => {
                    stateLobby.classList.remove('active');
                    stateLobby.style.opacity = '';
                    stateLobby.style.transition = '';

                    // Afficher state game
                    stateGame.classList.add('active');
                    stateGame.style.opacity = '1';
                    bgText.classList.remove('lobby-active');
                    bgText.classList.add('game-active');
                    bgText.textContent = 'GAME';

                    // Charger la première question
                    currentQuestion = 0;
                    showQuestion(currentQuestion);

                    // Lancer l'animation d'entrée
                    requestAnimationFrame(() => {
                        questionWrapper.classList.add('entering');
                    });

                    // Après l'animation, passer en état visible
                    questionWrapper.addEventListener('animationend', function handler(e) {
                        if (e.animationName !== 'questionEnter') return;
                        questionWrapper.removeEventListener('animationend', handler);
                        questionWrapper.classList.remove('entering');
                        questionWrapper.classList.add('visible');
                    });

                }, 400);
            }, 1500);

            startLogSimulation();
            document.getElementById('gameLogsToggle')?.classList.add('active');


        }

        // Bouton Démarrer
        document.getElementById('startGameBtn').addEventListener('click', () => {
            const startBtn = document.getElementById('startGameBtn');

            // Vérifier si le bouton est désactivé
            if (startBtn.classList.contains('disabled')) return;
            if (gameStarted) return;
            gameStarted = true;

            // Changer le texte du bouton
            startBtn.querySelector('.action-full-label').textContent = 'En cours...';
            startBtn.querySelector('.action-full-sub').textContent = 'Partie lancée';
            startBtn.classList.add('started');

            // Lancer la transition
            transitionToGame();
        });

        let autoMode = false;

        document.getElementById('autoToggleBtn').addEventListener('click', function () {
            autoMode = !autoMode;

            const btn = this;
            const icon = btn.querySelector('svg');

            if (autoMode) {
                btn.classList.add('active');
                // Icône pause
                icon.innerHTML = '<rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/>';
            } else {
                btn.classList.remove('active');
                // Icône play
                icon.innerHTML = '<polygon points="5 3 19 12 5 21 5 3"/>';
            }

            // Animation feedback
            anime({
                targets: btn,
                scale: [1, 1.1, 1],
                duration: 300,
                easing: 'easeOutBack'
            });
        });

        // Dans revealAnswers(), ajouter à la fin pour l'auto-mode :
        if (autoMode) {
            setTimeout(() => {
                document.getElementById('nextQuestionBtn').click();
            }, 3000); // 3 secondes avant question suivante
        }


        // Ajouter APRÈS createGamePlayerCards() ou dans l'initialisation
        // Utiliser la délégation d'événement sur la grille plutôt que sur chaque carte

        document.getElementById('playersGridGame').addEventListener('click', (e) => {
            const card = e.target.closest('.player-card-game');
            if (!card) return;

            const playerIndex = parseInt(card.dataset.playerIndex);
            const player = gamePlayers[playerIndex];

            if (player) {
                console.log('Clic sur:', player.name); // Debug
                openPlayerModal(player.name, player.isChampion, player.title || '');
            }
        });


        // ============================================
        // MODAL SIGNALEMENT
        // ============================================
        const reportModal = document.getElementById('reportModal');
        const reportModalOverlay = document.getElementById('reportModalOverlay');

        function openReportModal() {
            // Mettre à jour la question affichée
            const currentQ = demoQuestions[currentQuestion % demoQuestions.length];
            document.getElementById('reportQuestionText').textContent = currentQ.text;

            reportModal.classList.add('active');
            reportModalOverlay.classList.add('active');
        }

        function closeReportModal() {
            reportModal.classList.remove('active');
            reportModalOverlay.classList.remove('active');
        }

        // Event listeners
        document.querySelector('.mini-action-btn.report').addEventListener('click', openReportModal);
        document.getElementById('reportModalClose').addEventListener('click', closeReportModal);
        document.getElementById('reportCancelBtn').addEventListener('click', closeReportModal);
        reportModalOverlay.addEventListener('click', closeReportModal);

        document.getElementById('reportSubmitBtn').addEventListener('click', () => {
            const reason = document.getElementById('reportReason').value;
            console.log('Signalement envoyé:', reason);

            // Animation de confirmation
            const btn = document.getElementById('reportSubmitBtn');
            btn.textContent = 'Envoyé ✓';
            btn.style.background = 'rgba(0, 255, 136, 0.2)';
            btn.style.borderColor = 'rgba(0, 255, 136, 0.5)';
            btn.style.color = 'var(--green)';

            setTimeout(() => {
                closeReportModal();
                // Reset button
                setTimeout(() => {
                    btn.textContent = 'Signaler';
                    btn.style.background = '';
                    btn.style.borderColor = '';
                    btn.style.color = '';
                }, 300);
            }, 800);
        });

        // Fermer avec Escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && reportModal.classList.contains('active')) {
                closeReportModal();
            }
        });

        const gameCloseBtn = document.getElementById('gameCloseBtn');

        function showGameCloseBtn() {
            if (gameCloseBtn) gameCloseBtn.classList.add('visible');
        }

        function hideGameCloseBtn() {
            if (gameCloseBtn) gameCloseBtn.classList.remove('visible');
        }



        // Configuration des couleurs
        const COLORS = {
            correct: '#00ff88',
            wrong: '#ff3b5c',
            timeout: '#f0c040',
            lives3: '#00ff88',
            lives2: '#f0c040',
            lives1: '#ff9f43',
            lives0: '#6b7280'
        };

        /**
         * Met à jour le pie chart des réponses avec animation
         * @param {number} correct - Nombre de bonnes réponses
         * @param {number} wrong - Nombre de mauvaises réponses
         * @param {number} timeout - Nombre de non-réponses
         */
        function updateResponsesPie(correct, wrong, timeout) {
            const total = correct + wrong + timeout;
            const pie = document.getElementById('responsesPie');

            if (total === 0) {
                pie.style.background = 'rgba(255, 255, 255, 0.08)';
            } else {
                const correctAngle = (correct / total) * 360;
                const wrongAngle = correctAngle + (wrong / total) * 360;

                pie.style.setProperty('--pie-color-1', COLORS.correct);
                pie.style.setProperty('--pie-color-2', COLORS.wrong);
                pie.style.setProperty('--pie-color-3', COLORS.timeout);

                animatePieAngles(pie, correctAngle, wrongAngle);
            }

            document.getElementById('correctCount').textContent = correct;
            document.getElementById('wrongCount').textContent = wrong;
            document.getElementById('timeoutCount').textContent = timeout;
        }

        function updateLivesPie(lives3, lives2, lives1, lives0) {
            const total = lives3 + lives2 + lives1 + lives0;
            const pie = document.getElementById('livesPie');

            if (total === 0) {
                pie.style.background = 'rgba(255, 255, 255, 0.08)';
            } else {
                const angle1 = (lives3 / total) * 360;
                const angle2 = angle1 + (lives2 / total) * 360;
                const angle3 = angle2 + (lives1 / total) * 360;

                pie.style.background = `conic-gradient(
                    ${COLORS.lives3} 0deg ${angle1}deg,
                    ${COLORS.lives2} ${angle1}deg ${angle2}deg,
                    ${COLORS.lives1} ${angle2}deg ${angle3}deg,
                    ${COLORS.lives0} ${angle3}deg 360deg
                )`;
            }

            document.getElementById('lives3Count').textContent = lives3;
            document.getElementById('lives2Count').textContent = lives2;
            document.getElementById('lives1Count').textContent = lives1;
            document.getElementById('lives0Count').textContent = lives0;
        }

        /**
         * Anime les angles du pie chart progressivement
         */
        function animatePieAngles(pie, targetAngle1, targetAngle2) {
            let currentAngle1 = 0;
            let currentAngle2 = 0;
            const duration = 600;
            const startTime = performance.now();

            function animate(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const eased = 1 - Math.pow(1 - progress, 3);

                currentAngle1 = targetAngle1 * eased;
                currentAngle2 = targetAngle2 * eased;

                pie.style.setProperty('--pie-angle-1', `${currentAngle1}deg`);
                pie.style.setProperty('--pie-angle-2', `${currentAngle2}deg`);

                if (progress < 1) requestAnimationFrame(animate);
            }

            requestAnimationFrame(animate);
        }

        /**
         * Met à jour le joueur le plus rapide
         */
        function updateFastestPlayer(name, timeMs) {
            document.getElementById('fastestName').textContent = name || '-';
            document.getElementById('fastestTime').textContent = timeMs ? (timeMs / 1000).toFixed(2) + 's' : '-';
        }

        /**
         * Configure le mode (points ou vie)
         * @param {string} mode - 'points' ou 'vie'
         */
        function setStatsMode(mode) {
            const container = document.querySelector('.stats-charts-container');
            container.classList.toggle('mode-points', mode === 'points');
        }

        /**
         * Réinitialise les stats avec animation
         */
        function resetStats() {
            // Réinitialiser les pies
            const pies = document.querySelectorAll('.pie-chart');
            pies.forEach(pie => {
                pie.style.animation = 'none';
                pie.offsetHeight; // Trigger reflow
                pie.style.animation = null;
            });

            // Réinitialiser les légendes
            const legends = document.querySelectorAll('.legend-item');
            legends.forEach(item => {
                item.style.animation = 'none';
                item.offsetHeight;
                item.style.animation = null;
            });

            // Valeurs à zéro avec animation
            updateResponsesPie(0, 0, 0);
            updateLivesPie(0, 0, 0, 0);
            updateFastestPlayer(null, null);
        }

        // ===== DEMO : Simulation de données =====
        // À supprimer en production - utiliser les vraies données du serveur

        function demoUpdateStats() {
            const correct = Math.floor(Math.random() * 15) + 5;
            const wrong = Math.floor(Math.random() * 10) + 3;
            const timeout = Math.floor(Math.random() * 5);
            updateResponsesPie(correct, wrong, timeout);

            const lives3 = Math.floor(Math.random() * 5);
            const lives2 = Math.floor(Math.random() * 8) + 2;
            const lives1 = Math.floor(Math.random() * 6) + 1;
            const lives0 = Math.floor(Math.random() * 4);
            updateLivesPie(lives3, lives2, lives1, lives0);

            const names = ['Naruto_Fan', 'OnePiece_King', 'Goku_SSJ', 'Levi_Ackerman'];
            updateFastestPlayer(names[Math.floor(Math.random() * names.length)], Math.floor(Math.random() * 8000) + 1500);
        }

        // Lancer la démo au chargement
        document.addEventListener('DOMContentLoaded', () => setTimeout(demoUpdateStats, 500));


        // ============================================
        //    WINNER SCREEN - JAVASCRIPT
        // ============================================

        // Données de test pour la grille de joueurs
        const DEMO_PLAYERS = [
            { name: 'naahas__', lives: 1, status: 'correct', isWinner: true },
            { name: 'Naruto_Fan', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'OnePiece_King', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Goku_SSJ', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Levi_Ackerman', lives: 0, status: 'timeout', isWinner: false },
            { name: 'Luffy_D', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Zoro_3sword', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Eren_Yeager', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Sakura_Chan', lives: 0, status: 'correct', isWinner: false },
            { name: 'Itachi_God', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Vegeta_Prince', lives: 0, status: 'timeout', isWinner: false },
            { name: 'Tanjiro_Kun', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Nezuko_Demon', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Sasuke_Uchiha', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Hinata_Hyuga', lives: 0, status: 'correct', isWinner: false },
            { name: 'Kakashi_Sensei', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Deku_Hero', lives: 0, status: 'timeout', isWinner: false },
            { name: 'Bakugo_Boom', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Todoroki_Ice', lives: 0, status: 'correct', isWinner: false },
            { name: 'AllMight_Plus', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Killua_Zold', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Gon_Freecss', lives: 0, status: 'timeout', isWinner: false },
            { name: 'Kurapika_Red', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Hisoka_Joker', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Saitama_OPM', lives: 0, status: 'correct', isWinner: false },
            { name: 'Genos_Cyborg', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Mob_100', lives: 0, status: 'timeout', isWinner: false },
            { name: 'Reigen_Master', lives: 0, status: 'eliminated', isWinner: false },
            { name: 'Light_Yagami', lives: 0, status: 'wrong', isWinner: false },
            { name: 'Ryuk_Apple', lives: 0, status: 'eliminated', isWinner: false },
        ];

        /**
         * Créer les rayons lumineux
         */
        function createWinnerRays() {
            const raysContainer = document.getElementById('winnerRays');
            if (!raysContainer) return;
            raysContainer.innerHTML = '';
            for (let i = 0; i < 12; i++) {
                const ray = document.createElement('div');
                ray.className = 'winner-ray';
                ray.style.transform = `rotate(${i * 30}deg)`;
                raysContainer.appendChild(ray);
            }
        }

        /**
         * Créer les particules flottantes
         */
        function createWinnerParticles() {
            const container = document.getElementById('winnerParticles');
            if (!container) return;
            container.innerHTML = '';

            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'w-particle';
                particle.style.left = Math.random() * 100 + '%'; // ✅ Tout l'écran
                particle.style.top = (Math.random() * 80 + 20) + '%';
                particle.style.width = (Math.random() * 5 + 2) + 'px';
                particle.style.height = particle.style.width;
                container.appendChild(particle);
            }
        }

        /**
         * Créer les confettis
         */
        function createWinnerConfetti() {
            const overlay = document.getElementById('winnerOverlay');
            if (!overlay) return;
            const colors = ['#f0c040', '#ffd700', '#00ff88', '#ff3b5c', '#64b4ff', '#fff'];
            const shapes = ['square', 'circle', 'ribbon'];

            for (let i = 0; i < 80; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti ' + shapes[Math.floor(Math.random() * shapes.length)];
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animation = `confettiFall ${Math.random() * 3 + 4}s linear ${Math.random() * 2}s forwards`;
                overlay.appendChild(confetti);
            }
        }

        /**
         * Animation des particules
         */
        function animateWinnerParticles() {
            particles.forEach((p, i) => {
                setTimeout(() => {
                    p.style.animationDuration = duration + 's';
                    p.classList.add('active');  /* Ajoute la classe qui rend visible + anime */
                }, i * 30);
            });
        }

        /**
         * Générer la grille de joueurs
         */
        function generateWinnerPlayersGrid(players, winnerName) {
            const grid = document.getElementById('winnerGridInner');
            if (!grid) return;
            grid.innerHTML = '';

            const sorted = [...players].sort((a, b) => {
                if (a.isWinner) return -1;
                if (b.isWinner) return 1;
                if (a.status === 'eliminated' && b.status !== 'eliminated') return 1;
                if (b.status === 'eliminated' && a.status !== 'eliminated') return -1;
                return 0;
            });

            const medals = ['🥇', '🥈', '🥉'];
            const medalClasses = ['gold', 'silver', 'bronze'];

            sorted.forEach((player, index) => {
                const card = document.createElement('div');
                card.className = `winner-player-card ${player.status}`;
                if (player.isWinner) card.classList.add('winner');
                if (player.lives === 0 && !player.isWinner) card.classList.add('eliminated');

                // Médaille pour les 3 premiers
                let medalHtml = '';
                if (index < 3) {
                    card.classList.add('has-medal');
                    medalHtml = `<span class="winner-player-medal ${medalClasses[index]}">${medals[index]}</span>`;
                }

                card.innerHTML = `
            ${medalHtml}
            <div class="winner-player-name">${player.name}</div>
            <div class="winner-player-lives">${'❤'.repeat(Math.max(0, player.lives))}</div>
        `;

                grid.appendChild(card);
            });
        }


        function showWinner(name, lives, totalWins, questions, duration, playersData) {
            const overlay = document.getElementById('winnerOverlay');
            if (!overlay) return;

            // === ANIMATION DE SORTIE DES PANELS ===
            const questionWrapper = document.getElementById('gameQuestionWrapper');
            const mainPanel = document.getElementById('gameMainPanel');
            const questionActions = document.getElementById('questionActions');

            // Ajouter les classes d'animation
            if (questionActions) questionActions.classList.add('winner-exit');
            if (questionWrapper) questionWrapper.classList.add('winner-exit');
            if (mainPanel) mainPanel.classList.add('winner-exit');

            // Masquer la question
            if (questionWrapper) questionWrapper.style.display = 'none';
            if (mainPanel) mainPanel.style.display = 'none';
            if (questionActions) questionActions.style.display = 'none';

            // Déterminer le nombre de joueurs
            const playerCount = Array.isArray(playersData) ? playersData.length : playersData;
            const players = Array.isArray(playersData) ? playersData : DEMO_PLAYERS;

            // Mettre à jour les données
            document.getElementById('winnerName').textContent = name;
            document.getElementById('winnerName').setAttribute('data-name', name);
            document.getElementById('winnerLives').innerHTML = `<span class="heart">❤</span> ${lives}`;
            document.getElementById('winnerTotalWins').textContent = totalWins;
            document.getElementById('infoQuestions').textContent = questions;
            document.getElementById('infoDuration').textContent = duration;
            document.getElementById('infoPlayers').textContent = playerCount;

            // Générer la grille de joueurs
            generateWinnerPlayersGrid(players, name);

            // Générer le Top 10
            generateWinnerTop10(TOP10_DATA);

            // Préparer les éléments
            createWinnerRays();
            createWinnerParticles();

            // Afficher l'overlay
            overlay.classList.add('active');

            // ========== SÉQUENCE D'ANIMATIONS (délai initial 1.5s) ==========

            // 1. Rayons lumineux
            setTimeout(() => {
                document.getElementById('winnerRays').style.opacity = '1';
                document.getElementById('winnerRays').style.transition = 'opacity 1s ease';
            }, 900);

            // 2. Container vainqueur (centré d'abord)
            setTimeout(() => {
                document.getElementById('winnerContainer').classList.add('visible');
            }, 1000);

            // 3. Nom du gagnant
            setTimeout(() => {
                document.getElementById('winnerName').classList.add('visible');
            }, 1200);

            // 4. Ligne décorative
            setTimeout(() => {
                document.getElementById('winnerLine').classList.add('visible');
            }, 1400);

            // 5. Stats
            setTimeout(() => {
                document.getElementById('winnerStats').classList.add('visible');
            }, 1550);

            // 6. Infos partie
            setTimeout(() => {
                document.getElementById('winnerGameInfo').classList.add('visible');
            }, 1700);

            // 7. Confettis
            setTimeout(() => {
                createWinnerConfetti();
                animateWinnerParticles();
            }, 1300);

            // 8. Après un moment centré, décaler le vainqueur vers la gauche
            setTimeout(() => {
                document.getElementById('winnerContainer').classList.add('shifted');
            }, 3600);

            // 9. Puis afficher la grille
            setTimeout(() => {
                document.getElementById('winnerPlayersGrid').classList.add('visible');
            }, 3800);

            // 10. Bouton fermer lobby
            setTimeout(() => {
                document.getElementById('winnerCloseLobby').classList.add('visible');
            }, 4300);

            // 11. Top 10 apparaît 1s après la grille
            setTimeout(() => {
                document.getElementById('winnerTop10').classList.add('visible');

                // Animation stagger des items
                const items = document.querySelectorAll('.winner-top10-item');
                items.forEach((item, i) => {
                    setTimeout(() => {
                        item.classList.add('visible');
                    }, i * 60);
                });
            }, 4800);
        }

        /**
         * Fermer l'écran de victoire
         */
        function closeWinner() {
            const overlay = document.getElementById('winnerOverlay');
            if (!overlay) return;
            overlay.style.opacity = '0';

            setTimeout(() => {
                overlay.classList.remove('active');
                overlay.style.opacity = '';


                if (questionWrapper) {
                    questionWrapper.classList.remove('winner-exit');
                    questionWrapper.style.opacity = '';
                }
                if (mainPanel) {
                    mainPanel.classList.remove('winner-exit');
                    mainPanel.style.opacity = '';
                }
                if (questionActions) {
                    questionActions.classList.remove('winner-exit');
                    questionActions.style.opacity = '';
                }

                // Reset des éléments
                document.getElementById('winnerRays').style.opacity = '0';
                document.getElementById('winnerContainer').classList.remove('visible', 'shifted');
                document.getElementById('winnerName').classList.remove('visible');
                document.getElementById('winnerLine').classList.remove('visible');
                document.getElementById('winnerStats').classList.remove('visible');
                document.getElementById('winnerGameInfo').classList.remove('visible');
                document.getElementById('winnerPlayersGrid').classList.remove('visible');
                document.getElementById('winnerCloseLobby').classList.remove('visible');
                document.getElementById('winnerTop10').classList.remove('visible');
                document.querySelectorAll('.winner-top10-item').forEach(item => {
                    item.classList.remove('visible');
                });

                // Supprimer confettis
                document.querySelectorAll('.confetti').forEach(c => c.remove());
            }, 500);
        }

        /**
         * Test function pour le bouton
         */
        function testShowWinner() {
            showWinner('naahas__', 1, 12, 15, '2m 34s', DEMO_PLAYERS);
        }

        // Init rayons au chargement
        document.addEventListener('DOMContentLoaded', createWinnerRays);


        // ============================================
        // SYSTÈME DE LOGS EN DIRECT
        // ============================================

        let logsVisible = true;
        let logCount = 0;
        let unreadLogs = 0;

        const LOG_ICONS = {
            answered: '✓',
            bonus_5050: '⚡',
            bonus_joker: '🃏',
            bonus_shield: '🛡️',
            bonus_x2: '✕2',
            disconnected: '⚠',
            reconnected: '↩'
        };

        /**
         * Ajouter un log
         * @param {string} type - Type de log (answered, bonus, disconnected, reconnected)
         * @param {string} playerName - Nom du joueur
         * @param {string} [bonusName] - Nom du bonus (si type = bonus)
         */
        function addGameLog(type, playerName, bonusName = null) {
            const logsList = document.getElementById('gameLogsList');
            if (!logsList) return;

            const log = document.createElement('div');
            log.className = `game-log-item ${type}`;

            let icon = LOG_ICONS[type] || '•';
            let text = '';

            switch (type) {
                case 'answered':
                    text = `<span class="player-name">${playerName}</span> a répondu`;
                    break;
                case 'bonus_5050':
                    icon = LOG_ICONS.bonus_5050;
                    log.classList.add('bonus');
                    text = `<span class="player-name">${playerName}</span> a utilisé <span class="bonus-name">50/50</span>`;
                    break;
                case 'bonus_joker':
                    icon = LOG_ICONS.bonus_joker;
                    log.classList.add('bonus');
                    text = `<span class="player-name">${playerName}</span> a utilisé <span class="bonus-name">Joker</span>`;
                    break;
                case 'bonus_shield':
                    icon = LOG_ICONS.bonus_shield;
                    log.classList.add('bonus');
                    text = `<span class="player-name">${playerName}</span> a utilisé <span class="bonus-name">Bouclier</span>`;
                    break;
                case 'bonus_x2':
                    icon = LOG_ICONS.bonus_x2;
                    log.classList.add('bonus');
                    text = `<span class="player-name">${playerName}</span> a utilisé <span class="bonus-name">x2</span>`;
                    break;
                case 'disconnected':
                    log.classList.add('disconnected');
                    text = `<span class="player-name">${playerName}</span> s'est déconnecté`;
                    break;
                case 'reconnected':
                    log.classList.add('reconnected');
                    text = `<span class="player-name">${playerName}</span> s'est reconnecté`;
                    break;
                default:
                    text = `<span class="player-name">${playerName}</span> ${type}`;
            }

            log.innerHTML = `
        <span class="game-log-icon">${icon}</span>
        <span class="game-log-text">${text}</span>
    `;

            logsList.appendChild(log);
            logCount++;

            // Scroll vers le bas
            logsList.scrollTop = logsList.scrollHeight;

            // Si logs cachés, incrémenter le compteur
            if (!logsVisible) {
                unreadLogs++;
                updateLogsCount();
            }

            // Limiter à 20 logs max
            const logs = logsList.querySelectorAll('.game-log-item');
            if (logs.length > 20) {
                logs[0].remove();
            }

            // Auto-fade après 8 secondes
            setTimeout(() => {
                log.classList.add('fading');
                setTimeout(() => {
                    if (log.parentNode) {
                        log.remove();
                    }
                }, 500);
            }, 12000);  // était 8000
        }

        /**
         * Toggle visibilité des logs
         */
        function toggleGameLogs() {
            const container = document.getElementById('gameLogsContainer');
            const toggle = document.getElementById('gameLogsToggle');

            logsVisible = !logsVisible;

            if (logsVisible) {
                container.classList.remove('hidden');
                toggle.classList.add('active');
                unreadLogs = 0;
                updateLogsCount();
            } else {
                container.classList.add('hidden');
                toggle.classList.remove('active');
            }
        }

        /**
         * Mettre à jour le compteur de logs non lus
         */
        function updateLogsCount() {
            const countEl = document.getElementById('logsCount');
            if (!countEl) return;

            countEl.textContent = unreadLogs;
            if (unreadLogs > 0) {
                countEl.classList.add('visible');
            } else {
                countEl.classList.remove('visible');
            }
        }

        /**
         * Clear tous les logs
         */
        function clearGameLogs() {
            const logsList = document.getElementById('gameLogsList');
            if (logsList) {
                logsList.innerHTML = '';
            }
            logCount = 0;
            unreadLogs = 0;
            updateLogsCount();
        }

        // Event listener pour le toggle
        document.getElementById('gameLogsToggle')?.addEventListener('click', toggleGameLogs);

        // ============================================
        // SIMULATION DE LOGS (pour la démo)
        // ============================================

        function simulateRandomLog() {
            const players = ['Naruto_Fan', 'Goku_SSJ', 'Levi_Ackerman', 'Luffy_D', 'Sakura_Chan', 'Tanjiro_Kun'];
            const types = ['answered', 'answered', 'answered', 'answered', 'bonus_5050', 'bonus_joker', 'bonus_shield', 'bonus_x2', 'disconnected', 'reconnected'];

            const randomPlayer = players[Math.floor(Math.random() * players.length)];
            const randomType = types[Math.floor(Math.random() * types.length)];

            addGameLog(randomType, randomPlayer);
        }

        // Simuler des logs pendant la partie (démo)
        let logSimulationInterval = null;

        function startLogSimulation() {
            if (logSimulationInterval) return;
            logSimulationInterval = setInterval(() => {
                if (Math.random() > 0.2) { // 80% de chance (était 60%)
                    simulateRandomLog();
                }
            }, 800);  // était 1500ms - maintenant toutes les 0.8s
        }

        function stopLogSimulation() {
            if (logSimulationInterval) {
                clearInterval(logSimulationInterval);
                logSimulationInterval = null;
            }
        }


        // Données Top 10 (à remplacer par les vraies données)
        const TOP10_DATA = [
            { name: 'naahas__', wins: 127 },
            { name: 'Gojo_Satoru', wins: 98 },
            { name: 'OnePiece_King', wins: 84 },
            { name: 'Levi_Heichou', wins: 76 },
            { name: 'Luffy_D', wins: 71 },
            { name: 'Naruto_Fan', wins: 65 },
            { name: 'Tanjiro_Kun', wins: 58 },
            { name: 'AllMight_Plus', wins: 52 },
            { name: 'Goku_SSJ', wins: 47 },
            { name: 'Eren_Yeager', wins: 43 },
        ];

        /**
         * Générer le Top 10
         */
        function generateWinnerTop10(data) {
            const list = document.getElementById('winnerTop10List');
            if (!list) return;
            list.innerHTML = '';

            data.forEach((player, index) => {
                const item = document.createElement('div');
                item.className = 'winner-top10-item';
                item.innerHTML = `
            <span class="winner-top10-rank">${index + 1}</span>
            <span class="winner-top10-name">${player.name}</span>
            <span class="winner-top10-wins">${player.wins}</span>
        `;
                list.appendChild(item);
            });
        }


    </script>
</body>

</html>